

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Table des matières &mdash; Documentation CanFlood 1.0</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="prev" title="Documentation for CanFlood" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CanFlood
          

          
            
            <img src="../_static/NRCan_logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Table des matières</a></li>
<li class="toctree-l1"><a class="reference internal" href="#notes-and-acknowledgements">Remarques et remerciements</a></li>
<li class="toctree-l1"><a class="reference internal" href="#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#background">1.1 Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#motivation">1.1.1 Motivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guidelines">1.1.2 Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-vs-event-based-models">1.1.3 Risk- vs. Event-Based Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#intended-users">1.2 Intended Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="#risk-model-levels">1.3 Risk Model Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#control-files">1.4 Control Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#applications-and-workflows">3. Applications and Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#risk-l1-exposure-based-assessment">3.1. Risk (L1) Exposure-Based Assessment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#risk-l2-vulnerability-based-assessment">3.2. Risk (L2) Vulnerability-Based Assessment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defense-failure">3.3. Defense Failure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#workflow">3.3.1. Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-relations">3.3.2. Event Relations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#inputs-and-data-requirements">4. Inputs and Data Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#asset-inventory">4.1. Asset Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hazard-events">4.2. Hazard Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vulnerability-function-set">4.3. Vulnerability Function Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#digital-terrain-model-dtm">4.4. Digital Terrain Model (DTM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dike-information">4.5. Dike Information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#toolsets">5. Toolsets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#build">5.1. Build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">5.1.1. Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inventory">5.1.2. Inventory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hazard-sampler">5.1.3. Hazard Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-variables">5.1.4. Event Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-p">5.1.5. Conditional P</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dtm-sampler">5.1.6. DTM Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validation">5.1.7. Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model">5.2. Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#risk-l1">5.2.1. Risk (L1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#impacts-l2">5.2.2. Impacts (L2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-l2">5.2.3. Risk (L2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-l3">5.2.4. Risk (L3)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#results">5.3. Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#join-geo">5.3.1. Join Geo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#risk-plot">5.3.2. Risk Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compare-combine">5.3.3. Compare/Combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#benefit-cost-analysis">5.3.4. Benefit-Cost Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#additional-tools">5.4. Additional Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dike-fragility-mapper">5.4.1. Dike Fragility Mapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-connections">5.4.2. Add Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfda-converter">5.4.3. RFDA Converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-styles">5.4.4. Add Styles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#tutorials">6. Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-1a-risk-l1">6.1. Tutorial 1a: Risk (L1)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-data-to-the-project">6.1.1. Load data to the project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-the-model">6.1.2. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-model">6.1.3. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view-results">6.1.4. View Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-2a-risk-l2-with-simple-events">6.2. Tutorial 2a: Risk (L2) with Simple Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-data-to-project">6.2.1. Load data to project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">6.2.2. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">6.2.3. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">6.2.4. View Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-2b-risk-l2-with-dike-failure">6.3. Tutorial 2b: Risk (L2) with Dike Failure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">6.3.1. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">6.3.2. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section6-3-3">6.3.3. View Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-2c-risk-l2-with-complex-failure">6.4. Tutorial 2c: Risk (L2) with Complex Failure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id28">6.4.1. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">6.4.2. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">6.4.3. View Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-2d-risk-l2-with-mitigation">6.5. Tutorial 2d: Risk (L2) with Mitigation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id33">6.5.1. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">6.5.2. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view-the-results">6.5.3. View the Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-2e-benefit-cost-analysis">6.6. Tutorial 2e: Benefit-Cost Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-3-risk-l3-sofda-research-model">6.7. Tutorial 3: Risk (L3) SOFDA research model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-4a-risk-l1-with-percent-inundation-polygons">6.8. Tutorial 4a: Risk (L1) with Percent Inundation (Polygons)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id40">6.8.1. Build the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">6.8.2. Run the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">6.8.3. View the Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-4b-risk-l1-with-percent-inundation-lines">6.9. Tutorial 4b: Risk (L1) with Percent Inundation (Lines)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-5a-risk-l1-from-npri-and-gar15">6.10. Tutorial 5a: Risk (L1) from NPRI and GAR15</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id46">6.10.1. Load Data to Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id52">6.10.2. Build the Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-6a-dike-failure-polygons">6.11. Tutorial 6a: Dike Failure Polygons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculate-dike-exposure">6.11.1. Calculate Dike Exposure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-dike-vulnerability">6.11.2. Calculate Dike Vulnerability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#join-to-areas">6.11.3. Join to Areas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="#footnotes">Footnotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="#appendix-a-web-connections">Appendix A: Web Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="#appendix-b-sofda-user-manual">Appendix B: SOFDA User Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CanFlood</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Table des matières</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/table_of_contents/index.rst.txt" rel="nofollow"> Afficher la source de la page</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="table-of-contents">
<h1><a class="toc-backref" href="#id87">Table des matières</a><a class="headerlink" href="#table-of-contents" title="Lien permanent vers ce titre">¶</a></h1>
<div class="contents topic" id="id1">
<p class="topic-title">Table des matières</p>
<ul class="simple">
<li><p><a class="reference internal" href="#table-of-contents" id="id87">Table des matières</a></p></li>
<li><p><a class="reference internal" href="#notes-and-acknowledgements" id="id88">Remarques et remerciements</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id89">Glossary</a></p></li>
<li><p><a class="reference internal" href="#introduction" id="id90">1. Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#background" id="id91">1.1 Background</a></p>
<ul>
<li><p><a class="reference internal" href="#motivation" id="id92">1.1.1 Motivation</a></p></li>
<li><p><a class="reference internal" href="#guidelines" id="id93">1.1.2 Guidelines</a></p></li>
<li><p><a class="reference internal" href="#risk-vs-event-based-models" id="id94">1.1.3 Risk- vs. Event-Based Models</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#intended-users" id="id95">1.2 Intended Users</a></p></li>
<li><p><a class="reference internal" href="#risk-model-levels" id="id96">1.3 Risk Model Levels</a></p></li>
<li><p><a class="reference internal" href="#control-files" id="id97">1.4 Control Files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation" id="id98">2. Installation</a></p></li>
<li><p><a class="reference internal" href="#applications-and-workflows" id="id99">3. Applications and Workflows</a></p>
<ul>
<li><p><a class="reference internal" href="#risk-l1-exposure-based-assessment" id="id100">3.1. Risk (L1) Exposure-Based Assessment</a></p></li>
<li><p><a class="reference internal" href="#risk-l2-vulnerability-based-assessment" id="id101">3.2. Risk (L2) Vulnerability-Based Assessment</a></p></li>
<li><p><a class="reference internal" href="#defense-failure" id="id102">3.3. Defense Failure</a></p>
<ul>
<li><p><a class="reference internal" href="#workflow" id="id103">3.3.1. Workflow</a></p></li>
<li><p><a class="reference internal" href="#event-relations" id="id104">3.3.2. Event Relations</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#inputs-and-data-requirements" id="id105">4. Inputs and Data Requirements</a></p>
<ul>
<li><p><a class="reference internal" href="#asset-inventory" id="id106">4.1. Asset Inventory</a></p></li>
<li><p><a class="reference internal" href="#hazard-events" id="id107">4.2. Hazard Events</a></p></li>
<li><p><a class="reference internal" href="#vulnerability-function-set" id="id108">4.3. Vulnerability Function Set</a></p></li>
<li><p><a class="reference internal" href="#digital-terrain-model-dtm" id="id109">4.4. Digital Terrain Model (DTM)</a></p></li>
<li><p><a class="reference internal" href="#dike-information" id="id110">4.5. Dike Information</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#toolsets" id="id111">5. Toolsets</a></p>
<ul>
<li><p><a class="reference internal" href="#build" id="id112">5.1. Build</a></p>
<ul>
<li><p><a class="reference internal" href="#setup" id="id113">5.1.1. Setup</a></p></li>
<li><p><a class="reference internal" href="#inventory" id="id114">5.1.2. Inventory</a></p></li>
<li><p><a class="reference internal" href="#hazard-sampler" id="id115">5.1.3. Hazard Sampler</a></p></li>
<li><p><a class="reference internal" href="#event-variables" id="id116">5.1.4. Event Variables</a></p></li>
<li><p><a class="reference internal" href="#conditional-p" id="id117">5.1.5. Conditional P</a></p></li>
<li><p><a class="reference internal" href="#dtm-sampler" id="id118">5.1.6. DTM Sampler</a></p></li>
<li><p><a class="reference internal" href="#validation" id="id119">5.1.7. Validation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model" id="id120">5.2. Model</a></p>
<ul>
<li><p><a class="reference internal" href="#risk-l1" id="id121">5.2.1. Risk (L1)</a></p></li>
<li><p><a class="reference internal" href="#impacts-l2" id="id122">5.2.2. Impacts (L2)</a></p></li>
<li><p><a class="reference internal" href="#risk-l2" id="id123">5.2.3. Risk (L2)</a></p></li>
<li><p><a class="reference internal" href="#risk-l3" id="id124">5.2.4. Risk (L3)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#results" id="id125">5.3. Results</a></p>
<ul>
<li><p><a class="reference internal" href="#join-geo" id="id126">5.3.1. Join Geo</a></p></li>
<li><p><a class="reference internal" href="#risk-plot" id="id127">5.3.2. Risk Plot</a></p></li>
<li><p><a class="reference internal" href="#compare-combine" id="id128">5.3.3. Compare/Combine</a></p></li>
<li><p><a class="reference internal" href="#benefit-cost-analysis" id="id129">5.3.4. Benefit-Cost Analysis</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#additional-tools" id="id130">5.4. Additional Tools</a></p>
<ul>
<li><p><a class="reference internal" href="#dike-fragility-mapper" id="id131">5.4.1. Dike Fragility Mapper</a></p></li>
<li><p><a class="reference internal" href="#add-connections" id="id132">5.4.2. Add Connections</a></p></li>
<li><p><a class="reference internal" href="#rfda-converter" id="id133">5.4.3. RFDA Converter</a></p></li>
<li><p><a class="reference internal" href="#add-styles" id="id134">5.4.4. Add Styles</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorials" id="id135">6. Tutorials</a></p>
<ul>
<li><p><a class="reference internal" href="#tutorial-1a-risk-l1" id="id136">6.1. Tutorial 1a: Risk (L1)</a></p>
<ul>
<li><p><a class="reference internal" href="#load-data-to-the-project" id="id137">6.1.1. Load data to the project</a></p></li>
<li><p><a class="reference internal" href="#build-the-model" id="id138">6.1.2. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#run-the-model" id="id139">6.1.3. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#view-results" id="id140">6.1.4. View Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-2a-risk-l2-with-simple-events" id="id141">6.2. Tutorial 2a: Risk (L2) with Simple Events</a></p>
<ul>
<li><p><a class="reference internal" href="#load-data-to-project" id="id142">6.2.1. Load data to project</a></p></li>
<li><p><a class="reference internal" href="#id19" id="id143">6.2.2. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#id20" id="id144">6.2.3. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#id22" id="id145">6.2.4. View Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-2b-risk-l2-with-dike-failure" id="id146">6.3. Tutorial 2b: Risk (L2) with Dike Failure</a></p>
<ul>
<li><p><a class="reference internal" href="#id23" id="id147">6.3.1. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#id25" id="id148">6.3.2. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#section6-3-3" id="id149">6.3.3. View Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-2c-risk-l2-with-complex-failure" id="id150">6.4. Tutorial 2c: Risk (L2) with Complex Failure</a></p>
<ul>
<li><p><a class="reference internal" href="#id28" id="id151">6.4.1. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#id29" id="id152">6.4.2. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#id31" id="id153">6.4.3. View Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-2d-risk-l2-with-mitigation" id="id154">6.5. Tutorial 2d: Risk (L2) with Mitigation</a></p>
<ul>
<li><p><a class="reference internal" href="#id33" id="id155">6.5.1. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#id34" id="id156">6.5.2. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#view-the-results" id="id157">6.5.3. View the Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-2e-benefit-cost-analysis" id="id158">6.6. Tutorial 2e: Benefit-Cost Analysis</a></p></li>
<li><p><a class="reference internal" href="#tutorial-3-risk-l3-sofda-research-model" id="id159">6.7. Tutorial 3: Risk (L3) SOFDA research model</a></p></li>
<li><p><a class="reference internal" href="#tutorial-4a-risk-l1-with-percent-inundation-polygons" id="id160">6.8. Tutorial 4a: Risk (L1) with Percent Inundation (Polygons)</a></p>
<ul>
<li><p><a class="reference internal" href="#id40" id="id161">6.8.1. Build the Model</a></p></li>
<li><p><a class="reference internal" href="#id43" id="id162">6.8.2. Run the Model</a></p></li>
<li><p><a class="reference internal" href="#id44" id="id163">6.8.3. View the Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-4b-risk-l1-with-percent-inundation-lines" id="id164">6.9. Tutorial 4b: Risk (L1) with Percent Inundation (Lines)</a></p></li>
<li><p><a class="reference internal" href="#tutorial-5a-risk-l1-from-npri-and-gar15" id="id165">6.10. Tutorial 5a: Risk (L1) from NPRI and GAR15</a></p>
<ul>
<li><p><a class="reference internal" href="#id46" id="id166">6.10.1. Load Data to Project</a></p></li>
<li><p><a class="reference internal" href="#id52" id="id167">6.10.2. Build the Model</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tutorial-6a-dike-failure-polygons" id="id168">6.11. Tutorial 6a: Dike Failure Polygons</a></p>
<ul>
<li><p><a class="reference internal" href="#calculate-dike-exposure" id="id169">6.11.1. Calculate Dike Exposure</a></p></li>
<li><p><a class="reference internal" href="#calculate-dike-vulnerability" id="id170">6.11.2. Calculate Dike Vulnerability</a></p></li>
<li><p><a class="reference internal" href="#join-to-areas" id="id171">6.11.3. Join to Areas</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id172">References</a></p></li>
<li><p><a class="reference internal" href="#footnotes" id="id173">Footnotes</a></p></li>
<li><p><a class="reference internal" href="#appendix-a-web-connections" id="id174">Appendix A: Web Connections</a></p></li>
<li><p><a class="reference internal" href="#appendix-b-sofda-user-manual" id="id175">Appendix B: SOFDA User Manual</a></p></li>
</ul>
</div>
</section>
<section id="notes-and-acknowledgements">
<span id="id2"></span><h1><a class="toc-backref" href="#id88">Remarques et remerciements</a><a class="headerlink" href="#notes-and-acknowledgements" title="Lien permanent vers ce titre">¶</a></h1>
<p>CanFlood est une plateforme expérimentale de modélisation des risques d’inondation open source. Ressources naturelles Canada et IBI Group n’assument aucune responsabilité pour toute erreur ou inexactitude. Les outils fournis dans CanFlood sont uniquement à des fins de commodité, et l’utilisateur est responsable du développement de ses propres tests et de la confiance dans les résultats des modèles.</p>
<p>Pour la dernière version du manuel et du logiciel, veuillez visiter la page du projet</p>
<p><strong>Remerciements de développement</strong></p>
<p>The CanFlood plugin and this manual were developed by IBI Group under contract with Natural Resources Canada (NRCan). Copyright is held by NRCan and the software is distributed under the MIT License.</p>
<p><strong>Terms and Conditions of Use</strong></p>
<p>Use of the software described by this document is controlled by certain terms and conditions. The user must acknowledge and agree to be bound by the terms and conditions of usage before the software can be installed or used.</p>
<p>NRCan grants to the user the rights to install CanFlood « the Software” and to use, copy, and/or distribute copies of the Software to other users, subject to the following Terms and Conditions for Use:</p>
<blockquote>
<div><p>All copies of the Software received or reproduced by or for the user pursuant to the authority of this Terms and Conditions for Use will be and remain the property of NRCan.</p>
<p>Users may reproduce and distribute the Software provided that the recipient agrees to the Terms and Conditions for Use noted herein.</p>
<p>NRCan is solely responsible for the content of the Software. The user is solely responsible for the content, interactions, and effects of any and all amendments, if present, whether they be extension modules, language resource bundles, scripts, or any other amendment.</p>
<p>The name « CanFlood » must not be used to endorse or promote products derived from the Software. Products derived from the Software may not be called « CanFlood » nor may any part of the « CanFlood » name appear within the name of derived products.</p>
<p>No part of this Terms and Conditions for Use may be modified, deleted, or obliterated from the Software.</p>
</div></blockquote>
<p><strong>Assent</strong></p>
<p>By using this program you voluntarily accept these terms and conditions. If you do not agree to these terms and conditions, uninstall the program, delete all copies, and cease using the program.</p>
</section>
<section id="glossary">
<span id="id3"></span><h1><a class="toc-backref" href="#id89">Glossary</a><a class="headerlink" href="#glossary" title="Lien permanent vers ce titre">¶</a></h1>
<dl class="simple">
<dt>Annual Exceedance Probabilities (AEP)</dt><dd><p>The inverse of ARI.</p>
</dd>
<dt>Annual Recurrence Intervals (ARI)</dt><dd><p>The statistical expectation of time between events derived from some observed time-series (e.g., a 100 ARI magnitude flood or larger has occurred 10 times in the past 1000 years). The inverse of an event’s ARI is the annual exceedance probability of that event (e.g., a 100 ARI flood has a 1% chance of occurring each year). Often, the suffix ‘ARI’ is replaced with ‘-year’ (e.g., a 100 ARI flood is equivalent to a 100-year flood).</p>
</dd>
<dt>Area of Interest (AOI)</dt><dd><p>The spatial extents of the study or model</p>
</dd>
<dt>Coordinate Reference System (CRS)</dt><dd><p>System used to locate and project spatial information.</p>
</dd>
<dt>Estimated Annualized Damages (EAD)</dt><dd><p>Expected value of impacts. See <a class="reference internal" href="#section5-2-3">Section5.2.3</a>.</p>
</dd>
<dt>Flood Risk Assessments (FRA)</dt><dd><p>A formal process of evaluating and quantifying flood risk</p>
</dd>
<dt>Graphical User Interface (GUI) object (or property) level mitigation measures (PLPM)</dt><dd><p>Interventions acting at the micro- or property-scale like backflow valves or sandbagging. See <a class="reference internal" href="#section5-2-2">Section5.2.2</a>.</p>
</dd>
<dt>Rapid Flood Damage Assessment Tool (RFDA)</dt><dd><p>QGIS plugin developed by IBI Group and the Province of Alberta for object-based flood risk calculations (IBI Group and Golder Associates 2015)</p>
</dd>
<dt>Stochastic Object-based Flood damage Dynamic Assessment model framework (SOFDA)</dt><dd><p>Dynamic flood risk research model included in CanFlood as Risk (L3) (<a class="reference internal" href="#section5-2-4">Section5.2.4</a>)</p>
</dd>
<dt>Water Surface Level (WSL)</dt><dd><p>The height of some water above some datum. Not to be confused with ‘water depth’ which is a water height above ground.</p>
</dd>
<dt>Web Coverage Service (WCS)</dt><dd><p>Protocol for spatial data over the internet</p>
</dd>
</dl>
</section>
<section id="introduction">
<span id="id4"></span><h1><a class="toc-backref" href="#id90">1. Introduction</a><a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h1>
<p>CanFlood is an object-based, transparent, open-source flood risk calculation toolbox built for Canada. CanFlood facilitates flood risk calculations with three ‘toolsets’:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Building a model  <a class="reference internal" href="../_images/build_image.jpg"><img alt="buildimage" class="align-middle" src="../_images/build_image.jpg" style="width: 22px;" /></a></p></li>
<li><p>Running a model   <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a></p></li>
<li><p>Visualizing and analyzing results   <a class="reference internal" href="../_images/visual_image.jpg"><img alt="visualimage" class="align-middle" src="../_images/visual_image.jpg" style="width: 22px;" /></a></p></li>
</ol>
</div></blockquote>
<p>Each of these has a suite of tools to assist the flood risk modeller in a wide range of tasks common in developing flood risk assessments in Canada.</p>
<p>CanFlood flood risk models are object-based, where consequences from flood exposure are calculated for each asset (e.g., a house) using a one-dimensional user-supplied vulnerability function (i.e., depth-damage function) before summing the consequences on each asset and integrating a range of events to obtain the total flood risk in an area. To support the diversity of flood risk assessment needs and data availability across Canada, CanFlood supports three modelling frameworks of increasing complexity, data requirements, and effort (<a class="reference internal" href="#section1-1">Section1.1</a>). Each of these frameworks was designed to be flexible and agnostic, allowing modellers to implement a single software tool and data structure while maintaining flood risk models that reflect the heterogeneity of Canadian assets and values. Recognizing the significance of flood protection infrastructure on flood risk in many Canadian communities, CanFlood models can incorporate failure potential into risk calculations. To make use of Canada’s growing collection of hazard modelling datasets, CanFlood helps users connect with and manipulate such data into flood risk models.</p>
<p>The CanFlood plugin is NOT a flood risk model, instead it is a modelling platform with a suite of tools to aid users in building, executing, and analyzing their own models. CanFlood requires users to pre-collect and assemble the datasets that describe flood risk in their study area (see <a class="reference internal" href="#section0">Section0</a>). Once analysis in CanFlood is complete, users must apply their own judgement and experience to attach the necessary context and advice to any reporting before communicating results to decision makers. CanFlood results should not be used to <em>make</em> decisions, instead they should be used to <em>inform</em> decisions along with all the other dimensions and criteria relevant to the community at risk.</p>
<section id="background">
<span id="section1-1"></span><h2><a class="toc-backref" href="#id91">1.1 Background</a><a class="headerlink" href="#background" title="Lien permanent vers ce titre">¶</a></h2>
<p>The devastation of the 2013 Southern Alberta and Toronto Floods triggered a transition in Canada from the traditional standards-based approach, where flood protection is designed for a single level-of-safety, towards a risk-based approach. This new risk-based approach recognizes that robust planning must consider vulnerability and the full range of floods that may harm a community rather than focus on a single, arbitrary, design event. Further, a risk-based view allows decision makers to quantitatively optimize mitigations for their community, helping jurisdictions with shrinking budgets spread protections further. The foundation of decisions made under a risk-based flood management is a risk assessment, which is:</p>
<blockquote>
<div><p><em>A methodology to determine the risk by analyzing potential hazards and evaluating existing conditions of vulnerability that together could potentially harm exposed people, property, services, livelihoods and the environment on which they depend (UNISDR 2009).</em></p>
</div></blockquote>
<p>To quantify risk, modern risk assessments integrate data on the natural and built environment with predictive models. Applied in flood risk management, a risk analysis is highly sensitive to the spatial components of risk: vulnerability (what has been built where and how harmful are flood waters?) and hazard (where and how intense can flooding be?). Evaluating these components is typically accomplished with a chain of activities like data collection, processing, modelling, and post-processing to arrive at the desired risk metrics. The core components of a typical flood risk assessment are the hazard assessment to synthesize spatial exposure-likelihood data sets and a damage assessment to estimate damage to assets from the hazard assessment results, followed by the risk quantification that uses event probabilities to estimate average damages.</p>
<section id="motivation">
<h3><a class="toc-backref" href="#id92">1.1.1 Motivation</a><a class="headerlink" href="#motivation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Considering the limitation of existing tools, and the growing need to minimize flood harm in Canada through a better understanding of flood risk, NRCan sought to develop and maintain a flexible open-source tool tailored to Canada. Such a standardized tool will:</p>
<blockquote>
<div><ul class="simple">
<li><p>reduce the cost of individual flood risk assessments (FRA) by consolidating software development and maintenance costs;</p></li>
<li><p>increase the transparency and standardization of FRAs for improved cross study-area comparisons of risk and updating;</p></li>
<li><p>encourage communities to perform additional FRAs by reducing opacity and cost and increasing awareness;</p></li>
<li><p>facilitate and motivate the standardization and collection of flood risk related datasets; and</p></li>
<li><p>facilitate more sophisticated and stream-lined modelling.</p></li>
</ul>
</div></blockquote>
</section>
<section id="guidelines">
<span id="section1-1-2"></span><h3><a class="toc-backref" href="#id93">1.1.2 Guidelines</a><a class="headerlink" href="#guidelines" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>Federal Flood Mapping Guidelines Series</strong></p>
<p>“The Federal Flood Mapping Guidelines Series was developed under the leadership of the Flood Mapping Committee, a partnership between Public Safety Canada, Natural Resources Canada, Environment and Climate Change Canada, National Research Council of Canada, Defence Research and Development Canada, Canadian Armed Forces, Infrastructure Canada, and Crown Indigenous Relations and Northern Affairs Canada.” These “are a series of evergreen guidelines that will help advance flood mapping activities across Canada” (Public Safety Canada 2018). Published documents can be found with a web search for <a class="reference external" href="https://www.publicsafety.gc.ca/cnt/mrgnc-mngmnt/dsstr-prvntn-mtgtn/ndmp/fldpln-mppng-en.aspx">« Federal Flood Mapping Guidelines Series.”</a> The following are particularly relevant to CanFlood:</p>
<ul class="simple">
<li><p>Federal Flood Damage Estimation Guidelines for Buildings and Infrastructure (in development)</p></li>
<li><p>Federal Flood Risk Assessment Procedures (in development)</p></li>
</ul>
<p><strong>International Guidelines</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 13%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Jurisdiction/ Authority</p></th>
<th class="head" colspan="7"><p>Guideline (Reference)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>United Kingdom</p></td>
<td colspan="7"><p>Flood and coastal erosion risk management – Manual
(Penning-Rowsell et al. 2013)</p></td>
</tr>
<tr class="row-odd"><td><p>United States</p></td>
<td colspan="7"><p>Multi-Hazard Loss Estimation Methodology, Flood Model:</p>
<p>Hazus-MH MR2 Technical Manual (FEMA 2012)
Risk-Based Analysis For Flood Damage Reduction Studies (USACE 1996)</p>
<p>Tying flood insurance to flood risk for low-lying structures in the
floodplain (National Research Council 2015)
Principles of Risk Analysis for Water Resources (IWR and USACE 2017)</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="risk-vs-event-based-models">
<h3><a class="toc-backref" href="#id94">1.1.3 Risk- vs. Event-Based Models</a><a class="headerlink" href="#risk-vs-event-based-models" title="Lien permanent vers ce titre">¶</a></h3>
<p>Historically, flood management has involved decisions based on a single hypothetical, often arbitrary, ‘design event’ (e.g., 100-year discharge). This approach has left many communities under-defended and likely contributes to the rising flood losses recently seen in Canada (Frechette 2016). In response to this, modern flood management recognizes the necessity of comprehensive risk-based assessments that evaluate a range of events and their probability and consequences in management planning. CanFlood was designed to support modern risk-based management by integrating a range of flood events (e.g., 10-year, 50-year, 100-year, 200-year events) and their probabilities into risk-based models that calculate risk-metrics. However, because CanFlood calculates event-based impacts prior to any risk calculations, users can use CanFlood in event- or impact-based assessments by performing all but the final risk-calculation step.</p>
</section>
</section>
<section id="intended-users">
<h2><a class="toc-backref" href="#id95">1.2 Intended Users</a><a class="headerlink" href="#intended-users" title="Lien permanent vers ce titre">¶</a></h2>
<p>The CanFlood plugin is for users with spatial and vulnerability data desiring to perform an object-based flood risk assessment (FRA) in Canada. CanFlood is meant for flood risk practitioners with the following expertise:</p>
<blockquote>
<div><ul class="simple">
<li><p>Object-based flood risk analysis</p></li>
<li><p>QGIS (novice)</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#section1-1-2">Section1.1.2</a> for a summary of guidelines and procedures related to FRAs in Canada.</p>
</section>
<section id="risk-model-levels">
<span id="section1-3"></span><h2><a class="toc-backref" href="#id96">1.3 Risk Model Levels</a><a class="headerlink" href="#risk-model-levels" title="Lien permanent vers ce titre">¶</a></h2>
<p>Flood risk analysis objectives and applications are as diverse as the communities they serve. To accommodate this wide range, CanFlood contains three types of risk models with increasing complexity as summarized in <a class="reference internal" href="#table1-1">Table1-1</a> and discussed in <a class="reference internal" href="#section5-2">Section5.2</a>. To support the construction and analysis of these risk models, CanFlood also includes the ‘Build’ and ‘Results’ toolsets respectively (<a class="reference internal" href="#section5-1">Section5.1</a> and <a class="reference internal" href="#section5-3">Section5.3</a>). Connecting all these together to perform an analysis is discussed in <a class="reference internal" href="#section4-5">Section4.5</a> and similar tutorials are provided in <a class="reference internal" href="#section6">Section6</a>.</p>
<p id="table1-1"><em>Table 1-1 - CanFlood model level summaries</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head stub"><p>Analysis Level</p></th>
<th class="head"><p>L1: Initial</p></th>
<th class="head"><p>L2: Intermediate</p></th>
<th class="head"><p>L3: Detailed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><th class="stub"><p>Motivation <sup>1</sup></p></th>
<td><p>Rapid FRA. desktop type appraisals: first approximations to identify areas where more detailed work is required</p></td>
<td><p>More detailed appraisals where further assessment of loss potential is warranted</p></td>
<td><p>Detailed study of potential losses and robust uncertainty quantification</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Workflow</p></th>
<td><p><a class="reference internal" href="#section3-1">Section3.1</a></p></td>
<td><p><a class="reference internal" href="#section3-2">Section3.2</a></p></td>
<td><p>Appendix B</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>CanFlood model tool names</p></th>
<td><p>Risk (L1)</p></td>
<td><p>Impacts (L2) and Risk (L2)</p></td>
<td><p>Risk (L3) (aka SOFDA)</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Data requirement</p></th>
<td><p>low</p></td>
<td><p>medium</p></td>
<td><p>high</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>Level of modelling effort (per asset)</p></th>
<td><p>low</p></td>
<td><p>low</p></td>
<td><p>high</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Model complexity</p></th>
<td><p>low</p></td>
<td><p>medium</p></td>
<td><p>high</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>Impact Functions</p></th>
<td><p>none (inundation only)</p></td>
<td><p>per-object</p></td>
<td><p>per-object, un-compiled</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Uncertainty quantification</p></th>
<td><p>none</p></td>
<td><p>none</p></td>
<td><p>stochastic modelling</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>PLPMs</p></th>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Risk Dynamics</p></th>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>Asset geometry</p></th>
<td><p>point, polygon, line</p></td>
<td><p>point, polygon, line</p></td>
<td><p>point</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p>Inputs</p></th>
<td><p>asset inventory, hazard events, DTM (optional), companion failure events (optional)</p></td>
<td><p>same as L1 plus: Impact Function Set</p></td>
<td><p>asset inventory, WSL tables, vulnerability functions (un-compiled), dynamic parameters, others</p></td>
</tr>
<tr class="row-even"><th class="stub"><p>Primary Outputs</p></th>
<td><p>total impacts (‘r_ttl’), per-asset impacts (‘r_passet’), risk curve plot</p></td>
<td><p>same as L1</p></td>
<td><p>exposure table, annualized impacts (summary and per asset) summary plot, others</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>Adapted from Penning-Rowsell et al. (2019)</p></li>
</ol>
</section>
<section id="control-files">
<span id="section1-4"></span><h2><a class="toc-backref" href="#id97">1.4 Control Files</a><a class="headerlink" href="#control-files" title="Lien permanent vers ce titre">¶</a></h2>
<p>CanFlood models are designed to write and read from small ‘Control Files’. These make it easy to build and share a specific model or scenario, and to keep a record of how the results set were generated. These also facilitate making a small change to a common input file (e.g., the asset inventory), and having this change replicated across all scenario runs. Control Files don’t contain any (large) data, only parameter values and pointers to the datasets required by a CanFlood model. Diligent and consistent file storage and naming conventions are essential for a pleasant modelling experience. Most Control File parameters and Data Files can be configured in the ‘Build’ toolset; however, some advanced parameters must be configured manually (see <a class="reference internal" href="#section5-2">Section5.2</a> for a full description of the Control File Parameters) <a class="footnote-reference brackets" href="#id56" id="id5">1</a> . The collection of model inputs and configured control file is called a ‘model package’ as shown in <a class="reference internal" href="#figure1-1">Figure1-1</a> . More information on input files is provided in <a class="reference internal" href="#section0">Section0</a> .</p>
<p id="figure1-1">Figure 1-1. More information on input files is provided in <a class="reference internal" href="#section0">Section0</a> .</p>
<img alt="../_images/intro_1_4_conrol_files.jpg" src="../_images/intro_1_4_conrol_files.jpg" />
<p><em>Figure 1-1: CanFlood L2 model package and data-inputs relation diagram.</em></p>
</section>
</section>
<section id="installation">
<span id="section0"></span><h1><a class="toc-backref" href="#id98">2. Installation</a><a class="headerlink" href="#installation" title="Lien permanent vers ce titre">¶</a></h1>
<p>All installation instructions can be found on GitHub:
<a class="reference external" href="https://github.com/NRCan/CanFlood">https://github.com/NRCan/CanFlood</a></p>
<p>Once installed, you should see the three CanFlood buttons on your QGIS toolbar:</p>
<blockquote>
<div><img alt="../_images/installation_image.jpg" src="../_images/installation_image.jpg" />
</div></blockquote>
<p>Additional tools are provided under QGIS’s plugins menu.</p>
</section>
<section id="applications-and-workflows">
<span id="id6"></span><h1><a class="toc-backref" href="#id99">3. Applications and Workflows</a><a class="headerlink" href="#applications-and-workflows" title="Lien permanent vers ce titre">¶</a></h1>
<p>The CanFlood plugin holds a collection of tools designed to support flood risk modellers with range of common tasks. To accomplish this, CanFlood is flexible: allowing users to link together whichever tools and sequences are needed to complete the task at hand. Performing a flood risk assessment using CanFlood requires expertise in flood risk modelling, some procedures like those referenced in <a class="reference internal" href="#section1-1-2">Section1.1.2</a> , and generally employs the following steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Identifying the objectives, scope, and purpose of the assessment.</p></li>
<li><p>Selecting the appropriate CanFlood model level (<a class="reference internal" href="#section1-3">Section1.3</a>) then identifying the necessary input data.</p></li>
<li><p>Collecting and preparing the necessary input data (<a class="reference internal" href="#section0">Section0</a>).</p></li>
<li><p>Building the CanFlood model package (see below).</p></li>
<li><p>Running the CanFlood model package using the appropriate model tool (<a class="reference internal" href="#section5-2">Section5.2</a>).</p></li>
<li><p>Using CanFlood’s ‘Results’ tools to prepare diagrams and maps (<a class="reference internal" href="#section5-3">Section5.3</a>).</p></li>
<li><p>Evaluating, documenting, and communicating the results, context, and uncertainty.</p></li>
</ol>
</div></blockquote>
<p>As noted in the section references, many of these steps must be performed outside the CanFlood platform.</p>
<p><strong>Building Models</strong></p>
<p>Most workflows in CanFlood require the user to employ a similar sequence of the ‘Build’ tools described in <a class="reference internal" href="#section5-1">Section5.1</a> to prepare the CanFlood model package (<a class="reference internal" href="#figure1-1">Figure1-1</a>) from the input data. <a class="reference internal" href="#figure3-1">Figure3-1</a> shows a typical workflow from ‘Setup’ to ‘Validation’. Whether or not to include the optional steps shown on the diagram will depend on the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Risk model level</em>: L2 models require vulnerability functions (‘curves’) (see <a class="reference internal" href="#section3-2">Section3.2</a>).</p></li>
<li><p><em>Defense failure</em>: L1 or L2 models incorporating some protection failure require companion failure events (failure   rasters and failure polygons) (see <a class="reference internal" href="#section3-3">Section3.3</a>).</p></li>
<li><p><em>Asset heights</em>: L1 or L2 models incorporating asset inventories with object height data relative to ground require ground elevations data (‘gels’).</p></li>
<li><p><em>Exposure type</em>: L1 or L2 models with non-point geometry assets evaluating exposure as a percentage of inundation (<a class="reference internal" href="#section5-1-3">Section5.1.3</a>) require a DTM layer.</p></li>
</ul>
</div></blockquote>
<img alt="../_images/app_workflow_build_model.jpg" id="figure3-1" src="../_images/app_workflow_build_model.jpg" />
<p><em>Figure 3-1: Typical model construction workflow using CanFlood’s ‘Build’ tools from ‘Setup’ to ‘Validation’. Data inputs are described in Section 0 while tools and outputs are described in</em>  <a class="reference internal" href="#section5-1">Section5.1</a></p>
<p>More information and additional tools to support model construction are provided in <a class="reference internal" href="#section5-1">Section5.1</a> .</p>
<p>The remainder of this section summarizes some typical analysis types or workflows employing the risk models summarized in <a class="reference internal" href="#section1-3">Section1.3</a> and discussed in detail in <a class="reference internal" href="#section5-2">Section5.2</a> . All these workflows are risk-based, in that they incorporate a wide-range of event probabilities and calculate risk-metrics. The tutorials in Section 6 provide step-by-step instructions and accompanying input data to demonstrate these workflows.</p>
<section id="risk-l1-exposure-based-assessment">
<span id="section3-1"></span><h2><a class="toc-backref" href="#id100">3.1. Risk (L1) Exposure-Based Assessment</a><a class="headerlink" href="#risk-l1-exposure-based-assessment" title="Lien permanent vers ce titre">¶</a></h2>
<p>Exposure-based (L1) assessments quantify the probability of binary exposure of assets to flooding (wet vs. dry). This can be useful for initial assessments, where resources and data are limited, to identify areas for further study. In CanFlood, this is accomplished by collecting data, building a Risk (L1) model, running the model, and evaluating the results. Unlike vulnerability-based assessments (L2, <a class="reference internal" href="#section3-2">Section3.2</a>), exposure-based (L1) assessments do not capture the influence of flood depth on risk. In other words, a house with some ponding in the yard would be counted the same as a house fully under-water. However, exposure-based (L1) assessments can be used to estimate additional risk-metrics through application of CanFlood’s scaling parameters (e.g., estimating crop-loss by multiplying the area inundated by some loss/area constant). Exposure-based (L1) assessments can incorporate an assessment of defense failure if exposure probability data is available (<a class="reference internal" href="#section3-3">Section3.3</a>). <a class="reference internal" href="#figure3-1">Figure3-1</a> and <a class="reference internal" href="#figure3-2">Figure3-2</a> summarize a typical Risk (L1) workflow. For more information on the Risk (L1) model, see <a class="reference internal" href="#section5-2-1">Section5.2.1</a>.</p>
<img alt="../_images/app_wrkflw_3_1_risk_ecp.jpg" id="figure3-2" src="../_images/app_wrkflw_3_1_risk_ecp.jpg" />
<p><em>Figure 3-2: Typical Risk (L1) workflow (post- model construction).</em></p>
</section>
<section id="risk-l2-vulnerability-based-assessment">
<span id="section3-2"></span><h2><a class="toc-backref" href="#id101">3.2. Risk (L2) Vulnerability-Based Assessment</a><a class="headerlink" href="#risk-l2-vulnerability-based-assessment" title="Lien permanent vers ce titre">¶</a></h2>
<p>Vulnerability-based (L2) assessments quantify the risk of some flood impacts to assets where the impact can be related to depth. Risk models that consider vulnerability as a function of flood depth are commonly used to evaluate flood risk to buildings, building contents, and infrastructure. In CanFlood, such an assessment is conducted by collecting data, constructing or collecting vulnerability functions, building a Risk (L2) model, running said model, then evaluating the results. Often the most challenging element of this process is the collection or construction of vulnerability functions (<a class="reference internal" href="#section4-3">Section4.3</a>) which future versions of CanFlood may provide support for. Vulnerability-based (L2) assessments generally incorporate an assessment of defense failure (<a class="reference internal" href="#section3-3">Section3.3</a>). <a class="reference internal" href="#figure3-1">Figure3-1</a> and <a class="reference internal" href="#figure3-3">Figure3-3</a> summarize a typical Risk (L2) workflow. For more information on the Risk (L2) model, see <a class="reference internal" href="#section5-2-3">Section5.2.3</a>.</p>
<img alt="../_images/app_wrkflw_3_2_vuln.jpg" id="figure3-3" src="../_images/app_wrkflw_3_2_vuln.jpg" />
<p><em>Figure 3-3: Typical Risk (L2) workflow (post-model construction).</em></p>
</section>
<section id="defense-failure">
<span id="section3-3"></span><h2><a class="toc-backref" href="#id102">3.3. Defense Failure</a><a class="headerlink" href="#defense-failure" title="Lien permanent vers ce titre">¶</a></h2>
<p>Many developed areas in Canada rely on some form of flood defense infrastructure (e.g., levees or drainage pumps) to reduce the exposure of assets. Any such infrastructure has the potential to fail during a flood event. Ignoring this failure potential (P <sub>fail</sub> =0) will underestimate the real flood risk in an area (negative model bias). Assuming such infrastructure will always fail (P <sub>fail</sub> =1) can drastically overestimate flood risk (positive model bias). Either assumption will reduce confidence in the model and the quality of any flood management decisions made from it. In many areas in Canada, flood protection plays such a significant role in exposure mechanics that a binary treatment of failure probability (P <sub>fail</sub> = 0 or 1) would render the model’s calculated risk metric useless. Recognizing the importance of flood protection infrastructure in Canadian flood risk management, CanFlood Risk (L1) and Risk (L2) workflows facilitate the incorporation of defense failure into risk calculations.</p>
<p>A common application of this capability is the incorporation of levee fragility into a risk model. Often such study areas will have groups of levee-protected assets, where each asset is vulnerable to a breach point anywhere along a levee ring. This situation can be analyzed by discretizing the levee into segments, estimating the influence area of a breach along each segment (for event <em>j</em>), estimating the conditional probability of that breach occurring (during event <em>j</em>), and developing hazard rasters for the breach conditions. Qualified hydrotechnical and geotechnical professionals should be engaged to perform this analysis and generate the inputs required by CanFlood as summarized in <a class="reference internal" href="#section4-2">Section4.2</a>.</p>
<section id="workflow">
<h3><a class="toc-backref" href="#id103">3.3.1. Workflow</a><a class="headerlink" href="#workflow" title="Lien permanent vers ce titre">¶</a></h3>
<p>Defense failure is incorporated into risk calculations during CanFlood’s Risk (L1) and Risk (L2) workflows with the following general steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Collect the set of hazard event rasters (<a class="reference internal" href="#section4-2">Section4.2</a>) and dike profile, fragility, and influence area information (<a class="reference internal" href="#section4-5">Section4.5</a>).</p></li>
<li><p>Calculate the dike failure probability of each hazard event and map it onto the dike influence area using the ‘Dike Fragility Mapper’ tool (<a class="reference internal" href="#section5-4-1">Section5.4.1</a>) to obtain the ‘failure polygon’ set.</p></li>
<li><p>From the ‘failure polygons’, extract, resolve, and assign conditional failure probabilities for each failure event into the resolved exposure probabilities (‘exlikes’) dataset using the ‘Conditional P’ tool (<a class="reference internal" href="#section5-1-5">Section5.1.5</a>).</p></li>
<li><p>Execute the Risk (L1) or Risk (L2) model to employ CanFlood’s algorithms to calculate expected values with defense failure (<a class="reference internal" href="#section5-2-3">Section5.2.3</a> <em>Events with Failure</em>).</p></li>
</ol>
</div></blockquote>
<p><a class="reference internal" href="#figure3-4">Figure3-4</a> summarizes CanFlood’s full expected value algorithm.</p>
<img alt="../_images/app_wrkflw_3_3_1_wrkflw.jpg" id="figure3-4" src="../_images/app_wrkflw_3_3_1_wrkflw.jpg" />
<p><em>Figure 3-4: CanFlood’s Risk (L1 and L2) tool expected value (E(X)) calculation algorithm</em></p>
</section>
<section id="event-relations">
<h3><a class="toc-backref" href="#id104">3.3.2. Event Relations</a><a class="headerlink" href="#event-relations" title="Lien permanent vers ce titre">¶</a></h3>
<p>To calculate expected values (in more complex models), the application of both the ‘Conditional P’ tool and the risk models requires accounting for the relationship between the events supplied by the user. In other words, when multiple failures are specified, one must specify how those failures should/should-not be combined. Calculating and incorporating failure correlations between elements in a defense system requires a sophisticated and mechanistic understanding of the system that is beyond the scope of CanFlood. As an alternative approximation, CanFlood includes two basic assumptions, summarized in <a class="reference internal" href="#figure3-5">Figure3-5</a>, for the relationship between failure elements. These alternate assumptions are provided to allow the user to test the sensitivity of the model to failure element correlations; if the model is found to have a high sensitivity to this parameter, more sophisticated defense system analysis should be pursued.</p>
<img alt="../_images/app_wrkflw_3_3_2_event_relations.jpg" id="figure3-5" src="../_images/app_wrkflw_3_3_2_event_relations.jpg" />
<p><em>Figure 3-5: Example probability space diagram showing two events either [left] independent or [right] mutually exclusive where ‘P(o)’ is the probability of no failures.</em></p>
</section>
</section>
</section>
<section id="inputs-and-data-requirements">
<span id="id7"></span><h1><a class="toc-backref" href="#id105">4. Inputs and Data Requirements</a><a class="headerlink" href="#inputs-and-data-requirements" title="Lien permanent vers ce titre">¶</a></h1>
<p>CanFlood models are only as useful as the datasets they are built with. Below is a summary of the main datasets the user must collect and compile prior to building a CanFlood model.</p>
<section id="asset-inventory">
<span id="section4-1"></span><h2><a class="toc-backref" href="#id106">4.1. Asset Inventory</a><a class="headerlink" href="#asset-inventory" title="Lien permanent vers ce titre">¶</a></h2>
<p>The asset inventory (‘finv’) is a comprehensive list of the objects or assets whose exposure will be evaluated by the CanFlood model routines. The asset inventory is a spatial dataset that requires the following fields when employed in Risk (L1) models:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>fX_scale</em>: value to scale the vulnerability function by (e.g., floor area);</p></li>
<li><p><em>fX_elv</em>: elevation to anchor the vulnerability function (e.g., first floor height + DTM);</p></li>
<li><p><em>geometry</em>: geospatial data used to locate the asset for sampling;</p></li>
<li><p><em>FieldName Index (cid)</em>: unique asset identifying integer used to link datasets.</p></li>
</ul>
</div></blockquote>
<p>For Impacts (L2) and Risk (L2) models, the following additional fields are required:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>fX_tag</em>: value telling the model which vulnerability function to assign to this asset;</p></li>
<li><p><em>fX_cap</em>: value to cap vulnerability prediction by (e.g., improvement value).</p></li>
</ul>
</div></blockquote>
<p>Additional fields are allowed but ignored by CanFlood. The ‘X’ placeholder shown above is called the ‘nestID’ and is used to group the four key attributes that parametrize a ‘nested function’ required by the Impacts (L2) model (<a class="reference internal" href="#section5-2-2">Section5.2.2</a>). The ‘Build’ toolset provides a ‘Inventory Constructor’ tool that can populate an inventory template as a convenience; however, completing this template for a study area generally requires extensive data analysis outside the CanFlood plugin.</p>
</section>
<section id="hazard-events">
<span id="section4-2"></span><h2><a class="toc-backref" href="#id107">4.2. Hazard Events</a><a class="headerlink" href="#hazard-events" title="Lien permanent vers ce titre">¶</a></h2>
<p>CanFlood requires a set of ‘hazard events’ to calculate flood exposure and risk. For a risk calculation, each event should have:</p>
<blockquote>
<div><ul>
<li><p><strong>Event probability</strong>: probability of the event occurring. This can be input as Annual Exceedance Probabilities (AEP) or Annual Recurrence Intervals (ARI). Often these are developed using statistical analysis of past flood events. As this information is not contained in the raster data file itself, best practice is to include it in the layer name.</p></li>
<li><p><strong>Event raster</strong>: location and WSL of the flood event. CanFlood’s ‘Hazard Sampler’ tool (<a class="reference internal" href="#section5-1-3">Section5.1.3</a>) expects this as a raster data file, but CanFlood’s Model routines only require the tabular exposure data (‘expos’). Values must be relative to the project datum (WSL) and are typically developed using hydraulic modelling software.</p></li>
<li><p><strong>Companion failure events (optional)</strong>: contains information about the probability and resulting exposure of a flood protection system failure during the hazard event. Each hazard event can be assigned multiple failure events (see <a class="reference internal" href="#section1-4">Section1.4</a>) by specifying the same event probability for each in the ‘evals’ dataset (see <a class="reference internal" href="#section5-1-4">Section5.1.4</a>).</p>
<blockquote>
<div><p>o Failure raster: location and WSL of the companion failure event.</p>
<p>o Failure polygon: Conditional exposure probability polygon layer with features indicating the extent and probability of element failures during the event. The ‘Dike Fragility Mapper’ tool (<a class="reference internal" href="#section5-1-5">Section5.1.5</a>) provides a set of algorithms for preparing these polygons from typical dike fragility information and event rasters. These failure polygons are needed by the ‘Conditional P’ tool to generate the resolved exposure probabilities (‘exlikes’) dataset required by the Risk (L1) and Risk (L2) modules.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</section>
<section id="vulnerability-function-set">
<span id="section4-3"></span><h2><a class="toc-backref" href="#id108">4.3. Vulnerability Function Set</a><a class="headerlink" href="#vulnerability-function-set" title="Lien permanent vers ce titre">¶</a></h2>
<p>For the Impacts (L2) model, CanFlood requires an impact function library with a function for each asset tag in the inventory. The datafile is a .xls spreadsheet, where each tab corresponds to a separate impact function. Each tab contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>metadata about the function (not used by CanFlood); and</p></li>
<li><p>a 1D function translating exposure to impact.</p></li>
</ul>
</div></blockquote>
<p>An example is provided below with a description. During the Impacts (L2) model, each asset interpolates its vulnerability function at the exposure value (from the ‘expos’ data set) to estimate the impact value. Typically, the exposure variables are depth and the impact variables are damages, but the user can customize the model by populating the ‘expos’ data set with alternative exposure variables and developing vulnerability functions with alternative outputs (e.g. persons displaced = f(percent inundated)).</p>
<p><em>Table 4-1: CanFlood impact function format requirements and description.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 28%" />
<col style="width: 23%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Example Value</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>tag</p></td>
<td><p>02Office.inEq.comp</p></td>
<td><p>Linking variable used
to assign this
function to an asset
in the inventory</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-odd"><td><p>desc</p></td>
<td><p>some description</p></td>
<td><p>Long form description
of the impact
function.</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>source</p></td>
<td><p>BCStats NRP Survey (2020)</p></td>
<td><p>Primary data source
for the impact
function.</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>location</p></td>
<td><p>BCs LowerMainland</p></td>
<td><p>Geographic location
of applicable
assets</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>date</p></td>
<td><p>2020</p></td>
<td><p>Applicable period</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>impact_units</p></td>
<td><p>$CAD</p></td>
<td><p>Units of impact
output(after scaling)</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>exposure _units</p></td>
<td><p>m</p></td>
<td><p>Units of expected
impact input</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>scale_units</p></td>
<td><p>m2</p></td>
<td><p>Units of expected
scale input</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>exposure_var</p></td>
<td><p>water height from
main floor</p></td>
<td><p>Variable of expected
exposure input</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>impact_var</p></td>
<td><p>building repair and
restoration cost
estimation</p></td>
<td><p>Variable of impact
output (after
scaling)</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>scale_var</p></td>
<td><p>main floor area</p></td>
<td><p>Description of
expected scale
variable</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>exposure</p></td>
<td><p>impact</p></td>
<td><p>Header for exposure-
impact function</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>First exposure-impact
entry</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-odd"><td><p>0.305</p></td>
<td><p>394.56</p></td>
<td><p>…</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-even"><td><p>0.914</p></td>
<td><p>543.05</p></td>
<td><p>Last exposure-impact
entry</p></td>
<td><p>TRUE</p></td>
</tr>
</tbody>
</table>
</section>
<section id="digital-terrain-model-dtm">
<h2><a class="toc-backref" href="#id109">4.4. Digital Terrain Model (DTM)</a><a class="headerlink" href="#digital-terrain-model-dtm" title="Lien permanent vers ce titre">¶</a></h2>
<p>A project DTM is only required for those models with relative asset heights (elv).</p>
</section>
<section id="dike-information">
<span id="section4-5"></span><h2><a class="toc-backref" href="#id110">4.5. Dike Information</a><a class="headerlink" href="#dike-information" title="Lien permanent vers ce titre">¶</a></h2>
<p>To use the ‘Dike Fragility Mapper’ module (<a class="reference internal" href="#section5-4-1">Section5.4.1</a>) to generate the ‘failure polygon’ set, the following information on the study area’s diking system is required:</p>
<blockquote>
<div><ul>
<li><dl>
<dt><strong>Dike alignment</strong>: This line layer contains the following information on the study dikes:</dt><dd><p>o face of the dike: indicated by the direction of the feature, this tells CanFlood which side should of the feature to sample the WSL from</p>
<p>o the horizontal location of the dike crest (i.e. the position of features)</p>
<p>o how each dike should be segmented in the analysis (where each feature represents a segment)</p>
<p>o the dike identifier (for combining multiple segments onto a single plot)</p>
<p>o any freeboard buffers that should be applied (e.g., to simulate sand-bagging)</p>
<p>o which fragility curve should be used to calculate the failure probability of that segment.</p>
</dd>
</dl>
</li>
<li><p><strong>Dike fragility function library</strong>: This special type of impact function (<a class="reference internal" href="#section4-3">Section4.3</a>) relates the WSL relative to the segment crest elevation (i.e., freeboard) against the probability of that segment failing (and realizing the provided failure WSL). Developing these relations often requires data on mechanical (e.g., foundation, core) and emergency repair properties (e.g., accessibility to maintenance vehicles) and sophisticated geotechnical analysis and expertise. While dike performance is generally sensitive to more types of loading than freeboard, CanFlood only supports single-variable fragility calculations.</p></li>
<li><p><strong>Dike segment influence areas</strong>: These polygons provide the geometry of the area where assets would be impacted by a failure of a segment. Generally, this is similar to the extents of the failure raster (e.g., results of a hydraulic model breach run).</p></li>
<li><p><strong>Digital Terrain Model (DTM) of dike crest</strong>: This is generally the same dataset as what’s described in Section 4.4; however, dike evaluation is particular sensitive to small changes in elevation and DTMs often have errors or artifacts around dike crests if not constructed for flood modelling. Therefore, users should emphasize DTM quality around dike crests when performing a fragility analysis.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="toolsets">
<span id="id8"></span><h1><a class="toc-backref" href="#id111">5. Toolsets</a><a class="headerlink" href="#toolsets" title="Lien permanent vers ce titre">¶</a></h1>
<p>This section describes the use and function of CanFlood’s toolsets in detail.</p>
<section id="build">
<span id="section5-1"></span><h2><a class="toc-backref" href="#id112">5.1. Build</a><a class="headerlink" href="#build" title="Lien permanent vers ce titre">¶</a></h2>
<img alt="../_images/build_image.jpg" class="align-right" src="../_images/build_image.jpg" />
<p>The build toolset contains a suite of tools summarized in <a class="reference internal" href="#table5-1">Table5-1</a> intended to aid the flood risk modeller in their construction of CanFlood L1 and L2 models.</p>
<p id="table5-1"><em>Table 5-1: Build tools summary</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 24%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Tab Name</p></th>
<th class="head"><p>Tool Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Inputs</p></th>
<th class="head"><p>Outputs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Setup</p></td>
<td><p>Start Control File</p></td>
<td><p>Creates a Control
File template</p></td>
<td><p>name and
precision</p></td>
<td><p>Control File
Template</p></td>
</tr>
<tr class="row-odd"><td><p>Inventory</p></td>
<td><p>Inventory Constructor</p></td>
<td><p>Builds a finv
template</p></td>
<td><p>vector layer,
attributes</p></td>
<td><p>inventory vector
layer (‘finv’)</p></td>
</tr>
<tr class="row-even"><td><p>Inventory</p></td>
<td><p>Vuln. Function Library</p></td>
<td><p>GUI for selecting a
Function set</p></td>
<td></td>
<td><p>Vulnerability
Function Set</p></td>
</tr>
<tr class="row-odd"><td><p>Inventory</p></td>
<td><p>Inventory Compiler</p></td>
<td><p>Clip and extract finv
data to tabular format</p></td>
<td><p>‘finv’,
parameters</p></td>
<td><p>inventory tabular
data (‘finv’)</p></td>
</tr>
<tr class="row-even"><td><p>Hazard Sampler</p></td>
<td><p>Raster Preparation</p></td>
<td><p>Manipulate hazard
rasters</p></td>
<td><p>hazard rasters</p></td>
<td><p>hazard rasters</p></td>
</tr>
<tr class="row-odd"><td><p>Hazard Sampler</p></td>
<td><p>Sample Rasters</p></td>
<td><p>Sample hazard raster
values</p></td>
<td><p>hazard rasters,
‘finv’, DTM</p></td>
<td><p>exposure dataset
(“expos”)</p></td>
</tr>
<tr class="row-even"><td><p>Event Variables</p></td>
<td><p>Store Evals</p></td>
<td><p>Write event
probabilities to file</p></td>
<td><p>hazard event
probabilities</p></td>
<td><p>event variables
(‘evals’)</p></td>
</tr>
<tr class="row-odd"><td><p>Conditional P</p></td>
<td><p>Conditional P</p></td>
<td><p>Resolve conditional
exposure probabilities</p></td>
<td><p>‘finv’, failure
polygons</p></td>
<td><p>exposure
prob.(‘exlikes’)</p></td>
</tr>
<tr class="row-even"><td><p>DTM Sampler</p></td>
<td><p>DTM Sampler</p></td>
<td><p>Sample DTM raster at
asset geometry</p></td>
<td><p>‘finv’, DTM</p></td>
<td><p>ground elevations
(‘gels’)</p></td>
</tr>
<tr class="row-odd"><td><p>Validation</p></td>
<td><p>Validation</p></td>
<td><p>Validate against
model requirements</p></td>
<td><p>complete model
package</p></td>
<td></td>
</tr>
</tbody>
</table>
<section id="setup">
<h3><a class="toc-backref" href="#id113">5.1.1. Setup</a><a class="headerlink" href="#setup" title="Lien permanent vers ce titre">¶</a></h3>
<p>This tab facilitates the creation of a Control File from user specified parameters and inventory, as well as providing general file control variables for the other tools in the toolset.</p>
</section>
<section id="inventory">
<h3><a class="toc-backref" href="#id114">5.1.2. Inventory</a><a class="headerlink" href="#inventory" title="Lien permanent vers ce titre">¶</a></h3>
<p>The inventory tab contains a set of tools for constructing and converting flood asset inventories (‘finv’; <a class="reference internal" href="#section4-1">Section4.1</a>). The remainder of this section describes the available inventory tools.</p>
<p><strong>Inventory Construction Helper</strong></p>
<p>The optional ‘Inventory Construction Helper’ tool helps construct a Flood Asset Inventory template from some vector geometry within CanFlood’s ‘nested function’ framework (<a class="reference internal" href="#section4-1">Section4.1</a>). Additional data analysis outside the CanFlood platform is generally required to populate these fields.</p>
<p><strong>Vulnerability Function Library</strong></p>
<p>To support the construction of preliminary risk models, the CanFlood plugin provides a collection of vulnerability function libraries commonly used in Canada. Users should carefully study legacy vulnerability functions and their construction methods before incorporating them into any risk analysis. At a minimum, functions should be scaled to account for spatial and temporal transfers.</p>
<p><strong>Inventory Compiler</strong></p>
<p>The Inventory Compiler is a simple tool used to prepare an inventory vector layer for inclusion in a CanFlood model using the following process:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>clip the selected vector layer by the AOI (if one is selected on the Setup tab);</p></li>
<li><p>extract non-spatial data to the working directory as a csv; and</p></li>
<li><p>write the file location of this csv and the Index FieldName to the control file.</p></li>
</ol>
</div></blockquote>
</section>
<section id="hazard-sampler">
<span id="section5-1-3"></span><h3><a class="toc-backref" href="#id115">5.1.3. Hazard Sampler</a><a class="headerlink" href="#hazard-sampler" title="Lien permanent vers ce titre">¶</a></h3>
<p>The Hazard Sampler tool generates the exposure dataset (“expos”) from a set of hazard event rasters. Generally, these hazard event rasters represent the WSL results of some hazard model (e.g. HEC-RAS) at specific probabilities. The hazard sampler has two basic modes:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>WSL</strong>: Sample raster values at each asset (default). For line and polygon assets, this requires the user specify a sampling statistic.</p></li>
<li><p><strong>Inundation</strong>: Calculate percent-inundation of each asset (for line and polygon geometry only). This requires a DTM layer and a ‘Depth Threshold’ be specified.</p></li>
</ul>
</div></blockquote>
<img alt="../_images/toolsets_5_1_3_haz_sampler.jpg" id="figure5-1" src="../_images/toolsets_5_1_3_haz_sampler.jpg" />
<p><em>Figure 5-1: Risk calculation definition diagram where the dashed line is the WSL value of event ‘ei’</em></p>
<dl class="simple">
<dt>Using the definitions in <a class="reference internal" href="#figure5-1">Figure5-1</a>, the WSL exposure from an event <em>i</em> to a single asset <em>j</em> with height <em>elv</em> <sub>j</sub> is calculated as:</dt><dd><p><em>expo</em> <sub>i,j</sub> = <em>WSL</em> <sub>bl, ei</sub> - <em>elv</em> <sub>j</sub></p>
</dd>
</dl>
<p>The hazard sampler performs the following general steps to the set of user-supplied hazard layers and inventory layer:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Slice the inventory layer by the AOI (if ‘Project AOI’ is specified)</p></li>
<li><p>For each layer, sample the raster value or calculate the percent inundation of each asset;</p></li>
<li><p>Save the results in the ‘expos’ csv file to the working directory and write this path to the Control File;</p></li>
<li><p>Load the results layer to canvas (optional)</p></li>
</ol>
</div></blockquote>
<p><strong>Raster Preparation</strong></p>
<p>The raster sampler expects all the hazard layers to have the following properties:</p>
<blockquote>
<div><ul class="simple">
<li><p>layer CRS matches project CRS;</p></li>
<li><p>layer pixel values match those of the vulnerability functions (e.g., values are typically meters);</p></li>
<li><p>layer dataProvider is ‘gdal’ (i.e., the tool does not support processing web-layers).</p></li>
</ul>
</div></blockquote>
<p>To help rasters conform to these expectations, CanFlood includes a ‘Raster Preparation’ feature on the ‘Hazard Sampler’ tab with the tools summarized in <a class="reference internal" href="#table5-2">Table5-2</a>.</p>
<img alt="../_images/toolsets_5_1_3_hazsamp_ras_prep.jpg" src="../_images/toolsets_5_1_3_hazsamp_ras_prep.jpg" />
<p id="table5-2"><em>Table 5-2: Raster Preparation tools</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 25%" />
<col style="width: 22%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Tool Name</p></th>
<th class="head"><p>Handle</p></th>
<th class="head" colspan="2"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Downloader</p></td>
<td><p>Allow dataProvider
conversion</p></td>
<td colspan="2"><p>If the layer’s dataProvider is not ‘gdal’
(i.e., web-layers), a local copy of the layer is
made to the user’s ‘TEMP’ directory.</p></td>
</tr>
<tr class="row-odd"><td><p>Re-projector</p></td>
<td><p>Allow re-projection</p></td>
<td colspan="2"><p>If the layer’s CRS does not match that of the project,
the ‘gdalwarp’ utility is used to re-project the layer.</p></td>
</tr>
<tr class="row-even"><td><p>AOI clipper</p></td>
<td><p>Clip to AOI</p></td>
<td colspan="2"><p>This uses the ‘gdalwarp’ utility to clip the
raster by the AOI mask layer.</p></td>
</tr>
<tr class="row-odd"><td><p>Value Scaler</p></td>
<td><p>ScaleFactor</p></td>
<td colspan="2"><p>For ScaleFactors not equal to 1.0, this uses the Raster
Calculator to scale the raster values by the passed
ScaleFactor (useful for simple unit conversions).</p></td>
</tr>
</tbody>
</table>
<p>After executing these tools, a new set of rasters are loaded to the project.</p>
<p><strong>Sampling Geometry and Exposure Type</strong></p>
<p>To support a wide range of vulnerability analysis, the Hazard Sampler tool is capable of developing WSL and inundation exposure variables from the three basic geometry types as shown in <a class="reference internal" href="#table5-3">Table5-3</a>. For <em>line</em> and <em>polygon</em> type geometries, the tool requires the user specify the sample statistic for WSL calculations, and a depth threshold for percent inundation calculations.</p>
<p id="table5-3"><em>Table 5-3: Hazard Sampler configuration by geometry type and exposure type and [relevant tutorial.</em>]</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 0%" />
<col style="width: 17%" />
<col style="width: 0%" />
<col style="width: 21%" />
<col style="width: 0%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Geometry</p></th>
<th class="head" colspan="3"><p>WSL</p></th>
<th class="head" colspan="4"><p>Inundation</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Parameters</p></th>
<th class="head" colspan="2"><p>Exposure</p></th>
<th class="head" colspan="2"><p>Parameters</p></th>
<th class="head" colspan="2"><p>Exposure</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>Point</p></td>
<td><p>Default
[Tutorial 2a]</p></td>
<td colspan="2"><p>WSL</p></td>
<td colspan="2"><p>Default
[Tutorial 1a]</p></td>
<td colspan="2"><p>WSL <sup>1</sup></p></td>
</tr>
<tr class="row-even"><td><p>Line4 <sup>4</sup></p></td>
<td><p>Sample Statistic
<sup>3, 5</sup></p></td>
<td colspan="2"><p>WSL Statistic</p></td>
<td colspan="2"><p>% inundation,
Depth Thresh <sup>2</sup>
[Tutorial 4b]</p></td>
<td colspan="2"><p>% inundation</p></td>
</tr>
<tr class="row-odd"><td><p>Polygon <sup>4</sup></p></td>
<td><p>Sample Statistic
<sup>3</sup></p></td>
<td colspan="2"><p>WSL Statistic</p></td>
<td colspan="2"><p>% inundation,
Depth Thresh <sup>2</sup>
[Tutorial 4a]</p></td>
<td colspan="2"><p>% inundation</p></td>
</tr>
<tr class="row-even"><td colspan="8"><ol class="arabic simple">
<li><p>To apply a threshold depth, the f_elv values can be manually manipulated. WSL exposure values are converted to
binary-exposure (i.e., inundated or not inundated) by the Risk (L1) model.</p></li>
<li><p>Requires a DTM raster be specified on the ‘DTM Sampler’ tab. Model tools expect the asset inventory (‘finv’) to
contain a ‘f_elv’ column with all zero values and parameter.felv=’datum’. Respects NULL raster cell values as
not inundated.</p></li>
<li><p>Ignores NoData values when calculating statistics.</p></li>
<li><p>M and Z values are not supported.</p></li>
<li><p>Throws a ‘feature(s) from input layer could not be matched’ error when null values are encountered. This error
is safe to ignore.</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</section>
<section id="event-variables">
<span id="section5-1-4"></span><h3><a class="toc-backref" href="#id116">5.1.4. Event Variables</a><a class="headerlink" href="#event-variables" title="Lien permanent vers ce titre">¶</a></h3>
<p>The Event Variables ‘Store Evals’ tool stores the user specified event probabilities into the event variables (“evals”) dataset. The Hazard Sampler tool must be run first to populate the Event Variables table.</p>
<p><strong>Notes and Limitations</strong></p>
<p>The following apply to the Event Variables and connected tools:</p>
<blockquote>
<div><ul class="simple">
<li><p>The Risk (L1 and L2) modules require at least 3 events unique event probabilities.</p></li>
</ul>
</div></blockquote>
</section>
<section id="conditional-p">
<span id="section5-1-5"></span><h3><a class="toc-backref" href="#id117">5.1.5. Conditional P</a><a class="headerlink" href="#conditional-p" title="Lien permanent vers ce titre">¶</a></h3>
<p>To incorporate defense failure (<a class="reference internal" href="#section1-4">Section1.4</a>), CanFlood ‘Risk (L1)’ and ‘Risk (L2)’ models expect a resolved exposure probabilities (‘exlikes’) data set that specifies the conditional exposure probability of each asset to each hazard failure raster. The ‘Conditional P’ tool provides a conversion from a collection of failure influence area polygons and rasters (i.e., the outputs of a flood protection reliability analysis) to the resolved exposure probabilities (‘exlikes’) dataset. For each conditional failure event, the ‘Conditional P’ tool expects the user to provide a pair composed of the following layers:</p>
<blockquote>
<div><ul class="simple">
<li><p>Raster of WSL that would be realized in the failure event</p></li>
<li><p>Vector layer with polygon features indicating the extent and probability of element failures during the hazard event (‘failure polygons’). These features can be non-overlapping (simple conditionals) or overlapping (complex conditionals) as discussed below.</p></li>
</ul>
</div></blockquote>
<p>The user can specify up to eight event-raster/conditional-exposure-probability-polygon pairings with the GUI.</p>
<p>CanFlood distinguishes ‘complex’ and ‘simple’ conditional exposure probability polygons based on the geometry overlap of their features as summarized in <a class="reference internal" href="#table5-4">Table5-4</a> and shown in <a class="reference internal" href="#figure5-2">Figure5-2</a>.</p>
<p id="table5-4"><em>Table 5-4: Conditional exposure probability polygon treatment summary.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 41%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Features</p></th>
<th class="head"><p>Treatment</p></th>
<th class="head"><p>Example (Figure 5-5)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>trivial</p></td>
<td><p>none</p></td>
<td><p>Failure not considered, no resolved
exposure probabilities (‘exlikes’)
required</p></td>
<td><p>n/a</p></td>
</tr>
<tr class="row-odd"><td><p>simple</p></td>
<td><p>not overlapping</p></td>
<td><p>‘Conditional P’ tool joins the specified
attribute value from the polygon feature
onto each asset to generate resolved
exposure probabilities (‘exlikes’).</p></td>
<td><p>f2, f3</p></td>
</tr>
<tr class="row-even"><td><p>complex</p></td>
<td><p>overlapping</p></td>
<td><p>see below</p></td>
<td><p>f1</p></td>
</tr>
</tbody>
</table>
<img alt="../_images/toolsets_5_1_5_conditionalp.jpg" id="figure5-2" src="../_images/toolsets_5_1_5_conditionalp.jpg" />
<p><em>Figure 5-2:Simple [left] vs. Complex [right] conditional exposure probability polygon conceptual diagram showing a single layer with four features.</em></p>
<p>For complex conditionals, ‘Conditional P’ provides two algorithms to resolve overlapping failure polygons down to a single failure probability (for a given asset on a given failure raster) based on two alternate assumptions for the mechanistic relation between the failure mechanisms summarized in <a class="reference internal" href="#table5-5">Table5-5</a>.</p>
<p id="table5-5"><em>Table 5-5: Conditional exposure probability polygon resolution algorithms for complex conditional</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 23%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Relation</p></th>
<th class="head" colspan="2"><p>Algorithm Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mutually Exclusive</p></td>
<td colspan="2"><img alt="../_images/algorithm_summary_1.jpg" src="../_images/algorithm_summary_1.jpg" />
</td>
</tr>
<tr class="row-odd"><td><p>Independent
<sup>1</sup></p></td>
<td colspan="2"><img alt="../_images/algorithm_summary_2.jpg" src="../_images/algorithm_summary_2.jpg" />
</td>
</tr>
<tr class="row-even"><td colspan="3"><p>Where P(X) is the resolved failure probability for a single asset on a given
event and P(i) isthe failure probably value sampled from a failure polygons
feature.</p>
<ol class="arabic simple">
<li><p>Bedford and Cooke (2001)</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</section>
<section id="dtm-sampler">
<h3><a class="toc-backref" href="#id118">5.1.6. DTM Sampler</a><a class="headerlink" href="#dtm-sampler" title="Lien permanent vers ce titre">¶</a></h3>
<p>The DTM Sampler tool uses the same module as the Hazard Sampler to sample DTM raster values at each asset provided in the inventory vector layer. This tool outputs the ground elevation (‘gels’) dataset and writes the corresponding reference to the control file. This dataset is required by any model where the inventory (‘finv’) data’s height or elevation parameters are specified relative to ground (felv=’ground’).</p>
</section>
<section id="validation">
<h3><a class="toc-backref" href="#id119">5.1.7. Validation</a><a class="headerlink" href="#validation" title="Lien permanent vers ce titre">¶</a></h3>
<p>The Validation tool performs a series of checks on the specified control file to ensure the data requirements of the specified model are satisfied. If the checks are satisfied, the corresponding validation flag is set in the control file, allowing the model tool to run.</p>
</section>
</section>
<section id="model">
<span id="section5-2"></span><h2><a class="toc-backref" href="#id120">5.2. Model</a><a class="headerlink" href="#model" title="Lien permanent vers ce titre">¶</a></h2>
<img alt="../_images/run_image.jpg" class="align-right" src="../_images/run_image.jpg" />
<p>The ‘Model’ toolset provides a GUI to facilitate access to CanFlood’s 3 flood risk models. CanFlood’s L2 models are split between exposure and risk to facilitate custom applications (these can be linked using the ‘Run Risk Model (L2)’ checkbox). The following tabs are implemented in CanFlood’s Model toolset:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Setup</em>: Filepaths, run descriptions, and optional parameters used by all Model tools;</p></li>
<li><p><em>Risk (L1)</em>: Inundation likelihood analysis;</p></li>
<li><p><em>Impacts (L2)</em>: Part one of the L2 models, exposure per event calculated with vulnerability functions;</p></li>
<li><p><em>Risk (L2)</em>: Part two of the L2 models, expected value of all event impacts;</p></li>
<li><p><em>Risk (L3)</em>: SOFDA research model</p></li>
</ul>
</div></blockquote>
<p><strong>Batch Runs</strong></p>
<p>To facilitate batch simulations for advanced users, all CanFlood modelling modules have reduced dependency requirements (e.g. the QGIS API is not required).</p>
<p><strong>Parameter Summary</strong></p>
<p>The following table summarizes the relevant parameters for CanFlood’s model toolset that can be specified in the Control File:</p>
<img alt="../_images/toolsets_5_2_parameter_summary.jpg" src="../_images/toolsets_5_2_parameter_summary.jpg" />
<p>Some of these can be configured with CanFlood’s ‘Build’ toolset UI, while others must be specified manually in the Control File.</p>
<section id="risk-l1">
<span id="section5-2-1"></span><h3><a class="toc-backref" href="#id121">5.2.1. Risk (L1)</a><a class="headerlink" href="#risk-l1" title="Lien permanent vers ce titre">¶</a></h3>
<p>CanFlood’s L1 Risk tool provides a preliminary assessment of flood risk with binary exposure as discussed in <a class="reference internal" href="#section3-1">Section3.1</a>. This tool also supports conditional probability inputs to incorporate flood protection failures. <a class="reference internal" href="#table5-6">Table5-6</a> summarizes the input requirements for the Risk (L1) model, which are generally prepared using the ‘Build’ tools (<a class="reference internal" href="#figure3-1">Figure3-1</a>).</p>
<p id="table5-6"><em>Table 5-6: Risk (L1) CanFlood model package requirements.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 24%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Build Tool</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Reqd.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control File</p></td>
<td><p>Data file paths and
parameters</p></td>
<td><p>Start Control File</p></td>
<td></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Inventory</p></td>
<td><p>Tabular asset inventory
data</p></td>
<td><p>Inventory Compiler</p></td>
<td><p>finv</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>Exposure</p></td>
<td><p>WSL or %inundated
exposure data</p></td>
<td><p>Hazard Sampler</p></td>
<td><p>expos</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Event Probabilities</p></td>
<td><p>Probability of each
hazard event</p></td>
<td><p>Event Variables
of applicable</p></td>
<td><p>evals</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>Exposure Probabilities</p></td>
<td><p>Conditional probability
of each asset realizing
the failure raster</p></td>
<td><p>Conditional P</p></td>
<td><p>exlikes</p></td>
<td><p>for failure</p></td>
</tr>
<tr class="row-odd"><td><p>Ground Elevations</p></td>
<td><p>Elevation of ground at
each asset</p></td>
<td><p>DTM Sampler</p></td>
<td><p>gels</p></td>
<td><p>for felv=ground</p></td>
</tr>
</tbody>
</table>
<p>The Risk (L1) module can be used to estimate a range of simple-metrics through creative use of the asset inventory (‘finv’) fields discussed in <a class="reference internal" href="#section4-1">Section4.1</a>. When the ‘scale’ factor is set to 1, ‘height’ to zero, and no conditional probabilities are used (typical for inundation analysis), most of the calculation becomes trivial as the result is simply the impact values provided by the ‘expos’ table (with the exception of the expected value calculation).</p>
<p>Outputs provided by this tool are summarized in the following table:</p>
<p id="table5-7"><em>Table 5-7: Risk model output file summary.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Output Name</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total results</p></td>
<td><p>r_ttl</p></td>
<td><p>table of sum of impacts (for all assets) per event
and expected value of all events (EAD)</p></td>
</tr>
<tr class="row-odd"><td><p>per-asset results</p></td>
<td><p>r_passet</p></td>
<td><p>table of impacts per asset per event and expected
value of all events per asset</p></td>
</tr>
<tr class="row-even"><td><p>risk curve</p></td>
<td></td>
<td><p>risk curve plot of total impacts</p></td>
</tr>
</tbody>
</table>
</section>
<section id="impacts-l2">
<span id="section5-2-2"></span><h3><a class="toc-backref" href="#id122">5.2.2. Impacts (L2)</a><a class="headerlink" href="#impacts-l2" title="Lien permanent vers ce titre">¶</a></h3>
<p>CanFlood’s ‘Impacts (L2)’ tool is designed to perform a ‘classic’ object-based deterministic flood damage assessment using vulnerability curves, asset heights, and WSL values to estimate flood impacts from multiple events. This tool calculates the impacts on each asset from each hazard event (if the provided raster WSL was realized). ‘Impacts (L2)’ does not consider or account for event probabilities (conditional or otherwise) as these are handled in the Risk (L2) module (see <a class="reference internal" href="#section5-2-3">Section5.2.3</a>). Model package requirements are summarized in the following table:</p>
<p><em>Table 5-8: Impacts (L2) model package requirements.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 24%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Build Tool</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Reqd.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control File</p></td>
<td><p>Data file paths and
parameters</p></td>
<td><p>Start Control File</p></td>
<td></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Inventory</p></td>
<td><p>Tabular asset inventory
data</p></td>
<td><p>Inventory Compiler</p></td>
<td><p>finv</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>Exposure</p></td>
<td><p>WSL or %inundated
exposure data</p></td>
<td><p>Hazard Sampler</p></td>
<td><p>expos</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Ground Elevations</p></td>
<td><p>Elevation of ground at
each asset</p></td>
<td><p>DTM Sampler</p></td>
<td><p>gels</p></td>
<td><p>for
felv=ground</p></td>
</tr>
<tr class="row-even"><td><p>Vulnerability Function
Set</p></td>
<td><p>Collection of functions
relating exposure to
impact</p></td>
<td><p>Vulnerability
Function Library</p></td>
<td><p>curves</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
<p>Impacts (L2) outputs are summarized in the following table, where only the ‘dmgs’ output is required by the Risk (L2) model:</p>
<p><em>Table 5-9: Impacts (L2) outputs.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 13%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Output Name</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total impacts</p></td>
<td><p>dmgs</p></td>
<td><p>total impacts calculated for each asset</p></td>
</tr>
<tr class="row-odd"><td><p>expanded
component impacts</p></td>
<td><p>dmgs_expnd</p></td>
<td><p>complete impacts calculated on each nested
function of each asset (see below)</p></td>
</tr>
<tr class="row-even"><td><p>impacts calculation
summary</p></td>
<td><p>bdmg_smry</p></td>
<td><p>workbook summarizing components of the
impact calculation (see below)</p></td>
</tr>
<tr class="row-odd"><td><p>depths</p></td>
<td><p>depths_df</p></td>
<td><p>depth values calculated for each asset</p></td>
</tr>
<tr class="row-even"><td><p>impact histogram
summary</p></td>
<td></td>
<td><p>summary plot of total impact values per-asset</p></td>
</tr>
<tr class="row-odd"><td><p>impact box plot</p></td>
<td></td>
<td><p>summary plot of total impact values per-asset</p></td>
</tr>
</tbody>
</table>
<p><strong>Nested Functions</strong></p>
<p>To facilitate complex assets (e.g. a house vulnerable to structural and contents damages), Impacts (L2) supports composite vulnerability functions parameterized with the 4 key attributes (‘tag’, ‘scale’, ‘cap’, ‘elv’) with the ‘f’ prefix and ‘nestID’ numerator (e.g. f0, f1, f2, etc.) discussed in Section 4.1. In this way, CanFlood can simulate a complex vulnerability function by combining the set of simple component functions to estimate flood damage. An example entry in the asset inventory (‘finv’) for a single-family dwelling may look like:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 12%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>xid</p></td>
<td><p>f0_tag</p></td>
<td><p>f0_scale</p></td>
<td><p>f0_cap</p></td>
<td><p>f0_elv</p></td>
<td><p>f1_cap</p></td>
<td><p>f1_elv</p></td>
<td><p>f1_scale</p></td>
<td><p>f1_tag</p></td>
</tr>
<tr class="row-even"><td><p>14879</p></td>
<td><p>BA_S</p></td>
<td><p>117.99</p></td>
<td><p>91300</p></td>
<td><p>11.11</p></td>
<td><p>20000</p></td>
<td><p>11.11</p></td>
<td><p>117.99</p></td>
<td><p>BA_C</p></td>
</tr>
</tbody>
</table>
<p>Where BA_S corresponds to a vulnerability function for estimating structural cleanup/repair, and BA_C estimates household contents damages (both scaled by the floor area). Additional fX columns could be added as component vulnerability functions for basements, garages, and so on. Each of group of four key attributes is referred to as a ‘nested function’, where the collection of nested functions comprises the complete vulnerability function of an asset.</p>
<p>Impacts (L2) calculates the impact of an event ei to a single asset j from its collection of nested vulnerability functions k as:</p>
<img alt="../_images/toolsets_model_5_2_2_impacts.jpg" src="../_images/toolsets_model_5_2_2_impacts.jpg" />
<p>Where each nested vulnerability function is parameterized by the following provided in the control file (<a class="reference internal" href="#section4-1">Section4.1</a>):</p>
<blockquote>
<div><ul class="simple">
<li><p><em>tag</em>: variable linking the asset to the corresponding vulnerability curve in the vulnerability curve set (‘curves’);</p></li>
<li><p><em>cap</em>: maximum value cap placed on the vulnerability curve result;</p></li>
<li><p><em>scale</em>: scale value applied to the vulnerability curve result;</p></li>
<li><p><em>elv</em>: vertical distance from the exposure value.</p></li>
</ul>
</div></blockquote>
<p>And the following provided in the exposure dataset (‘expos’):</p>
<blockquote>
<div><ul class="simple">
<li><p><em>expo</em>: magnitude of flood exposure sampled at the asset.</p></li>
</ul>
</div></blockquote>
<p>The ‘Impacts (L2)’ routine first calculates the impacts of each nested function, then scales the values, then caps the values, before combining all the nested values to obtain the total impact for a given asset.</p>
<p>Generally, the exposure dataset (‘expos’) is constructed with the ‘Hazard Sampler’ (<a class="reference internal" href="#section5-1-3">Section5.1.3</a>) tool and contains a set of sampled WSL for each asset and each event. However, the only requirements on the ‘expos’ file are that it matches the expectations of the vulnerability functions referenced by the ‘curves’ parameter (<a class="reference internal" href="#section4-3">Section4.3</a>).</p>
<p><strong>Ground Water</strong></p>
<p>To improve performance, Impacts (L2) only evaluates assets with positive depths (when ‘ground_water’=False) and real depths. By specifying ‘ground_water’= <em>True</em> , negative depths (within the minimum depth found in all loaded damage functions) can be included in the calculation.</p>
<p><strong>Object Level Mitigation Measures</strong></p>
<p>The ‘Impacts (L2)’ model facilitates the modelling of exposure reductions brought about by object (or property) level mitigation measures (PLPM) such as backflow valves or sandbagging. The real effect of such interventions on the hydraulic exposure of buildings or property is complex and may be influenced by: 1) active vs. passive nature of the PLPM; 2) the warning time and time of day or year (for active PLPMs); 3) hydraulic loading on the PLPM; 4) quality of installation of PLPM; 5) operator experience or error (for active PLPMs); 6) maintenance of the PLPM. CanFlood does not consider this complexity; instead, CanFlood facilitates the user’s approximation through simple thresholds, scale factors, and addition values. This parameterization should be provided for each asset in the inventory vector layer (‘finv’) with <a class="reference internal" href="#section5-2-2">Section5.2.2</a> the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>Lower threshold (<em>mi_Lthresh</em>): All depths below this will generate an impact value of zero.</p></li>
<li><p>Upper threshold (<em>mi_Uthresh</em>): All depths above this will NOT have impact scale factors or impact addition values applied.</p></li>
<li><p>Impact scale factor (<em>mi_iScale</em>): For depths below the ‘upper threshold’, impact values will be scaled by this factor.</p></li>
<li><p>Impact addition value (<em>mi_ iVal</em>): For depths below the ‘upper threshold’, impact values will have this value added to them.</p></li>
</ul>
</div></blockquote>
<p><strong>Additional Outputs</strong></p>
<p>For advanced analysis, users can select the ‘dmgs_expnd’ option to output the complete impacts calculated on each nested function of each asset. This large, intermediate, data file provides the raw, scaled, capped, and resolved <a class="footnote-reference brackets" href="#id57" id="id9">2</a> impact values for each asset and each nested function. This can be useful for additional data analysis and troubleshooting but does not need to be output for any model routines (i.e., it is provided for information only).</p>
<p>Another optional output is supplied through the ‘bdmg_smry’ function and corresponding parameter that summarizes the results of each step or routine in the ‘Impacts (L2)’ module. The first tab in the spreadsheet, ‘_smry’, shows the total impacts for each event at each routine in the module. The next group of tabs summarize the impacts calculated on each ftag for the corresponding routine (e.g., ‘raw’, ‘scaled’, ‘capped’, ‘dmg’, ‘mi_Lthresh’, ‘mi_iScale’, ‘mi_iVal’). Two additional tabs are provided to summarize the calculations of the capping routine (i.e., ‘cap_cnts’ and ‘cap_data’).</p>
</section>
<section id="risk-l2">
<span id="section5-2-3"></span><h3><a class="toc-backref" href="#id123">5.2.3. Risk (L2)</a><a class="headerlink" href="#risk-l2" title="Lien permanent vers ce titre">¶</a></h3>
<p>CanFlood’s ‘Risk (L2)’ tool is designed to perform a ‘classic’ object-based deterministic flood risk assessment using impact estimates and probabilities to calculate an annualized risk metric. Beyond this classical risk model, ‘Risk (L2)’ also facilitates risk estimates that incorporate conditional hazard events, like levee failure during a 100-yr flood. This can be conceptualized with Sayers (2012)’s ‘source-pathway-receptor’ framework as shown in <a class="reference internal" href="#figure5-3">Figure5-3</a>, where:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Source</em>: WSL prediction (in raster format) for levels behind the defense (e.g. levee) of an event with a quantified likelihood.</p></li>
<li><p><em>Pathway</em>: The infrastructure element separating receptors (i.e. assets) from the raw WSL prediction. Typically, this is a levee, but could be any element where ‘failure’ likelihood and WSL can be quantified (e.g. stormwater outfall gates, stormwater pumps).</p></li>
<li><p><em>Receptor</em>: Assets vulnerable to flooding where location and relevant variables are catalogued in the inventory and vulnerability is quantified with a depth-damage function.</p></li>
</ul>
</div></blockquote>
<img alt="../_images/toolsets_5_2_3_sayers.jpg" id="figure5-3" src="../_images/toolsets_5_2_3_sayers.jpg" />
<p><em>Figure 5-3: Sayers (2012)”s Source-Path-Receptor framework.</em></p>
<p>Model package requirements for the Risk (L2) tool are summarized in the following table:</p>
<p><em>Table 5-10: Risk (L2) model package requirements.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 24%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Build Tool</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Reqd.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control File</p></td>
<td><p>Data file paths and
parameters</p></td>
<td><p>Start Control File</p></td>
<td></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Event Probabilities</p></td>
<td><p>Probability of each
hazard event</p></td>
<td><p>Event Variables</p></td>
<td><p>evals</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>Exposure Probabilities</p></td>
<td><p>Conditional probability of
each asset realizing the
failure raster</p></td>
<td><p>Conditional P</p></td>
<td><p>exlikes</p></td>
<td><p>for failure</p></td>
</tr>
<tr class="row-odd"><td><p>Total impacts</p></td>
<td><p>Output of Impacts
(L2) model</p></td>
<td><p>N/A</p></td>
<td><p>dmgs</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
<p>Outputs provided by this tool are summarized in <a class="reference internal" href="#table5-7">Table5-7</a>.</p>
<p><strong>Events without Failure</strong></p>
<p>A simple application of the ‘Risk (L2)’ model is a study area with no significant flood protection infrastructure (e.g., a floodplain with no levees), like in Tutorial 2a (<a class="reference internal" href="#section6-2">Section6.2</a>). In this case, each hazard event has a single probability and a single raster and the results from the ‘Impacts (L2)’ tool simply need to be integrated to yield the annualized risk metric. The primary risk metric calculated by CanFlood is the expected value of flood impacts E[X] (also called <em>Expected Annual Damages</em> (EAD), or <em>Average Annual Damages</em> (AAD), or <em>Annualized Loss</em>) and is defined for discrete events as:</p>
<img alt="../_images/toolsets_5_2_3_eq_1.jpg" src="../_images/toolsets_5_2_3_eq_1.jpg" />
<p>Where x <sub>i</sub> is the total impact of the event i and p <sub>i</sub> is the probability of that event occurring. While flood models discretize events out of necessity (e.g., 100yr, 200yr), real floods generate continuous hazard variables (e.g., 100 – 200yr). Therefore, the continuous form of the previous equation is required:</p>
<img alt="../_images/toolsets_5_2_3_eq_2.jpg" src="../_images/toolsets_5_2_3_eq_2.jpg" />
<p>Where <em>f(x)</em> is a function describing the probability of any event <em>x</em> (i.e., the probability density function) (USACE 1996). To align with typical discharge-likelihood expressions common in flood hazard analysis, the previous equation is manipulated further to:</p>
<img alt="../_images/toolsets_5_2_3_eq_3.jpg" src="../_images/toolsets_5_2_3_eq_3.jpg" />
<p>Where <em>Fx(x)</em> is the cumulative probability of any event <em>x</em> (e.g. cumulative distribution function). Recognizing that the complement of <em>Fx(x</em>) is the annual exceedance probability (AEP) (the probability of realizing an event of magnitude <em>x</em> or larger), this equation yields the classic ‘Risk Curve’ common in flood risk assessments shown in <a class="reference internal" href="#figure5-4">Figure5-4</a>.</p>
<img alt="../_images/toolsets_model_fig_5_4.jpg" id="figure5-4" src="../_images/toolsets_model_fig_5_4.jpg" />
<p><em>Figure 5-4: Damage-probability Curve from Messner (2007).</em></p>
<p>The following algorithm is implemented in CanFlood’s ‘Risk (L1)’ and ‘Risk (L2)’ models to calculate expected value:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Assemble a series of AEPs and total impacts for each event;</p></li>
<li><p>Extrapolate this series with the user provided extrapolation handles (‘rtail’, and ‘ltail’);</p></li>
<li><p>Use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html">numpy integration</a> method specified by the user to calculate the area under the series.</p></li>
</ol>
</div></blockquote>
<p>The same algorithm is used for calculating the total expected value across all assets and for the expected value of individual assets (if ‘res_per_asset’=True).</p>
<p><strong>Events with Failure</strong></p>
<p>When resolving a hazard event with some failure, CanFlood combines the expected value (E(X)) of each companion failure event with that of a base ‘no-fail’ event to obtain the event’s total expected value required by the risk metric equation (formula 4). To provide flexibility in the data requirements from a defense reliability analysis, CanFlood distinguishes two failure event analysis dimensions based on the geometry of the provided conditional exposure probability polygons (‘failure polygons’) and the number of failure events as summarized in <a class="reference internal" href="#figure5-5">Figure5-5</a>. ‘Failure polygons’ complexity is discussed in Section 5.1.5 and is resolved into the resolved exposure probabilities (‘exlikes’) dataset by calculating a single exposure probability for each companion failure event (<a class="reference internal" href="#figure5-5">Figure5-5</a> ‘b1’ and ‘b2’ into ‘f1’). Once simplified into this resolved exposure probabilities (‘exlikes’) dataset, a failure event’s failure polygons set relation, count, and complexity is ignored.</p>
<img alt="../_images/toolsets_model_fig_5_5.jpg" id="figure5-5" src="../_images/toolsets_model_fig_5_5.jpg" />
<p><em>Figure 5-5: Example diagram showing three hazard events, one without failure (e3), one with simple (e2) and one with complex failure events (e1), and two companion failure events with simple (f2, f3) and the other (f1) with complex conditional exposure probability polygons (failure polygons).</em></p>
<p><a class="reference internal" href="#table5-11">Table5-11</a> summarizes the treatment of hazard events based on the count of failure events assigned to each.</p>
<p id="table5-11"><em>Table 5-11: Hazard event treatment by failure event count.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 40%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Treatment <sup>1</sup></p></th>
<th class="head"><p>Example (<a class="reference internal" href="#figure5-5">Figure5-5</a>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>trivial</p></td>
<td><p>0</p></td>
<td><p>E(X)fail=0
E(X)nofail from equation 2</p></td>
<td><p>e3</p></td>
</tr>
<tr class="row-odd"><td><p>simple</p></td>
<td><p>1</p></td>
<td><p>‘max’ or ‘mutEx’</p></td>
<td><p>e2</p></td>
</tr>
<tr class="row-even"><td><p>complex</p></td>
<td><p>&gt;1</p></td>
<td><p>‘max’, ‘mutEx’ or ‘indep’</p></td>
<td><p>e1</p></td>
</tr>
<tr class="row-odd"><td colspan="4"><ol class="arabic simple">
<li><p>See <a class="reference internal" href="#table5-12">Table5-12</a></p></li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>Events with Complex Failure</strong></p>
<p><a class="reference internal" href="#table5-12">Table5-12</a> summarize the algorithms implemented in CanFlood to calculate expected value for those hazard events with more than one companion failure event i.e., ‘complex’ failure events.</p>
<p id="table5-12"><em>Table5-12: Expected value algorithms for failure events.</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 10%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Modified Maximum</p></td>
<td><p>max</p></td>
<td><img alt="../_images/toolsets_model_table_5_12_eq_1.jpg" src="../_images/toolsets_model_table_5_12_eq_1.jpg" />
</td>
</tr>
<tr class="row-odd"><td><p>Mutually Exclusive</p></td>
<td><p>mutEx</p></td>
<td><img alt="../_images/toolsets_model_table_5_12_eq_2.jpg" src="../_images/toolsets_model_table_5_12_eq_2.jpg" />
</td>
</tr>
<tr class="row-even"><td><p>Independent</p></td>
<td><p>indep</p></td>
<td><ol class="loweralpha">
<li><p>Construct a matrix of all possible failure event combinations
(positives=1 and negatives=0)</p></li>
<li><p>Substitute matrix values with P and (1-P)</p></li>
<li><p>Multiply the set to obtain the probability of the combination
(P <sub>comb</sub>)</p></li>
<li><p>Multiply P <sub>comb</sub> by the maximum impact of events within
the set to obtain the combination’s impact (C <sub>comb</sub>)</p></li>
<li><img alt="../_images/toolsets_model_table_5_12_eq_3.jpg" src="../_images/toolsets_model_table_5_12_eq_3.jpg" />
</li>
</ol>
</td>
</tr>
<tr class="row-odd"><td colspan="3"><p>P(o) = 1-sum(C <sub>i</sub>)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="risk-l3">
<span id="section5-2-4"></span><h3><a class="toc-backref" href="#id124">5.2.4. Risk (L3)</a><a class="headerlink" href="#risk-l3" title="Lien permanent vers ce titre">¶</a></h3>
<p>Bryant (2019) developed the Stochastic Object-based Flood damage Dynamic Assessment model framework (SOFDA) to simulate flood risk over time using the Alberta Curves and a residential re-development forecast. Framework development was motivated by a desire to quantify the benefits of Flood Hazard Regulations (FHRs) and to help incorporate the dynamics of risk into decision-making. SOFDA quantifies flood risk of an asset through the use of direct-damage and depth-likelihood functions. In this way, flood risk can be quantified (e.g. monetized) at fine spatial resolutions for robust decision support.</p>
<p>SOFDA has the following capabilities:</p>
<blockquote>
<div><ul class="simple">
<li><p>Estimate the vulnerability reduction of Flood Hazard Regulations;</p></li>
<li><p>Estimate the vulnerability reduction of Property Level Protection Measures;</p></li>
<li><p>Estimate the influence of elevating damage-features (e.g., raising water heaters);</p></li>
<li><p>Simulate changes in relevant building typology brought about by re-development (e.g., larger homes with deeper basements);</p></li>
<li><p>Dynamic and flexible modeling of many model components (e.g., more expensive water heaters)</p></li>
<li><p>Provide some quantification of uncertainty (i.e., stochastic modeling);</p></li>
<li><p>Provide detailed outputs to facilitate the analysis of underlying mechanisms.</p></li>
</ul>
</div></blockquote>
<p>For additional information and guidance, see <a class="reference internal" href="#appendix-b">Appendix B</a>.</p>
</section>
</section>
<section id="results">
<span id="section5-3"></span><h2><a class="toc-backref" href="#id125">5.3. Results</a><a class="headerlink" href="#results" title="Lien permanent vers ce titre">¶</a></h2>
<img alt="../_images/visual_image.jpg" class="align-right" src="../_images/visual_image.jpg" />
<p>The ‘Results’ toolset is a collection of tools to assist the user in performing secondary data analysis and visualization on CanFlood models. The remainder of this section describes the function of the tools within this toolset.</p>
<section id="join-geo">
<h3><a class="toc-backref" href="#id126">5.3.1. Join Geo</a><a class="headerlink" href="#join-geo" title="Lien permanent vers ce titre">¶</a></h3>
<p>This tab provides a tool to join the non-spatial risk results back onto the inventory geometry for spatial post-processing. A basic version of this tool can be run automatically by the ‘Risk (L1)’ and ‘Risk (L2)’ tools. On the ‘Join Geo’ tab, the user can perform additional customization of these layers, including applying pre-packaged layer styles.</p>
</section>
<section id="risk-plot">
<h3><a class="toc-backref" href="#id127">5.3.2. Risk Plot</a><a class="headerlink" href="#risk-plot" title="Lien permanent vers ce titre">¶</a></h3>
<p>This tab contains multiple tools for generating non-spatial plots on a single model scenario. The plots generated on this tab all pull style information from the Control File’s ‘[plotting]’ group, and results data from the ‘[results_fp]’ group. Plots are available in the two standard risk curve formats:</p>
<blockquote>
<div><ul class="simple">
<li><p>ARI vs. Impacts</p></li>
<li><p>Impacts vs. AEP</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#section6-3-3">Section6.3.3</a> for examples.</p>
<p><strong>Plot Total</strong></p>
<p>This tool generates a simple plot of the total results. A basic version of this tool can be run automatically from the ‘Risk (L1)’ and ‘Risk (L2)’ tools for convenience.</p>
<p><strong>Plot Stack</strong></p>
<p>This tool generates risk curves showing the total contributions from each composite vulnerability functions discussed in <a class="reference internal" href="#section4-1">Section4.1</a> on a single plot.</p>
<p><strong>Plot Fail Split</strong></p>
<p>This tool generates composite risk curve showing the total results with a second curve showing the contribution from the ‘non-failure’ portion of each event (i.e., subtracting any contributions from companion failure events) on a single plot.</p>
</section>
<section id="compare-combine">
<h3><a class="toc-backref" href="#id128">5.3.3. Compare/Combine</a><a class="headerlink" href="#compare-combine" title="Lien permanent vers ce titre">¶</a></h3>
<p>This tab provides two tools for combining or comparing multiple CanFlood models within a single analysis. For example, a flood risk analysis considering agricultural losses and residential building damages would generally construct two separate models (i.e., separate control files) and combine the results at the end to understand the total risk. Alternatively, an analysis may wish to compare two mitigation alternatives.</p>
<p><strong>Compare</strong></p>
<p>The compare tool collects the total results dataset (‘r_ttl’) and parameters from the set of specified control files and produces two comparison outputs:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Control file comparison</em>: generates a datafile populated with the parameters from each selected control file, and a final column indicating if the parameter varies across the set. This can be useful to indicate what separates two CanFlood models.</p></li>
<li><p><em>Plot comparison</em>: creates a risk curve plot comparing the total results data set (‘r_ttl’) of all selected control files. Default plot values are taken from the control file specified on the ‘Setup’ tab.</p></li>
</ul>
</div></blockquote>
<p><strong>Combine</strong></p>
<p>The combine tool collects the total results dataset (‘r_ttl’) and parameters from the main control file (from the ‘Setup’ tab) to generate two types of outputs:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>Composite scenario</em>: Select this option when running the “Combine” tool to generate a new composite control file and “r_ttl” results file for further analysis.</p></li>
<li><p><em>Plot combine</em>: creates a stacked risk curve showing the contribution towards the total risk of each selected control file.</p></li>
</ul>
</div></blockquote>
</section>
<section id="benefit-cost-analysis">
<h3><a class="toc-backref" href="#id129">5.3.4. Benefit-Cost Analysis</a><a class="headerlink" href="#benefit-cost-analysis" title="Lien permanent vers ce titre">¶</a></h3>
<p>This tab provides two tools to support basic benefit-cost calculations commonly used in flood mitigation options assessments. Benefit-cost analysis (BCA) is a complex process discussed elsewhere (Merz et al. 2010; Smith et al. 2016; IWR and USACE 2017) that carries many challenges and short-comings when applied to decisions around flood mitigation (O’Connell and O’Donnell 2014; Hosein 2016). In short, BCA compares the net-present value of an intervention’s costs (e.g., construction, maintenance) to the benefit or flood-loss avoidance gained by the intervention. Through the application of a discounting rate in these net-present value calculations, BCA are sensitive to the timing or accrual of benefits and costs. A typical workflow in CanFlood implementing BCA is provided below:</p>
<img alt="../_images/toolsets_model_fig_5_3_4.jpg" src="../_images/toolsets_model_fig_5_3_4.jpg" />
<p>To support simple BCA calculations, CanFlood’s ‘BCA’ tab provides the following tools:</p>
<p><strong>Copy BCA Template</strong></p>
<p>This tool copies the CanFlood BCA template (‘cf_bca_template_01.xlsx’, see below), which has a ‘smry’ and ‘data’ tab, and populates the ‘smry’ tab with metadata from the main control file. This .xlsx file provides a generic template for inputting project cost and benefit time series and calculating summary financial values, like benefit-cost ratio, using EXCEL’s built-in formulas. The workbook contains excel ‘notes’ and implements the following styles to guide users when completing the template:</p>
<img alt="../_images/toolsets_model_fic_5_3_4_legend.jpg" src="../_images/toolsets_model_fic_5_3_4_legend.jpg" />
<p>A portion of the ‘data’ tab is provided below. Users should populate the input cells using the development, operating, and flood loss avoidance values for the option under consideration. Key cells on the ‘input’ tab are ‘named’ to facilitate populating the data tab dynamically.</p>
<img alt="../_images/toolsets_model_fig_5_6.jpg" src="../_images/toolsets_model_fig_5_6.jpg" />
<p><em>Figure 5-6: CanFlood BCA template ‘data’ tab.</em></p>
<p>Once the ‘data’ tab is complete, enter an appropriate ‘discount rate’ should be entered on the ‘smry’ tab. Positive discounting rates are commonly used in financial analysis to reflect the view that things of value (e.g., capital) are worth more today than in the future. This should not be confused with inflation. The application of positive discounting rates is inappropriate when evaluating assets with increasing scarcity, like ecosystem function and wild spaces. Some authors and guidelines propose variable discounting rates (Smith et al. 2016). Guidance on selecting an appropriate discounting rate is provided elsewhere (Farber 2016).</p>
<p>After populating the ‘data’ and ‘smry’ tabs, the workbook should display the results summarized below:</p>
<dl class="field-list simple">
<dt class="field-odd">PV benefits $</dt>
<dd class="field-odd"><p>Present Value of benefit totals</p>
</dd>
<dt class="field-even">PV costs $</dt>
<dd class="field-even"><p>Present value of cost totals</p>
</dd>
<dt class="field-odd">NPV $</dt>
<dd class="field-odd"><p>Net-present value of costs and benefits</p>
</dd>
<dt class="field-even">B/C ratio</dt>
<dd class="field-even"><p>Ratio of PV benefits over PV costs</p>
</dd>
</dl>
<p><strong>Plot Financials</strong></p>
<p>This tool generates a financial time-series plot of the benefit and cost data contained in the BCA worksheet.</p>
</section>
</section>
<section id="additional-tools">
<h2><a class="toc-backref" href="#id130">5.4. Additional Tools</a><a class="headerlink" href="#additional-tools" title="Lien permanent vers ce titre">¶</a></h2>
<p>The following section describes some additional tools provided in the CanFlood platform that support flood risk modelling in Canada. These can be accessed from the CanFlood menu (Plugins &gt; CanFlood).</p>
<section id="dike-fragility-mapper">
<span id="section5-4-1"></span><h3><a class="toc-backref" href="#id131">5.4.1. Dike Fragility Mapper</a><a class="headerlink" href="#dike-fragility-mapper" title="Lien permanent vers ce titre">¶</a></h3>
<p>For risk models that incorporate dike defense failure, a dataset containing the conditional probabilities of each asset realizing the failure, called the resolved exposure probability (‘exlikes’) dataset, is required by the Risk (L1) and Risk (L2) modules. Generally, this dataset is generated from a set of ‘failure polygons’ using the ‘Conditional P’ tool in the build toolset (<a class="reference internal" href="#section5-1-5">Section5.1.5</a>). While some projects may have these ‘failure polygons’ available, often only event rasters and the dike information discussed in <a class="reference internal" href="#section4-5">Section4.5</a> is available. For cases like this, the workflow summarized in <a class="reference internal" href="#figure5-7">Figure5-7</a> can be employed, beginning with the ‘Dike Fragility Mapper’ tool which provides a collection of algorithms that can be used to generate failure polygons from typical dike information.</p>
<img alt="../_images/toolsets_5_4_1_fig_5_7.jpg" id="figure5-7" src="../_images/toolsets_5_4_1_fig_5_7.jpg" />
<p><em>Figure 5-7: Typical CanFlood tools workflow, incorporating dike fragility, where the ‘Dike Fragility Mapper’ tool is used to develop the failure polygons data layer.</em></p>
<p>The ‘Dike Fragility Mapper’ tool is similar in many ways to the Impacts (L2) module applied to assets with linear geometry, but with the addition of special offset raster sampling, intelligent joining of the results to polygons, and segmentation considerations specific to dike analysis. This tool is executed in the three steps summarized below. For more information on applying this tool, see Tutorial 6a (<a class="reference internal" href="#section6-11">Section6.11</a>).</p>
<p><strong>Dike Exposure</strong></p>
<p>The dike exposure sub-tool determines the location of highest vulnerability on each dike segment, then returns the corresponding freeboard value of each event raster yielding the dike segment exposure (‘dexpo’) dataset. This is accomplished with the following sequence:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Generate transects at specified intervals on specified side of each dike segment (red lines on <a class="reference internal" href="#figure5-8">Figure5-8</a>).</p></li>
<li><p>Sample the dike crest elevation from the DTM raster at the head of each transect;</p></li>
<li><p>Sample each event WSL raster on each transect;</p></li>
<li><p>Calculate the freeboard values on each transect as the difference between the sampled WSL and crest elevation values;</p></li>
<li><p>Calculate the segment freeboard value by applying the summary statistic to the relevant transect values (default is the minimum value).</p></li>
</ol>
</div></blockquote>
<img alt="../_images/toolsets_5_4_1_fig_5_8.jpg" id="figure5-8" src="../_images/toolsets_5_4_1_fig_5_8.jpg" />
<p><em>Figure 5-8: Example algorithm components for the Dike Fragility Mapper tool’s exposure routine</em></p>
<p>This sub-tool provides the following outputs:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>dike segment exposure (‘dexpo’) dataset</em>: freeboard .csv output and main input to the Dike Vulnerability sub-tool;</p></li>
<li><p><em>processed dikes layer</em> (optional): this is a modified version of the original input file, showing the ‘dexpo’ data on the original dikes geometry.</p></li>
<li><p><em>transects layer</em> (optional): these are the perpendicular segments of length and spacing specified by the user where the crest elevation and WSL sampling are performed at the head and tail respectively;</p></li>
<li><p><em>transect exposure points</em> (optional): each transect head with all calculated values;</p></li>
<li><p><em>breach points layer</em> (optional): transect heads with negative freeboard values;</p></li>
<li><p><em>dike segment profile plots</em> (optional): profile plot of dike segment showing sampled crest elevations and WSL (see below).</p></li>
</ul>
</div></blockquote>
<img alt="../_images/toolsets_5_4_1_fig_5_8_2.jpg" src="../_images/toolsets_5_4_1_fig_5_8_2.jpg" />
<p><strong>Dike Vulnerability</strong></p>
<p>The ‘Dike Vulnerability’ sub-tool feeds the relevant entry in the dike segment exposure (‘dexpo’) dataset into the fragility curve associated with each dike segment. This sub-tool outputs tabular failure probability data (‘pfail’) csv file.</p>
<p>The following algorithms are available to adjust the resulting failure probabilities for the ‘length effect’:</p>
<blockquote>
<div><ul class="simple">
<li><p>URS (2008): normalize all failure probabilities by the set of segment lengths.</p></li>
</ul>
</div></blockquote>
<p>A similar secondary output is provided for these length-adjusted values.</p>
<p><strong>Dike Failure Probability Results Join</strong></p>
<p>This tool simply joins the selected tabular failure probability data to provided dike influence polygons to generate the ‘failure polygons’ required by the ‘Conditional P’ tool (<a class="reference internal" href="#section5-1-5">Section5.1.5</a>).</p>
<p><strong>Notes and Considerations</strong></p>
<p>When applying the Dike Fragility Mapper to your project, the following should be considered:</p>
<blockquote>
<div><ul class="simple">
<li><p>CanFlood does not perform any hydraulic analysis, the user must supply influence polygons denoting the area over which assets should have their probability of realizing the corresponding failure raster WSL. Considering this, influence polygons can safely extend beyond the raster extents without affecting the calculation of failure impacts.</p></li>
<li><p>Fragility functions should be developed and tagged to each raster segment by a qualified geotechnical expert using field data.</p></li>
</ul>
</div></blockquote>
</section>
<section id="add-connections">
<h3><a class="toc-backref" href="#id132">5.4.2. Add Connections</a><a class="headerlink" href="#add-connections" title="Lien permanent vers ce titre">¶</a></h3>
<p>CanFlood’s ‘Add Connections’ <a class="reference internal" href="../_images/add_connections_image.jpg"><img alt="addConnectionsImage" class="align-middle" src="../_images/add_connections_image.jpg" style="width: 22px;" /></a> tool adds a pre-compiled set of web-resources to a user’s QGIS profile for easy access and configuration (i.e., adding credentials). The set of web-resources added by this tool are configured in the ‘canflood_parsWebConnections.ini’ file (in the user’s plugin directory). <a class="reference internal" href="#appendix-a">Appendix A</a> summarizes the web-connections added by this tool.</p>
<p>The <a class="reference external" href="https://docs.qgis.org/3.10/en/docs/user_manual/working_with_ogc/ogc_client_support.html#wms-wmts-client">QGIS User Guide</a> explains how to manage and access these connections. Once the resources are added to a user’s profile, two basic methods can be used to add the data to the project:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Browser Panel</strong>: This is the simplest method but does not support any refinement of the data request. On the Browser Panel, expand the provider type of interest (e.g., ArcGisFeatureServer) &gt; expand the connection of interest &gt; select the layer of interest &gt; right click &gt; Add Layer To Project.</p></li>
<li><p><strong>Data Source Manager</strong>: This is the recommended method as it provides more versatility when adding from data connections. Open the Data Source Manager (Ctrl + L) &gt; select the provider type of interest &gt; select the server of interest &gt; select the layer of interest &gt; specify any additional request parameters &gt; click ‘Add’ to load the layer in the project.</p></li>
</ul>
</div></blockquote>
<p>Many plugins and tools used by QGIS (and CanFlood) do not support such web-layers (esp. rasters), so conversion and download may be required.</p>
</section>
<section id="rfda-converter">
<h3><a class="toc-backref" href="#id133">5.4.3. RFDA Converter</a><a class="headerlink" href="#rfda-converter" title="Lien permanent vers ce titre">¶</a></h3>
<p>The Rapid Flood Damage Assessment (RFDA) tool was developed by the Province of Alberta in 2014 as a QGIS 2 plugin. RFDA did not include any spatial analysis or risk calculations. RFDA inventories are in Excel spreadsheet format (.xls) indexed by column location (not labels). Curves are tagged to assets using a concatenation of columns 11 and 12. Many columns in the inventory are ignored in RFDA. These are the functional columns:</p>
<blockquote>
<div><ul class="simple">
<li><p>0:”id1”,</p></li>
<li><p>10:”class”,</p></li>
<li><p>11:”struct_type”,</p></li>
<li><p>13:”area”,</p></li>
<li><p>18:”bsmt_f”,</p></li>
<li><p>19:”ff_height”,</p></li>
<li><p>20:”lon”,*</p></li>
<li><p>21:”lat”,*</p></li>
<li><p>25:”gel”</p></li>
</ul>
</div></blockquote>
<p>*not used by RFDA, but necessary for spatial analysis.</p>
<p>RFDA uses a legacy format for reading damage functions based on alternating column locations. An example is provided below:</p>
<img alt="../_images/toolsets_5_4_3_img.jpg" src="../_images/toolsets_5_4_3_img.jpg" />
<p>RFDA was developed in parallel with a set of 1D damage functions from building surveys of structures in Edmonton and Calgary, AB in 2014. Curves for building replacement/repair and contents damage were developed separately. Residential curves for main floor and basement were developed separately.</p>
<p>During a model run, RFDA applies a contents and structural curve to each asset, and the corresponding basement pair to those with ‘bsmt_f’=True.</p>
<p>To facilitate converting from RFDA inventories to CanFlood format, two tools are provided:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Inventory converter; and</p></li>
<li><p>Damage Curve converter.</p></li>
</ol>
</div></blockquote>
<p><strong>Inventory Conversion</strong></p>
<p>The RFDA Inventory Conversion requires a point vector layer as an input <a class="footnote-reference brackets" href="#id58" id="id10">3</a>. For Residential Inventories (those with struct_type not beginning with ‘S’), each asset is assigned a f0_tag with an ‘_M’ suffix to denote this as a main floor curve (e.g. BD_M) based on the concatenated ‘class’ and ‘struct_type’ values in the inventory. Using the ‘bsmt_f’ value, the f1_tag is also assigned with a ‘_B’ suffix. These suffixes correspond to the curve naming of the DamageCurves tool (described below). The f1_elv is assigned from: f0_elv – bsmt_ht.</p>
<p>For Commercial Inventories (those with struct_type beginning with ‘S’), the f0_tag and f1_tag fields are populated with the ‘struct_type’ and ‘class’ values separately. Where ‘bsmt_f’ = True, a third f2_tag=’ nrpUgPark’ is added to denote the presence of underground parking <a class="footnote-reference brackets" href="#id59" id="id11">4</a>. Once converted, the user can start the CanFlood model building process.</p>
<p><strong>DamageCurves Converter</strong></p>
<p>This tool converts the RFDA format curves into a CanFlood curve set (one curve per tab). The following combinations of RFDA curves are constructed:</p>
<blockquote>
<div><ul class="simple">
<li><p>Individual (e.g. main floor contents)</p></li>
<li><p>Floor combined (e.g. main floor structural and contents)</p></li>
<li><p>Type combined (e.g. structural basement and mainfloor)</p></li>
<li><p>All combined</p></li>
</ul>
</div></blockquote>
<p>This allows the user to customize which curves are applied and how to each asset (with CanFlood’s ‘composite vulnerability function’ feature).</p>
</section>
<section id="add-styles">
<h3><a class="toc-backref" href="#id134">5.4.4. Add Styles</a><a class="headerlink" href="#add-styles" title="Lien permanent vers ce titre">¶</a></h3>
<p>To augment the symbol styles packed in QGIS for modifying the display of vector layer features, CanFlood includes a small library of styles typical for GIS flood projects. This library is an .xml file in the plugin directory, and can be added to your style manager through the CanFlood menu as shown below:</p>
<img alt="../_images/toolsets_5_4_4_img.jpg" src="../_images/toolsets_5_4_4_img.jpg" />
<p>Once executed, these symbols should be available for styling relevant vector layers through one of the QGIS layer styling dialogs. For example, the ‘CanFlood’ group can be accessed via the ‘Layer Styling’ pane (F7) as shown below:</p>
<img alt="../_images/toolsets_5_4_4_layer_styling.jpg" src="../_images/toolsets_5_4_4_layer_styling.jpg" />
<p>The QGIS ‘Styling Manager’ <a class="reference internal" href="../_images/styling_manager_image.jpg"><img alt="stylingManager" class="align-middle" src="../_images/styling_manager_image.jpg" style="width: 30px;" /></a> provides an interface for organizing and other tasks related to styles.</p>
</section>
</section>
</section>
<section id="tutorials">
<span id="section6"></span><h1><a class="toc-backref" href="#id135">6. Tutorials</a><a class="headerlink" href="#tutorials" title="Lien permanent vers ce titre">¶</a></h1>
<p>This section provides a few tutorials to get a user started in CanFlood. It is suggested to work through the tutorials sequentially, referring to Section 5 when more detailed information is desired. For all tutorials, the project CRS can safely be set from any of the data layers, unless otherwise specified. Tutorials are written assuming users are familiar with QGIS and object-based flood risk modelling. All tutorial data can be found in the latest <a class="reference external" href="https://github.com/IBIGroupCanWest/CanFlood/blob/master/tutorial_data_20210315.zip">‘tutorial_data’ zip</a> on the project page.</p>
<section id="tutorial-1a-risk-l1">
<span id="section6-1"></span><h2><a class="toc-backref" href="#id136">6.1. Tutorial 1a: Risk (L1)</a><a class="headerlink" href="#tutorial-1a-risk-l1" title="Lien permanent vers ce titre">¶</a></h2>
<p>This tutorial guides the user through the simplest application of risk modelling in CanFlood, called a level 1 (L1) analysis, where only binary exposure is calculated. This ‘exposed vs. not exposed’ analysis can be useful for preliminary analysis where there is insufficient information to model more complex object vulnerability.</p>
<section id="load-data-to-the-project">
<h3><a class="toc-backref" href="#id137">6.1.1. Load data to the project</a><a class="headerlink" href="#load-data-to-the-project" title="Lien permanent vers ce titre">¶</a></h3>
<p>Download the data layers for Tutorial 1:</p>
<blockquote>
<div><ul>
<li><p><em>haz_rast</em>: hazard event rasters with WSL value predictions for the study area for four probabilities.</p>
<p>o <em>haz_0050.tif</em></p>
<p>o <em>haz_0100.tif</em></p>
<p>o <em>haz_0200.tif</em></p>
<p>o <em>haz_1000.tif</em></p>
</li>
<li><p><em>finv_tut1a.gpkg</em> : flood asset inventory (’finv’) spatial layer.</p></li>
</ul>
</div></blockquote>
<p>Ensure your project’s CRS is set to ‘EPSG:3005’ <a class="footnote-reference brackets" href="#id60" id="id12">5</a> and load the downloaded layers into a new QGIS project <a class="footnote-reference brackets" href="#id61" id="id13">6</a>. Your map canvas should look something like this:</p>
<img alt="../_images/tutorials_6_1_1_tiff.jpg" src="../_images/tutorials_6_1_1_tiff.jpg" />
<p>Explore the flood asset inventory (‘finv’) layer’s attributes (F6). You should see something like this:</p>
<img alt="../_images/tutorials_6_1_1_table.jpg" src="../_images/tutorials_6_1_1_table.jpg" />
<p>The 4 fields are:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>fid</em>: built-in feature identifier (not used);</p></li>
<li><p><em>xid</em>: Index FieldName, unique identifier for the asset <a class="footnote-reference brackets" href="#id62" id="id14">7</a>;</p></li>
<li><p><em>f0_scale</em>: value to scale the results of the ‘f0’ calculation for this asset;</p></li>
<li><p><em>f0_elv</em>: height (above the project datum) at which the asset is vulnerable to flooding.</p></li>
</ul>
</div></blockquote>
<p>For this example, each inventory entry or ‘asset’ could represent a home with the main floor elevation entered into ‘f0_elv’. Any flood waters above this elevation will be tabulated as an impact for that asset. For CanFlood’s L1 analysis, based on the user supplied likelihood of each event, the total ‘risk of inundation’ for each asset and for the full study area will be computed.</p>
</section>
<section id="build-the-model">
<span id="section6-1-2"></span><h3><a class="toc-backref" href="#id138">6.1.2. Build the Model</a><a class="headerlink" href="#build-the-model" title="Lien permanent vers ce titre">¶</a></h3>
<p>Press the ‘Build’ button <a class="reference internal" href="../_images/build_image.jpg"><img alt="buildimage" class="align-middle" src="../_images/build_image.jpg" style="width: 22px;" /></a> to begin building a CanFlood model.</p>
<p><strong>Setup</strong></p>
<p>On the ‘Setup’ tab, configure your ‘Build Session’ by first creating or selecting an easy to locate working directory using the ‘Browse’ button. CanFlood will place all the data files assembled with the ‘Build’ toolset in this directory. Ensure the remaining ‘Build Controls’ are specified as shown below.</p>
<p>Now use the lower portion of the dialog to specify the parameters CanFlood should use to assemble your new Control File as shown below.</p>
<img alt="../_images/tutorials_6_1_2_img_1.jpg" src="../_images/tutorials_6_1_2_img_1.jpg" />
<p>Once the parameters are correctly entered, <strong>click ‘Start Control File’</strong> to create your Control File in the working directory. There should be a message on the QGIS Toolbar indicating the process ran successfully.</p>
<p>If you view the ‘CanFlood’ Log Messages Tab (View &gt; Panels &gt; Log Messages), you can see the log messages for the process you just completed. It should look something like this:</p>
<img alt="../_images/tutorials_6_1_2_img_2.jpg" src="../_images/tutorials_6_1_2_img_2.jpg" />
<p>Back in CanFlood’s ‘Setup’ tab, next to the working directory file path, click ‘Open’ to open the specified working directory, you should see the Control File ‘CanFlood_Tut1.txt’ created in your working directory. Open the control file. This is a template with some blank, default, and specified parameters. As you work through the remainder of ‘Build’ section of this tutorial, blank parameters will be filled in by the CanFlood tools. Notice the ‘#’ comment letting you know how and when this control file was created. ‘#’ comment lines are ignored by the program when reading from the control file, and are written by some tools to help the user track actions taken by CanFlood on the control file.</p>
<p><strong>Store Inventory</strong></p>
<p>Move to the ‘Inventory’ tab. Under the Inventory Compiler section, select the inventory layer (<em>finv_tut1a</em>) and ensure ‘elevation type’ is set to ‘datum’ to reflect that the inventory’s ‘f0_elv’ values are measured from the project’s datum (rather than ground). Now select the inventory vector layer and the appropriate ‘Index FieldName’ as shown, then <strong>click ‘Store’</strong>.</p>
<img alt="../_images/tutorials_6_1_2_img_3.jpg" src="../_images/tutorials_6_1_2_img_3.jpg" />
<p>You should see the inventory csv file stored into the working directory. This is a simplified version of the inventory layer with the spatial data removed. Open the Control File again. You should notice that asset inventory (‘finv’) parameter has been populated with the file name of the newly created csv.</p>
<p><strong>Hazard Sampler</strong></p>
<p>Move to the ‘Hazard Sampler’ tab. Check all the hazard rasters in the display box as shown <a class="footnote-reference brackets" href="#id63" id="id15">8</a>, leaving the remaining parameters blank or untouched:</p>
<img alt="../_images/tutorials_6_1_2_img_4.jpg" src="../_images/tutorials_6_1_2_img_4.jpg" />
<p><strong>Click ‘Sample Rasters’</strong> to generate the exposure (‘expos’) dataset. You should see a new csv file in the working directory, and its filepath added to the control file under ‘expos’. These are the WSLs sampled at each asset from each hazard event raster.</p>
<p><strong>Event Variables</strong></p>
<p>Now that the WSLs have been stored, we need to tell CanFlood what the probability of realizing each of these events is. Move to the ‘Event Variables’ tab. Specify the correct values for each event’s likelihood (from the event names) as shown:</p>
<img alt="../_images/tutorials_6_1_2_img_5.jpg" src="../_images/tutorials_6_1_2_img_5.jpg" />
<p><strong>Press ‘Store’</strong>. The event probabilities (‘evals’) dataset should have been created and its filepath written to the Control File under ‘evals’.</p>
<p><strong>Validation</strong></p>
<p>Move to the ‘Validation’ tab, <strong>check ‘Risk (L1)’</strong>, then <strong>click ‘Validate’</strong>. This will check all the inputs in the control file and set the ‘risk1’ validation flag to ‘True’ in the control file. Without this flag, the CanFlood model will fail.</p>
<p>The control file should now be fully built for an L1 analysis and the necessary inputs assembled. The completed control file should look similar to this (but with your directories):</p>
<img alt="../_images/tutorials_6_1_2_img_6.jpg" src="../_images/tutorials_6_1_2_img_6.jpg" />
</section>
<section id="run-the-model">
<h3><a class="toc-backref" href="#id139">6.1.3. Run the Model</a><a class="headerlink" href="#run-the-model" title="Lien permanent vers ce titre">¶</a></h3>
<p>Click the ‘Model’ button <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> to launch the Model toolset dialog.</p>
<p><strong>Setup</strong></p>
<p>On the ‘Setup’ tab, select a working directory <a class="footnote-reference brackets" href="#id64" id="id16">9</a> where all your results will be stored. Also select your control file created in the previous section if necessary.</p>
<p>Your dialog should look like this <a class="footnote-reference brackets" href="#id65" id="id17">10</a>:</p>
<img alt="../_images/tutorials_6_1_3_img_1.jpg" src="../_images/tutorials_6_1_3_img_1.jpg" />
<p><strong>Execute</strong></p>
<p>Navigate to the ‘Risk (L1)’ tab. Check the first two boxes as shown below and <strong>press ‘Run risk1’</strong>:</p>
<img alt="../_images/tutorials_6_1_3_img_2.jpg" src="../_images/tutorials_6_1_3_img_2.jpg" />
</section>
<section id="view-results">
<h3><a class="toc-backref" href="#id140">6.1.4. View Results</a><a class="headerlink" href="#view-results" title="Lien permanent vers ce titre">¶</a></h3>
<p>Navigate to the selected working directory. You should see 3 files created:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>risk1_run1_tut1a_passet.csv</em>: expected value of inundation per asset;</p></li>
<li><p><em>risk1_run1_tut1a_ttl.csv</em>: total results, expected value of total inundation per event (and for all events);</p></li>
<li><p><em>tut1a.run1 Impact-ARI plot on 6 events.svg</em>: a plot of the total results (see below).</p></li>
</ul>
</div></blockquote>
<img alt="../_images/tutorials_6_1_4_img_1.jpg" src="../_images/tutorials_6_1_4_img_1.jpg" />
<p>These are the non-spatial results which are directly generated by CanFlood’s model routines. To facilitate more detailed analysis and visualization, CanFlood comes with a third and final ‘Results’ toolset.</p>
<p><strong>Join Geometry</strong></p>
<p>Open the results toolset by <strong>clicking the ‘Results’</strong> <a class="reference internal" href="../_images/visual_image.jpg"><img alt="visualimage2" class="align-middle" src="../_images/visual_image.jpg" style="width: 26px;" /></a> <strong>button</strong>. The CanFlood models are designed to run independent of the QGIS spatial API. Therefore, if you would like to view the results spatially, additional actions are required to re-attach the tabular model results to the asset inventory (‘finv’) vector geometry. To do this, move to the ‘Join Geo’ tab, select the asset inventory (‘finv’) layer. Then select ‘r_passet’ under ‘results parameter to load’ to populate the field below with a filepath to your per-asset results file <a class="footnote-reference brackets" href="#id66" id="id18">11</a>. Finally, select the ‘Results Layer Style’ and ‘Field re-label option’ as shown:</p>
<img alt="../_images/tutorials_6_1_4_img_2.jpg" src="../_images/tutorials_6_1_4_img_2.jpg" />
<p><strong>Click ‘Join’</strong>. A new temporary ‘djoin’ layer should have been loaded onto the map canvas with the selected style applied. Move this layer to the top of your layers panel and turn off the original ‘finv’ layer to see the new ‘djoin’ layer. The ‘djoin’ layer should be a points layer where the size of each point is relative to the magnitude of the expected value of inundation (i.e. the average number of inundations per year) similar to this:</p>
<img alt="../_images/tutorials_6_1_4_img_3.jpg" src="../_images/tutorials_6_1_4_img_3.jpg" />
<p>Open the attributes table for the ‘djoin’ layer (F6). You should something similar to the below table:</p>
<img alt="../_images/tutorials_6_1_4_img_4.jpg" src="../_images/tutorials_6_1_4_img_4.jpg" />
<p>Notice the six impact fields (boxed in red above) have had their names converted to ‘ari_probability’ and the field values provide the binary exposure (0=not exposed; 1=exposed) results. You’ll need to save this layer for it to be available in another QGIS session (Layers Pane &gt; Right Click the layer &gt; Save As…). Congratulations on your first CanFlood run!</p>
</section>
</section>
<section id="tutorial-2a-risk-l2-with-simple-events">
<span id="section6-2"></span><h2><a class="toc-backref" href="#id141">6.2. Tutorial 2a: Risk (L2) with Simple Events</a><a class="headerlink" href="#tutorial-2a-risk-l2-with-simple-events" title="Lien permanent vers ce titre">¶</a></h2>
<p>Tutorial 2 demonstrates the use of CanFlood’s ‘Risk (L2)’model (<a class="reference internal" href="#section5-2-3">Section5.2.3</a>). This emulates a more detailed risk assessment where the vulnerability of each asset is known and described as a function of flood depth (rather than simple binary flood presence as in tutorial 1). This tutorial also demonstrates an inventory with ‘relative’ heights and CanFlood’s ‘composite vulnerability function’ feature where multiple functions are applied to the same asset.</p>
<section id="load-data-to-project">
<h3><a class="toc-backref" href="#id142">6.2.1. Load data to project</a><a class="headerlink" href="#load-data-to-project" title="Lien permanent vers ce titre">¶</a></h3>
<p>Download the tutorial 2 data from the ‘tutorials2data’ folder:</p>
<blockquote>
<div><ul>
<li><p><em>haz_rast</em>: hazard event rasters with WSL value predictions for the study area for four probabilities.</p>
<blockquote>
<div><p>o <em>haz_0050.tif</em></p>
<p>o <em>haz_0100.tif</em></p>
<p>o <em>haz_0200.tif</em></p>
<p>o <em>haz_1000.tif</em></p>
</div></blockquote>
</li>
<li><p><em>finv_tut2.gpkg</em>: flood asset inventory (’finv’) spatial layer</p></li>
<li><p><em>dtm_tut2.tif</em>: digital terrain model raster with ground elevation predictions</p></li>
<li><p><strike> <em>haz_frast</em>: companion failure event rasters </strike> (not used in tutorial 2a)</p></li>
<li><p><strike> <em>haz_fpoly</em>: companion failure event polygons </strike> (not used in tutorial 2a)</p></li>
</ul>
</div></blockquote>
<p>Load these into a QGIS project, it should look something like this:</p>
<img alt="../_images/tutorials_6_2_1_img_1.jpg" src="../_images/tutorials_6_2_1_img_1.jpg" />
</section>
<section id="id19">
<h3><a class="toc-backref" href="#id143">6.2.2. Build the Model</a><a class="headerlink" href="#id19" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Build’ <a class="reference internal" href="../_images/build_image.jpg"><img alt="buildimage" class="align-middle" src="../_images/build_image.jpg" style="width: 22px;" /></a> toolset.</p>
<p><strong>Scenario Setup</strong></p>
<p>On the ‘Setup’ tab, configure the session as shown using your own paths, then <strong>click ‘Start Control File’</strong>:</p>
<img alt="../_images/tutorials_6_2_2_img_1.jpg" src="../_images/tutorials_6_2_2_img_1.jpg" />
<p><strong>Select Vulnerability Function Set</strong></p>
<p>Move to the ‘Inventory’ tab and <strong>click ‘Select From Library’</strong> to launch the library selection GUI shown below. Select the library ‘IBI_2015’ in the top left window then ‘IBI2015_DamageCurves.xls’ in the bottom left window, then <strong>click ‘Copy Set’</strong> to copy this set of vulnerability functions into your working directory. The inventory provided in this tutorial has been constructed specifically for these ‘IBI2015’ functions. Generally, flood risk modellers must develop or supply their own vulnerability functions.</p>
<img alt="../_images/tutorials_6_2_2_img_2.jpg" src="../_images/tutorials_6_2_2_img_2.jpg" />
<p>Close the ‘vFunc Selection’ GUI, and you should now see the new .xls file path entered under ‘Vulnerability Functions’. Finally, <strong>click ‘Update Control File’</strong> to store a reference to this vulnerability function set into the control file.</p>
<p><strong>Inventory</strong></p>
<p>On the same ‘Inventory’ tab, select the inventory vector layer, the appropriate Index FieldName, and <strong>set the elevation type to ‘ground’</strong> as shown, then <strong>click ‘Store’</strong>.</p>
<img alt="../_images/tutorials_6_2_2_img_3.jpg" src="../_images/tutorials_6_2_2_img_3.jpg" />
<p>You should see the inventory csv now stored in the working directory.</p>
<p><strong>Hazard Sampler</strong></p>
<p>Move to the ‘Hazard Sampler’ tab, ensure the four hazard rasters are shown in the window and all other fields are default, then <strong>click ‘Sample Rasters’</strong>. You should see the ‘expos’ data file created in the working directory.</p>
<p><strong>Event Variables</strong></p>
<p>Move to the ‘Event Variables’ tab, you should now see the 4 hazard events from the previous task populating the table. Fill in the ‘Probability’ values as shown (ignore the ‘Failure Event Relation’ setting for now), then <strong>click ‘Store’</strong> to generate the event variables (‘evals’) dataset.</p>
<img alt="../_images/tutorials_6_2_2_img_4.jpg" src="../_images/tutorials_6_2_2_img_4.jpg" />
<p><strong>DTM Sampler</strong></p>
<p>Move to the ‘DTM Sampler’ tab. Select the ‘dtm_tut2’ raster then <strong>click ‘Sample DTM’</strong> to generate the ground elevation (‘gels’) dataset in your working directory and create a reference to it in the Control File.</p>
<p><strong>Validation</strong></p>
<p>Move to the ‘Validation’ tab, <strong>check the boxes for both L2 models</strong>, then <strong>click ‘Validate’</strong>. You should get a log message ‘passed 1 (of 2) validations. see log’. To investigate the failed validation attempt, open the Log Messages panel, it should look like this:</p>
<img alt="../_images/tutorials_6_2_2_img_5.jpg" src="../_images/tutorials_6_2_2_img_5.jpg" />
<p>This shows that the Risk (L2) model is missing the ‘dmgs’ data file and will not run. This is expected behavior as CanFlood separates the exposure calculation (Impacts L2) from the risk calculation. We will calculate this ‘dmgs’ data file and validate for Risk (L2) in the next section. You’re now ready to run the Impacts (L2) model!</p>
</section>
<section id="id20">
<h3><a class="toc-backref" href="#id144">6.2.3. Run the Model</a><a class="headerlink" href="#id20" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Model’ <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> dialog. Configure the ‘Setup’ tab as shown below, selecting your own paths and control file, and ensuring the ‘Outputs Directory’ is a sub-directory of your previous ‘Working Directory’ <a class="footnote-reference brackets" href="#id67" id="id21">12</a>:</p>
<img alt="../_images/tutorials_6_2_3_img_1.jpg" src="../_images/tutorials_6_2_3_img_1.jpg" />
<p><strong>Impact (L2)</strong></p>
<p>Move to the ‘Impacts (L2)’ tab. Ensure the ‘Run Risk (L2)’ box is <strong>not</strong> checked (we’ll execute the risk model manually in the next step) but that ‘Output expanded component impacts’ <strong>is</strong> checked. <strong>Click ‘Run dmg2’</strong>.</p>
<p>This should create an impacts (‘dmgs’) datafile in your working directory and fill in the corresponding entry on the control file. Open this csv. It should look something like this:</p>
<img alt="../_images/tutorials_6_2_3_img_2.jpg" src="../_images/tutorials_6_2_3_img_2.jpg" />
<p>These are the raw impacts per event per asset calculated with each vulnerability function, the sampled WSL and the sampled DTM elevation. The second output is the ‘expanded component impacts’, a large optional output background file used by CanFlood that contains the tabulation of each nested function and the applied scaling and cap values. See <a class="reference internal" href="#section5-2-2">Section5.2.2</a> for more information. Now you’re ready to calculate flood risk!</p>
<p><strong>Risk (L2)</strong></p>
<p>Move to the ‘Risk (L2)’ tab. Check all the boxes shown below and <strong>click ‘Run risk2’.</strong></p>
<img alt="../_images/tutorials_6_2_3_img_3.jpg" src="../_images/tutorials_6_2_3_img_3.jpg" />
<p>A set of results files should have been generated (discussed below). For a complete description of the Risk (L2) module, see <a class="reference internal" href="#section5-2-3">Section5.2.3</a>.</p>
</section>
<section id="id22">
<h3><a class="toc-backref" href="#id145">6.2.4. View Results</a><a class="headerlink" href="#id22" title="Lien permanent vers ce titre">¶</a></h3>
<p>After completing the Risk (L2) run, navigate to your working directory. It should now contain these files:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>eventypes_run1_tut2a.csv</em>: derived parameters for each raster;</p></li>
<li><p><em>risk2_run1_tut2a_r2_passet.csv</em>: expected value per asset expanded Risk (L2) results;</p></li>
<li><p><em>risk2_run1_tut2a_ttl.csv</em>: total expected value of all events and assets Risk (L2) results;</p></li>
<li><p><em>dmgs_tut2a_run1.csv</em>: per asset Impacts (L2) results;</p></li>
<li><p><em>dmgs_expnd_tut2a_run1.csv</em>: expanded component Impacts (L2) results;</p></li>
<li><p><em>run1 Impacts-ARI plot for 6 events.svg</em>: see below.</p></li>
</ul>
</div></blockquote>
<img alt="../_images/tutorials_6_2_4_img_1.jpg" src="../_images/tutorials_6_2_4_img_1.jpg" />
<p><em>Figure 6-1: Summary risk curve plot of the total Risk (L2) results.</em></p>
<p><strong>Risk Plots</strong></p>
<p>While the Risk modules include some basic risk curve plots (see above), CanFlood provides additional plot customization under the ‘Risk Plot’ tool in the ‘Results’ toolset. <strong>Open the ‘Results’</strong> <a class="reference internal" href="../_images/visual_image.jpg"><img alt="visualimage1" class="align-middle" src="../_images/visual_image.jpg" style="width: 28px;" /></a> <strong>toolset</strong>, configure the session by selecting a working directory, the Control File, and setting ‘Plot Handling’ to ‘Save to file’ as shown:</p>
<img alt="../_images/tutorials_6_2_4_img_2.jpg" src="../_images/tutorials_6_2_4_img_2.jpg" />
<p>To generate the custom plots, navigate to the ‘Risk Plot’ tab, and select both plot types as shown below:</p>
<img alt="../_images/tutorials_6_2_4_img_3.jpg" src="../_images/tutorials_6_2_4_img_3.jpg" />
<p>To customize the plot, open the Control File, and under ‘[plotting]’, change the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>color = red</p></li>
<li><p>impactfmt_str = ,.0f</p></li>
</ul>
</div></blockquote>
<p>These parameters control the colour of the plot and the formatting applied to the impact values. Save the changes, then return to the CanFlood window and <strong>hit ‘Plot Total’</strong>. You should see the two plots below generated in your working directory.</p>
<img alt="../_images/tutorials_6_2_4_img_4.jpg" src="../_images/tutorials_6_2_4_img_4.jpg" />
<img alt="../_images/tutorials_6_2_4_img_5.jpg" src="../_images/tutorials_6_2_4_img_5.jpg" />
<p>These plots are the two standard risk curve formats for the same total results data. Alternatively, changing ‘Plot Handling’ to ‘Launch separate window’ on the ‘Setup’ tab will launch a dialog window after plotting that provides some built-in tools for further customizing the plot.</p>
</section>
</section>
<section id="tutorial-2b-risk-l2-with-dike-failure">
<h2><a class="toc-backref" href="#id146">6.3. Tutorial 2b: Risk (L2) with Dike Failure</a><a class="headerlink" href="#tutorial-2b-risk-l2-with-dike-failure" title="Lien permanent vers ce titre">¶</a></h2>
<p>Users should first complete Tutorials 1 and 2a. Tutorial 2b uses the same input data as 2a but expands the analysis to demonstrate the risk analysis of a simple levee failure through incorporating a single companion failure event into the model. This companion failure event is composed of two layers:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>haz_1000_fail_B_tut2</em>: ‘failure raster’ indicating the WSL that would be realized were any of the levee segments to fail during the event; and</p></li>
<li><p><em>haz_1000_fail_B_tut2</em>: conditional exposure probability polygon layer with features indicating the extent and probability of failure of each levee segment during the flood event (‘failure polygons’). Notice this layer contains two features that overlap in places, corresponding potential flooding from two breach sites in the levee system. This layer will be used to tell CanFlood when and how to sample the failure raster.</p></li>
</ul>
</div></blockquote>
<p>This simplification by using these two layers facilitates the specification of multiple failure probabilities but where any failure (or combination of failures) would realize the same WSL (<a class="reference internal" href="#section5-1-5">Section5.1.5</a>’s ‘complex conditionals’). Ensure these layers are loaded into the same QGIS project as was used for Tutorial 2a.</p>
<p>To better understand the ‘failure polygons’ layer, let’s apply CanFlood’s ‘red fill transparent’ style. Begin by loading this style template into your profile with the ‘Add Styles’ tool (Plugins &gt; CanFlood &gt; Add Styles), then apply it using the Layer Styling Panel (F7). Finally, add a single label for ‘p_fail’ and move the layer just beneath the asset inventory (‘finv’) points layer on the layers panel. Your canvas should look similar to the below:</p>
<img alt="../_images/tutorials_6_3_img_1.jpg" src="../_images/tutorials_6_3_img_1.jpg" />
<section id="id23">
<h3><a class="toc-backref" href="#id147">6.3.1. Build the Model</a><a class="headerlink" href="#id23" title="Lien permanent vers ce titre">¶</a></h3>
<p>Follow the steps in Tutorials 2a ‘Build the Model’ but with including the ‘failure raster’ (‘haz_1000_fail_A_tut2’, probability=1000ARI) in the ‘Hazard Sampler’ and ‘Event Variables’ steps. On the ‘Event Variables’ step, ensure ‘Failure Event Relation Treatment’ is set to ‘Mutually Exclusive’.</p>
<p><strong>Conditional Probabilities</strong></p>
<p>Navigate to the ‘Conditional P’ tab to resolve the overlapping failure polygons into the resolved exposure probabilities (“exlikes”) dataset to tell CanFlood what probability should be assigned to each asset when realizing the companion failure raster. Start by pairing the failure polygons with the failure raster, select the ‘Probability FieldName’, ‘Event Relation Treatment’, and ‘Summary Plots’ as shown, then <strong>click ‘Sample’</strong>:</p>
<img alt="../_images/tutorials_6_3_1_img_1.jpg" src="../_images/tutorials_6_3_1_img_1.jpg" />
<p>A resolved exposure probabilities (‘exlikes’) data file should have been created in your working directory with entries like this:</p>
<img alt="../_images/tutorials_6_3_1_img_2.jpg" src="../_images/tutorials_6_3_1_img_2.jpg" />
<p>Two non-spatial summary plots of this data should also have been generated in your working directory, the most useful for this particular model being the histogram:</p>
<img alt="../_images/tutorials_6_3_1_img_3.jpg" src="../_images/tutorials_6_3_1_img_3.jpg" />
<p>These values are the conditional probabilities of each asset realizing the 1000-year companion failure event WSL. <a class="footnote-reference brackets" href="#id68" id="id24">13</a> See <a class="reference internal" href="#section5-2-3">Section5.2.3</a> for a complete description of this tool. Complete the model construction by running the ‘DTM Sampler’ and ‘Validation’ tools.</p>
</section>
<section id="id25">
<h3><a class="toc-backref" href="#id148">6.3.2. Run the Model</a><a class="headerlink" href="#id25" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Model’ dialog <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> and setup your session similar to Tutorial 2a but ensure ‘Generate attribution matrix’ is checked under ‘Run Controls’ (we’ll use this to make plots showing the different components that contribute to the risk totals).</p>
<p><strong>Impacts and Risk</strong></p>
<p>Navigate to the ‘Impacts (L2)’ tab, check the ‘Run Risk (L2) upon completion’ box to execute the exposure and risk models in sequence from your Control File. Navigate to the ‘Risk (L2)’ tab and ensure ‘Calculate expected values per asset’ is checked. Now move back to the ‘Impacts (L2)’ tab and <strong>click ‘Run dmg2’</strong>. You should see the same types of outputs as Tutorial 2a, but with two additional ‘attribution matrix’ datasets.</p>
</section>
<section id="section6-3-3">
<span id="id26"></span><h3><a class="toc-backref" href="#id149">6.3.3. View Results</a><a class="headerlink" href="#section6-3-3" title="Lien permanent vers ce titre">¶</a></h3>
<p>To better understand the influence of incorporating levee failure, this section will demonstrate how to generate a plot showing the total risk and the portion of that total risk that comes from assuming no failure. Open the ‘Results’ toolset and configure your session by selecting a working directory and the same Control File used above. Now navigate to the ‘Risk Plot’ tab, ensure both plot controls are checked, then <strong>click ‘Plot Fail Split’</strong>. This should generate two risk plot formulations, including the figure below:</p>
<img alt="../_images/tutorials_6_3_3_img_1.jpg" src="../_images/tutorials_6_3_3_img_1.jpg" />
<p>In this plot, the red line represents the contribution to risk without the companion failure events, which should be nearly identical to the results from Tutorial 2a, and a second line showing the total results. <a class="footnote-reference brackets" href="#id69" id="id27">14</a> The area between these two lines illustrates the contribution to risk from incorporating levee failure into the model.</p>
</section>
</section>
<section id="tutorial-2c-risk-l2-with-complex-failure">
<h2><a class="toc-backref" href="#id150">6.4. Tutorial 2c: Risk (L2) with Complex Failure</a><a class="headerlink" href="#tutorial-2c-risk-l2-with-complex-failure" title="Lien permanent vers ce titre">¶</a></h2>
<p>It is recommended that users first complete Tutorial 2b. Tutorial 2c uses the same input data as 2b but expands the analysis to demonstrate the incorporation of more complex levee failure with two companion failure events into the model.</p>
<p>In the same QGIS project as was used for Tutorial 2a, ensure the following are also added to the project:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>haz_1000_fail_B_tut2.gpkg</em>: failure polygon ‘B’;</p></li>
<li><p><em>haz_1000_fail_B_tut2.tif</em>: failure raster ‘B’.</p></li>
</ul>
</div></blockquote>
<p>These layers represent an additional companion failure event ‘B’ for the 1000-year event where the failure WSL and probabilities are different but complimentary from those of Tutorial 2b’s companion failure event ‘A’. These could be outputs from two modelled breach scenarios.</p>
<section id="id28">
<h3><a class="toc-backref" href="#id151">6.4.1. Build the Model</a><a class="headerlink" href="#id28" title="Lien permanent vers ce titre">¶</a></h3>
<p>Follow the steps in Tutorials 2b ‘Build the Model’ but with including the additional companion failure event ‘B’ in the ‘Hazard Sampler’, ‘Event Variables’ and ‘Conditional P’ steps. For the latter two, ensure both event relation treatments are set to ‘Mutually Exclusive’. Looking at the ‘Conditional P’ boxplot shows the difference in failure probabilities specified by the two companion failure events:</p>
<img alt="../_images/tutorials_6_4_1_img_1.jpg" src="../_images/tutorials_6_4_1_img_1.jpg" />
<p>Complete the model construction by running the ‘DTM Sampler’ and ‘Validation’ tools.</p>
</section>
<section id="id29">
<h3><a class="toc-backref" href="#id152">6.4.2. Run the Model</a><a class="headerlink" href="#id29" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Model’ dialog <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> and follow the steps in Tutorial 2b to setup this model run.</p>
<p><strong>Impacts and Risk</strong></p>
<p>Execute the ‘Impacts (L2)’ and ‘Risk (L2)’ models similar to Tutorial 2b but ensure ‘Generate attribution matrix’ is de-selected.</p>
<p>To explore the influence of the ‘event_rels’ parameter, open the control file, change the ‘event_rels’ parameter to ‘max’, change the ‘name’ parameter to something unique (e.g., ‘tut2c_max’), then save the file with a different name. On the ‘Setup’ tab, point to this modified control file, a new outputs directory, and run both models again as described above <a class="footnote-reference brackets" href="#id70" id="id30">15</a>.</p>
</section>
<section id="id31">
<h3><a class="toc-backref" href="#id153">6.4.3. View Results</a><a class="headerlink" href="#id31" title="Lien permanent vers ce titre">¶</a></h3>
<p>After executing the ‘Risk (L2)’ model for the ‘event_rels=mutEx’ and ‘event_rels=max’ control files, two similar collections of output files should have been generated in the two separate output directories specified during model setup. To visualize the difference between these two model configurations, <strong>open the ‘Results’ toolset</strong> and select a working directory and the original ‘event_rels=mutEx’ control file as the ‘main control file’ on the ‘Setup’ tab <a class="footnote-reference brackets" href="#id71" id="id32">16</a>. Before generating the comparison files, configure the plot style by opening the same main control file, and changing the following ‘[plotting]’ parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘color = red’</p></li>
<li><p>‘linestyle = solid’</p></li>
<li><p>‘impactfmt_str = ,.0f’</p></li>
</ul>
</div></blockquote>
<p>To generate a comparison plot of these two scenarios, navigate to the ‘Compare/Combine’ tab, select the ‘Control File’ for both model configurations generated in the previous step, ensure ‘Control Files’ is checked under ‘Comparison Controls’, as shown below:</p>
<img alt="../_images/tutorials_6_4_3_img_1.jpg" src="../_images/tutorials_6_4_3_img_1.jpg" />
<p>Click ‘Compare’ to perform the comparison. You should see two files generated in your working directory:</p>
<blockquote>
<div><ul class="simple">
<li><p>Comparison plot showing both risk curves on the same axis; and</p></li>
<li><p>Control file comparison spreadsheet.</p></li>
</ul>
</div></blockquote>
<p>The control file comparison spreadsheet is shown below and is an easy way to quickly identify distinctions between model scenarios.</p>
<img alt="../_images/tutorials_6_4_3_img_2.jpg" src="../_images/tutorials_6_4_3_img_2.jpg" />
<p>On the comparison plot (shown below), notice the difference in the risk curves and annualized values is negligible, indicating the treatment of event relations is not very significant for this model.</p>
<img alt="../_images/tutorials_6_4_3_img_3.jpg" src="../_images/tutorials_6_4_3_img_3.jpg" />
<p>Re-running the comparison tool on the four Tutorial 2 control files constructed thus far yields the following:</p>
<img alt="../_images/tutorials_6_4_3_img_4.jpg" src="../_images/tutorials_6_4_3_img_4.jpg" />
</section>
</section>
<section id="tutorial-2d-risk-l2-with-mitigation">
<h2><a class="toc-backref" href="#id154">6.5. Tutorial 2d: Risk (L2) with Mitigation</a><a class="headerlink" href="#tutorial-2d-risk-l2-with-mitigation" title="Lien permanent vers ce titre">¶</a></h2>
<p>It is recommended that users first complete Tutorial 2a before proceeding. Tutorial 2d uses the same input data as 2a but expands the analysis to demonstrate the incorporation of object (or property) level mitigation measures (PLPM) into the model. This can be useful for improving the accuracy of a model where two assets are functionally similar, using the same vulnerability function, but where one has some mechanism to reduce the exposure of the asset (e.g., a backflow valve). Similarly, this functionality can be used to investigate the benefits of introducing PLPMs with a comparative analysis.</p>
<section id="id33">
<h3><a class="toc-backref" href="#id155">6.5.1. Build the Model</a><a class="headerlink" href="#id33" title="Lien permanent vers ce titre">¶</a></h3>
<p>Follow the steps in Tutorials 2a ‘Build the Model’, with the exception of the ‘Inventory’ step, which we’ll modify to apply four new fields to the inventory vector layer (‘finv’) by configuring the ‘Inventory’ tab as shown below before <strong>clicking ‘Construct finv’</strong>:</p>
<img alt="../_images/tutorials_6_5_1_img_1.jpg" src="../_images/tutorials_6_5_1_img_1.jpg" />
<p>This should create a new layer with a ‘finv’ prefix in your map canvas. Exploring the attribute table of this layer (F6) should show the four new fields that were created and filled with the values specified. These are used by the ‘Impacts (L2)’ module to modify the exposure passed to each objects vulnerability function and are described in <a class="reference internal" href="#section5-2-2">Section5.2.2</a>. Complete the inventory construction by ensuring ‘Apply Mitigations’ is checked, the newly created inventory vector layer is selected, and the remainder of the tab is configured as shown below (same as Tutorial 2a). <strong>Click ‘Store’.</strong></p>
<img alt="../_images/tutorials_6_5_1_img_2.jpg" src="../_images/tutorials_6_5_1_img_2.jpg" />
<p>Complete the ‘Hazard Sampler’, ‘Event Variables’, ‘DTM Sampler’, and ‘Validation’ steps as described in Tutorial 2a.</p>
</section>
<section id="id34">
<h3><a class="toc-backref" href="#id156">6.5.2. Run the Model</a><a class="headerlink" href="#id34" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Model’ dialog <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> and setup your session similar to Tutorial 2a.</p>
<p><strong>Impacts and Risk</strong></p>
<p>Navigate to the ‘Impacts (L2)’ tab and ensure ALL ‘Run Controls’ are checked then <strong>click ‘Run dmg2’</strong>. You should see the same types of outputs as Tutorial 2a, but with some additional outputs that will help us understand the influence of the mitigation parameters, including the box plot shown below:</p>
<img alt="../_images/tutorials_6_5_2_img_1.jpg" src="../_images/tutorials_6_5_2_img_1.jpg" />
<p>This shows data summaries for the four event rasters, the total impact values (in red text), and some key model info.</p>
<p>To understand the effect of the mitigation parameters, open the control file, change the ‘apply_miti’ parameter to ‘False’, change the ‘name’ parameter to ‘tut2d_noMiti’, ‘color’ to ‘red’, and save it under a different name. On the ‘Setup’ tab, point to this new control file and change the ‘Run Tag’ to ‘noMiti’. Now move back to the ‘Impacts (L2)’ tab and <strong>click ‘Run dmg2’ again.</strong> You should see another boxplot generated in your working directory:</p>
<img alt="../_images/tutorials_6_5_2_img_2.jpg" src="../_images/tutorials_6_5_2_img_2.jpg" />
<p>Notice the smaller events (50yr and 100yr) have changed significantly, while the larger events less-so. This makes sense considering we told CanFlood the mitigations would be overwhelmed at depths above 0.2 m (via the upper depth threshold parameter). We can investigate this model behavior further by opening either <a class="footnote-reference brackets" href="#id72" id="id35">17</a> of the ‘depths_’ outputs, which should look similar to the below (values below the upper threshold are highlighted in red for clarity):</p>
<img alt="../_images/tutorials_6_5_2_img_3.jpg" src="../_images/tutorials_6_5_2_img_3.jpg" />
<p>Similarly, the ‘dmg2_smry’ spreadsheet ‘_smry’ tab for the mitigation run shows the change in total impact values (per event) calculated at each step of the ‘Impacts (L2)’ module (bars and arrow added for clarity):</p>
<img alt="../_images/tutorials_6_5_2_img_4.jpg" src="../_images/tutorials_6_5_2_img_4.jpg" />
<p>This shows the total impacts achieved by the raw curves, then the ‘scaling’ algorithm (‘fX_scale’) the ‘capping’ algorithm (‘fX_cap’), followed by the algorithm that enforced the lower threshold (‘mi_Lthresh’), the mitigation scaling (‘mi_iScale’), the mitigation value addition (‘mi_iVal’), and the final result (identical to the previous row). This progression shows that the ‘capping’ algorithm had a large influence on the results and the mitigation value addition (‘mi_iVal’) had negligible influence.</p>
</section>
<section id="view-the-results">
<h3><a class="toc-backref" href="#id157">6.5.3. View the Results</a><a class="headerlink" href="#view-the-results" title="Lien permanent vers ce titre">¶</a></h3>
<p>The ‘Compare’ Results tool can be used to show the influence on the risk curve and total risk:</p>
<img alt="../_images/tutorials_6_5_3_img_1.jpg" src="../_images/tutorials_6_5_3_img_1.jpg" />
</section>
</section>
<section id="tutorial-2e-benefit-cost-analysis">
<h2><a class="toc-backref" href="#id158">6.6. Tutorial 2e: Benefit-Cost Analysis</a><a class="headerlink" href="#tutorial-2e-benefit-cost-analysis" title="Lien permanent vers ce titre">¶</a></h2>
<p>This tutorial demonstrates CanFlood’s Benefit-Cost Analysis (BCA) tools for supporting basic benefit-cost analysis for flood risk interventions like the mitigations considered in the previous tutorial. Before continuing with this tutorial, users should have completed and have available the results data for Tutorial 2a <a class="footnote-reference brackets" href="#id73" id="id36">18</a> and 2d:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>CanFlood_tut2a.txt</em>: control file from Tutorial 2a with valid total results (‘r_ttl’) file and filepath;</p></li>
<li><p><em>CanFlood_tut2d.txt</em>: control file from Tutorial 2d with valid total results (‘r_ttl’) file filepath.</p></li>
</ul>
</div></blockquote>
<p>Begin by opening the ‘Results’ toolbox then navigating to the ‘Setup’ tab to configure it using the control file from Tutorial 2d. Now we’ll generate a test plot to make sure our control files are valid. Ensure the ‘impactfmt_str’ parameter is set to ‘,.0f’ (no apostrophes) in the Tutorial 2d control file. Now move to the ‘Compare/Combine’ tab, enter in both control files, check one of the ‘Plot Controls’, then click ‘Compare’. A plot identical to the one generated at the end of Tutorial 2d should have been generated. Note the EAD of Tutorial 2d is ~57,000. This is the residual annual flood risk for these assets, after the PLPM intervention.</p>
<p><strong>Complete BCA Workbook</strong></p>
<p>Navigate to the ‘BCA’ tab. Ensure the control file path for Tutorial 2d is shown at the top of the window, then click ‘Copy BCA Template’. You should see a new ‘cba_xls’ parameter set in the control file and your ‘BCA’ window should look similar to the below:</p>
<img alt="../_images/tutorials_6_6_img_1.jpg" src="../_images/tutorials_6_6_img_1.jpg" />
<p>Now click ‘Open’ to edit the BCA workbook. You should see the ‘smry’ tab populated with information from Tutorial 2d, most notably the $57k EAD calculated for this option. Complete the remaining input cells on the ‘smry’ tab by specifying the EAD from 2a and a 4% discounting rate as shown below:</p>
<img alt="../_images/tutorials_6_6_img_2.jpg" src="../_images/tutorials_6_6_img_2.jpg" />
<p>Now move to the ‘data’ tab on the workbook to enter in the benefit-cost data of pursuing the Tutorial 2d mitigations. For this tutorial, assume we have determined the following for this intervention:</p>
<blockquote>
<div><ul class="simple">
<li><p>Installation of the PLPMs will take 2 years at $1M/year and provide protection for 100 years;</p></li>
<li><p>Maintenance will cost $1k/year beginning once construction completes and continue for the 100-year lifecycle of the intervention;</p></li>
<li><p>There will be no change in relative benefits or maintenance costs over time.</p></li>
</ul>
</div></blockquote>
<p>The two EAD rows on the ‘data’ tab should be automatically populated based on the values specified on the ‘smry’ tab; however, to match the assumptions above we must adjust some of these values as shown in the first six-years of the ‘data’ tab:</p>
<img alt="../_images/tutorials_6_6_img_3.jpg" src="../_images/tutorials_6_6_img_3.jpg" />
<p>Notice the first year of the ‘baseline’ and ‘option’ EAD are blank, reflecting that no benefits are gained yet; however, the second year shows half the benefits will be realized. The $1000/year maintenance costs should extend through the full 100 years (i.e., copy/paste onto all rightward cells — not shown).</p>
<p>Once the ‘data’ tab is complete, a ‘B/C ratio’ of 1.18 should be shown on the ‘smry’ tab <a class="footnote-reference brackets" href="#id74" id="id37">19</a>. Save and close this spreadsheet.</p>
<p><strong>Plot Financials</strong></p>
<p>To further summarize and analyze the data entered into the BCA worksheet (make sure to hit save!), move back to the CanFlood ‘BCA’ window, select ‘Future Values’, and click ‘Plot Financials’. The plot shown below should be generated:</p>
<img alt="../_images/tutorials_6_6_img_4.jpg" src="../_images/tutorials_6_6_img_4.jpg" />
<p>This shows the relative values of the cumulative benefits and costs over time (without discounting). Notice the expensive installation costs exceed the benefits initially; however, after ~25 years the benefits of this option outweigh the costs (the ‘pay-back year’). Also notice that, with future values, the plot shows cumulative benefits around $10M at 100 years. Perhaps by then we will all be living in spaceships… so maybe it’s best not to consider such far-off benefits of flood mitigation so significantly.</p>
<p>Change the radio button to ‘Present Values’ and click ‘Plot Financials’ again. You should see a plot like the below:</p>
<img alt="../_images/tutorials_6_6_img_5.jpg" src="../_images/tutorials_6_6_img_5.jpg" />
<p>Notice the ‘B/C ratio’ and the ‘pay-back year’ have not changed, but the plot now shows the costs and benefits decaying with time, reflecting the application of the discount rate.</p>
<p>To better understand the role of the discount rate, return to the worksheet, change the discount rate to 8%, save the worksheet, and in the CanFlood window click ‘Plot Financials’ again:</p>
<img alt="../_images/tutorials_6_6_img_6.jpg" src="../_images/tutorials_6_6_img_6.jpg" />
<p>Notice the ‘payback year’ has not changed, but the relative size of the positive (green) and negative (red) areas has shifted and the ‘B/C ratio’ has dropped below 1. This reflects the more severe discounting of the future benefits brought by the larger 8% discount rate. In other words, by the time the future residents of the study area accrue significant benefits from the PLPMs, the current stakeholders wish they had spent the money on something else.</p>
</section>
<section id="tutorial-3-risk-l3-sofda-research-model">
<h2><a class="toc-backref" href="#id159">6.7. Tutorial 3: Risk (L3) SOFDA research model</a><a class="headerlink" href="#tutorial-3-risk-l3-sofda-research-model" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sample inputs for the SOFDA research model are provided in the tutorials3folder. Refer to <a class="reference internal" href="#appendix-b">Appendix B</a> for more information.</p>
</section>
<section id="tutorial-4a-risk-l1-with-percent-inundation-polygons">
<h2><a class="toc-backref" href="#id160">6.8. Tutorial 4a: Risk (L1) with Percent Inundation (Polygons)</a><a class="headerlink" href="#tutorial-4a-risk-l1-with-percent-inundation-polygons" title="Lien permanent vers ce titre">¶</a></h2>
<p>This tutorial demonstrates a risk analysis of polygon type assets where the impact metric is percent inundated rather than depth. This can be useful for some coarse risk modelling, or for assets like agricultural fields where the loss can reasonably be calculated from the percent of the asset that is inundated.</p>
<p>Load the following data layers from the ‘tutorials4data’ folder:</p>
<blockquote>
<div><ul>
<li><p><em>haz_rast</em>: hazard event rasters with WSL value predictions for the study area for four probabilities.</p>
<blockquote>
<div><p>o <em>haz_0050_tut4.tif</em></p>
<p>o <em>haz_0100_tut4.tif</em></p>
<p>o <em>haz_0200_tut4.tif</em></p>
<p>o <em>haz_1000_tut4.tif</em></p>
</div></blockquote>
</li>
<li><p><em>dtm_cT2.tif</em>: DTM layer (and corresponding stylized layer definition .qlr file)</p></li>
<li><p><em>finv_tut4a_polygons.gpkg</em>: flood asset inventory (’finv’) spatial layer</p></li>
<li><p><strike> <em>finv_tut4b_lines.gpkg</em>: </strike> (used in tutorial 4b)</p></li>
</ul>
</div></blockquote>
<p>Move the polygon inventory (‘finv’) layer to the top, apply the CanFlood ‘fill transparent blue’ style <a class="footnote-reference brackets" href="#id75" id="id38">20</a>, and your project should look similar to this <a class="footnote-reference brackets" href="#id76" id="id39">21</a>:</p>
<img alt="../_images/tutorials_6_8_img_1.jpg" src="../_images/tutorials_6_8_img_1.jpg" />
<section id="id40">
<h3><a class="toc-backref" href="#id161">6.8.1. Build the Model</a><a class="headerlink" href="#id40" title="Lien permanent vers ce titre">¶</a></h3>
<p><strong>Setup</strong></p>
<p>Launch the CanFlood ‘Build’ toolset and navigate to the ‘Setup’ tab. Set the ‘Precision’ field <a class="footnote-reference brackets" href="#id77" id="id41">22</a> to ‘6’, then complete the typical setup as instructed in Tutorial 1a.</p>
<p><strong>Inventory</strong></p>
<p>Navigate to the ‘Inventory’ tab, ensure ‘Elevation type’ is set to ‘datum’ <a class="footnote-reference brackets" href="#id78" id="id42">23</a> then <strong>click ‘Store’.</strong></p>
<p><strong>Hazard Sampler</strong></p>
<p>Navigate to the ‘Hazard Sampler’ tool, load the four hazard rasters into the dialog window, check ‘Box plots’, check ‘Exposure as Inundation%’, set the ‘Depth Threshold’ to 0.5, and select the DTM layer as shown:</p>
<img alt="../_images/tutorials_6_8_1_img_1.jpg" src="../_images/tutorials_6_8_1_img_1.jpg" />
<p><strong>Click ‘Sample Rasters’</strong>. Navigate to the exposure data file (‘expos’) this created in your working directory. You should see a table like this:</p>
<img alt="../_images/tutorials_6_8_1_img_2.jpg" src="../_images/tutorials_6_8_1_img_2.jpg" />
<p>These values are the calculated percent of each polygon with inundation greater than the specified depth threshold (0.5m). The generated box plots show this data graphically:</p>
<img alt="../_images/tutorials_6_8_1_img_3.jpg" src="../_images/tutorials_6_8_1_img_3.jpg" />
<p><strong>Event Variables and Validation</strong></p>
<p>Run the ‘Event Variables’ and ‘Validation’ tools as instructed in Tutorial 1a.</p>
</section>
<section id="id43">
<h3><a class="toc-backref" href="#id162">6.8.2. Run the Model</a><a class="headerlink" href="#id43" title="Lien permanent vers ce titre">¶</a></h3>
<p>Open the ‘Model’ dialog <a class="reference internal" href="../_images/run_image.jpg"><img alt="runimage" class="align-middle" src="../_images/run_image.jpg" style="width: 22px;" /></a> and follow the steps in Tutorial 1a to setup this model run. Navigate to the ‘Risk (L1)’ tool, check the boxes shown, and click ‘Run risk1’:</p>
<img alt="../_images/tutorials_6_8_2_img_1.jpg" src="../_images/tutorials_6_8_2_img_1.jpg" />
<p>The set of results files discussed below should have been generated.</p>
</section>
<section id="id44">
<h3><a class="toc-backref" href="#id163">6.8.3. View the Results</a><a class="headerlink" href="#id44" title="Lien permanent vers ce titre">¶</a></h3>
<p>Navigate to your working directory. You should see the following results files have been generated:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>risk1_run1_tut4_passet.csv</em>: per asset results</p></li>
<li><p><em>risk1_run1_tut4_ttl.csv</em></p></li>
<li><p><em>tut4a run1 AEP-Impacts plot for 6 events.svg</em></p></li>
<li><p><em>tut4a run1 Impacts-ARI plot for 6 events.svg</em></p></li>
</ul>
</div></blockquote>
<p>Open the per-asset results (‘passet’) data file, it should look like this:</p>
<img alt="../_images/tutorials_6_8_3_img_1.jpg" src="../_images/tutorials_6_8_3_img_1.jpg" />
<p>The first non-index columns are simply the inundation percentage (from the ‘expos’ data file) multiplied by the asset scale attribute (from the ‘finv’ data file). The final ‘ead’ column is the expected value of these four columns.</p>
<p>To visualize this, open the ‘Results’ toolbox and configure the ‘Setup’ tab by selecting the control file. Navigate to the ‘Join Geo’ tab and configure it as shown below:</p>
<img alt="../_images/tutorials_6_8_3_img_2.jpg" src="../_images/tutorials_6_8_3_img_2.jpg" />
<p>Click <strong>‘Join’</strong>. You should see a new polygon vector layer loaded in your canvas with a red graduated style and labels applied to the EAD results calculated in the previous step:</p>
<img alt="../_images/tutorials_6_8_3_img_3.jpg" src="../_images/tutorials_6_8_3_img_3.jpg" />
</section>
</section>
<section id="tutorial-4b-risk-l1-with-percent-inundation-lines">
<h2><a class="toc-backref" href="#id164">6.9. Tutorial 4b: Risk (L1) with Percent Inundation (Lines)</a><a class="headerlink" href="#tutorial-4b-risk-l1-with-percent-inundation-lines" title="Lien permanent vers ce titre">¶</a></h2>
<p>Like Tutorial 4a, this tutorial demonstrates a risk analysis where the impact metric is percent inundated, but with line geometries rather than polygons. This can be useful for the analysis of flood risk to linear assets like roads.</p>
<p>Load the same data layers from the ‘tutorials4data’ folder, with the addition of:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>finv_tut4b_lines.gpkg</em></p></li>
</ul>
</div></blockquote>
<p>Follow all the steps described in Tutorial 4a, but with this new asset inventory (‘finv’) layer.</p>
<p>The per-asset results should look like this:</p>
<img alt="../_images/tutorials_6_9_img_1.jpg" src="../_images/tutorials_6_9_img_1.jpg" />
<p>The first non-index ‘impact’ columns represent hazard events, with values showing the percent inundation of each segment multiplied by its ‘f0_scale’ value. This could represent the meters inundated (above the 0.5m depth threshold) per segment, if the ‘f0_scale’ value is the segment length (as is the case with the tutorial inventory). Alternatively, the ‘f0_scale’ value could be set to ‘1.0’ for all features which would cause the values to simply reflect the % inundation of each segment (mirrors the output of the Hazard Sampler tool) and the last column would calculate the expected percent annual inundation of the segment.</p>
</section>
<section id="tutorial-5a-risk-l1-from-npri-and-gar15">
<h2><a class="toc-backref" href="#id165">6.10. Tutorial 5a: Risk (L1) from NPRI and GAR15</a><a class="headerlink" href="#tutorial-5a-risk-l1-from-npri-and-gar15" title="Lien permanent vers ce titre">¶</a></h2>
<p>This tutorial demonstrates how to construct a CanFlood ‘Risk (L1)’ model from two web-sources:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <a class="reference external" href="https://www.canada.ca/en/services/environment/pollution-waste-management/national-pollutant-release-inventory.html">National Pollutant Release Inventory (NPRI)</a>; and</p></li>
<li><p><a class="reference external" href="https://preview.grid.unep.ch/index.php?preview=home&amp;lang=eng">The GAR15 Atlas global flood hazard assessment</a> <a class="footnote-reference brackets" href="#id79" id="id45">24</a></p></li>
</ul>
</div></blockquote>
<p>For more information on these data sets, see <a class="reference internal" href="#appendix-a">Appendix A</a>.</p>
<p>Because this tutorial deals with data having disparate CRSs, users should be familiar with QGIS’s native handling of project and layer CRS discussed <a class="reference external" href="https://docs.qgis.org/3.10/en/docs/user_manual/working_with_projections/working_with_projections.html">here</a>.</p>
<section id="id46">
<h3><a class="toc-backref" href="#id166">6.10.1. Load Data to Project</a><a class="headerlink" href="#id46" title="Lien permanent vers ce titre">¶</a></h3>
<p>Begin by setting your QGIS project’s CRS to ‘EPSG:3978’ (Project &gt; Properties &gt; CRS &gt; select ‘EPSG:3978’) <a class="footnote-reference brackets" href="#id80" id="id47">25</a>. Now you are ready to download, then add, the data layer for Tutorial 5:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>tut5_aoi_3978.gpkg</em>: AOI polygon for tutorial.</p></li>
</ul>
</div></blockquote>
<p>Set the AOI’s layer style to ‘fill red transparent’ to allow you to see through the polygon. Before inventory construction can begin, we must add the NPRI and GAR15 raw data to the QGIS project. While there are many options for accessing and importing such data, this tutorial will demonstrate how to use CanFlood’s built-in ‘Add Connections’ <a class="reference internal" href="../_images/add_connections_image.jpg"><img alt="addConnectionsImage" class="align-middle" src="../_images/add_connections_image.jpg" style="width: 22px;" /></a> feature (<a class="reference internal" href="#section5-4-1">Section5.4.1</a>) to first add a connection to the profile, then download the desired layers.</p>
<p><strong>Connect to Web-Data</strong></p>
<p>Begin by expanding the QGIS ‘Browser Panel’ (Ctrl + 2) then clicking ‘Refresh’ on the panel. It should similar to this:</p>
<img alt="../_images/tutorials_6_10_1_img_1.jpg" src="../_images/tutorials_6_10_1_img_1.jpg" />
<p>This shows all the connections in your QGIS profile.</p>
<p>Next, execute ‘Add Connections’ <a class="reference internal" href="../_images/add_connections_image.jpg"><img alt="addConnectionsImage" class="align-middle" src="../_images/add_connections_image.jpg" style="width: 22px;" /></a> (Plugins &gt; CanFlood) to run a script that will attempt to add a set of additional connections to your profile. Your Log Messages should look like this:</p>
<img alt="../_images/tutorials_6_10_1_img_2.jpg" src="../_images/tutorials_6_10_1_img_2.jpg" />
<p>This describes each of the connections that CanFlood added to your profile. To verify this, navigate back to the ‘Browser Panel’. You should see the following connections (under each connection type):</p>
<blockquote>
<div><ul class="simple">
<li><p>UNISDR_GAR15_GlobalRiskAssessment (WCS)</p></li>
<li><p>ECCC_NationalPollutantReleaseInventory_NPRI (ArcGIS Feature Service)</p></li>
</ul>
</div></blockquote>
<p>Note that these connections will remain in your profile for future QGIS sessions, meaning the ‘Add Connections’ <a class="reference internal" href="../_images/add_connections_image.jpg"><img alt="addConnectionsImage" class="align-middle" src="../_images/add_connections_image.jpg" style="width: 22px;" /></a> tool should only be required once per profile <a class="footnote-reference brackets" href="#id81" id="id48">26</a>.</p>
<p><strong>Download NPRI Data</strong></p>
<p>Now that the connections have been added to your profile, you are ready to download the layers. To limit the data request, ensure your map canvas roughly matches the extents of the AOI <a class="footnote-reference brackets" href="#id82" id="id49">27</a>. Now open the QGIS ‘Data Source Manager’ (Ctrl + L) and select ‘ArcGIS Feature Server’. Select ‘ECCC_NationalPollutantReleaseInventory_NPRI’ from the dropdown under ‘Server Connections’. <strong>Click ‘Connect’</strong> to display the layers available on the server. Select layer 3 ‘Reported releases to surface water for 2019’, check ‘Only request features…’, then <strong>click ‘Add’</strong> to add the layer to the project as shown in the following:</p>
<img alt="../_images/tutorials_6_10_1_img_3.jpg" src="../_images/tutorials_6_10_1_img_3.jpg" />
<p>You should now see a vector points layer added to your project with information on each facility reported to the NPRI (within your canvas view). Take note this layer’s CRS is EPSG:3978 (right click the layer in the ‘Layers’ panel &gt; Properties &gt; Information &gt; CRS), this should match your QGIS project and the AOI.</p>
<p><strong>Download GAR15 Data</strong></p>
<p>Follow a similar process to download <a class="footnote-reference brackets" href="#id83" id="id50">28</a> the following layers from ‘UNISDR_GAR15_GlobalRiskAssessment’ under the ‘WCS’ tab as shown below:</p>
<blockquote>
<div><ul class="simple">
<li><p>GAR2015:flood_hazard_200_yrp</p></li>
<li><p>GAR2015:flood_hazard_100_yrp</p></li>
<li><p>GAR2015:flood_hazard_25_yrp</p></li>
<li><p>GAR2015:flood_hazard_500_yrp</p></li>
<li><p>GAR2015:flood_hazard_1000_yrp</p></li>
</ul>
</div></blockquote>
<img alt="../_images/tutorials_6_10_1_img_4.jpg" src="../_images/tutorials_6_10_1_img_4.jpg" />
<p>You’ll have to load one layer at a time, and you may be prompted to ‘Select Transformation’ <a class="footnote-reference brackets" href="#id84" id="id51">29</a>. Once finished, your canvas should look like this:</p>
<img alt="../_images/tutorials_6_10_1_img_5.jpg" src="../_images/tutorials_6_10_1_img_5.jpg" />
</section>
<section id="id52">
<h3><a class="toc-backref" href="#id167">6.10.2. Build the Model</a><a class="headerlink" href="#id52" title="Lien permanent vers ce titre">¶</a></h3>
<p>This section describes how to complete the construction of a Risk (L1) model from the downloaded NPRI and GAR15 data. For instructions on the remainder of the Risk (L1) modelling process, see <a class="reference internal" href="#section6-1">Section6.1</a>.</p>
<p><strong>Setup</strong></p>
<p>Follow the instructions in <a class="reference internal" href="#section6-1-2">Section6.1.2</a> <em>Setup</em>; however, ensure ‘tut5_aoi_3978’ is selected under ‘Project AOI’ and ‘Load session results…’ is selected.</p>
<img alt="../_images/tutorials_6_10_2_img_1.jpg" src="../_images/tutorials_6_10_2_img_1.jpg" />
<p><strong>Construct and Store Inventory</strong></p>
<p>Navigate to the ‘Inventory’ tab. To convert the downloaded NPRI data into an L1 inventory layer that CanFlood will recognize, we need to add ‘elv’ and ‘scale’ fields and values. For this simple analysis, we assume each asset has a vulnerability height of zero (i.e., any positive flood depth leads to exposure). This assumption is accomplished in CanFlood by setting ‘felv’= ‘datum’ and setting each ‘f0_elv’=0 (and using depth rather than WSL rasters). Using the Vector Layer drop down, select the NPRI layer and ensure the ‘nestID’, ‘scale’, and ‘elv’ fields match what is shown below. Finally, <strong>click ‘Construct finv’</strong> to build the new inventory layer. To generate the asset inventory (‘finv’) csv file, ensure this new layer is selected in the ‘Inventory Vector Layer’ drop down. Now configure the ‘felv’ and ‘cid’ parameters as shown below, then <strong>click ‘Store’:</strong></p>
<img alt="../_images/tutorials_6_10_2_img_2.jpg" src="../_images/tutorials_6_10_2_img_2.jpg" />
<p><strong>Hazard Sampler</strong></p>
<p>Now you’re ready to sample the GAR15 hazard layers with your new NPRI inventory. Unlike the hazard layers used in previous tutorials, the GAR15 hazard layers provide <em>depth</em> (rather than WSL) data in <em>centimeters</em> (rather than meters) in a coordinate system other than that of our project. Further, these hazard layers’ extents are much larger than what is needed by our project; and because they are web-layers, many of the QGIS processing tools will not work. Therefore, we’ll need to apply the four ‘Raster Preparation’ tools described in Table 5-2 before proceeding with the ‘Hazard Sampler’.</p>
<p>Navigate to the ‘Hazard Sampler’ tab, ensure the five GAR2015 layers are listed in the window, and click ‘Sample’. You should get an error telling you the layer CRS does not match that of the project. To resolve this, configure the Raster Preparation handles as shown and <strong>click ‘Prep’</strong>:</p>
<img alt="../_images/tutorials_6_10_2_img_3.jpg" src="../_images/tutorials_6_10_2_img_3.jpg" />
<p>You should see five new rasters loaded to your canvas (with a ‘prepd’ suffix). These layers should have rotated pixels, be clipped to the AOI, have reasonable flood depth values (in meters), and have the same CRS as the project <a class="footnote-reference brackets" href="#id85" id="id53">30</a>. Further, each of these rasters should be saved to your working directory. This new set of hazard layers should conform to the expectations of the Hazard Sampler, allowing you to proceed with construction of an L1 model as described in <a class="reference internal" href="#section6-1">Section6.1</a>.</p>
</section>
</section>
<section id="tutorial-6a-dike-failure-polygons">
<span id="section6-11"></span><h2><a class="toc-backref" href="#id168">6.11. Tutorial 6a: Dike Failure Polygons</a><a class="headerlink" href="#tutorial-6a-dike-failure-polygons" title="Lien permanent vers ce titre">¶</a></h2>
<p>This tutorial demonstrates how to generate ‘failure polygons’ from typical dike information using CanFlood’s ‘Dike Fragility Mapper’ tool (<a class="reference internal" href="#section5-4-1">Section5.4.1</a>). Before following this tutorial, users should be familiar with the hazard event data types described in <a class="reference internal" href="#section4-2">Section4.2</a> (esp. ‘failure polygons’) that are required of Risk (L1) and (L2) models with some failure. Begin by downloading the tutorial data from the <a class="reference external" href="https://github.com/IBIGroupCanWest/CanFlood/tree/master/tutorials/6">tutorials6</a> folder and loading it into a new QGIS project:</p>
<blockquote>
<div><ul>
<li><p>hazard WSL event rasters (without failure)</p>
<blockquote>
<div><p>o <em>0010_noFail.tif</em></p>
<p>o <em>0050_noFail.tif</em></p>
<p>o <em>0200_noFail.tif</em></p>
<p>o <em>1000_noFail.tif</em></p>
</div></blockquote>
</li>
<li><p><em>dike_influence_zones.gpkg</em>: Dike segment influence area layer with two polygon features, each corresponding to the area of influence of some dike segments;</p></li>
<li><p><em>dikes.gpkg</em>: Dike alignment polyline layer</p></li>
<li><p><em>dtm.tif</em>: Digital Terrain Model (import ‘dtm.qlr’ to get the styled version);</p></li>
<li><p><em>dike_fragility_20210201.xls</em>: Dike fragility function library.</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#section4-5">Section4.5</a> for a description of these datasets. Ensure your project CRS is set to ‘EPSG:3005’. Once the GIS layers are loaded, your map canvas should look similar to the below:</p>
<img alt="../_images/tutorials_6_11_img_1.jpg" src="../_images/tutorials_6_11_img_1.jpg" />
<p>To make this workspace more friendly, ensure the ‘dikes’ and ‘dike_influence_zones’ layers are at the top of the layers panel. Now apply the following CanFlood styles <a class="footnote-reference brackets" href="#id86" id="id54">31</a> to each of these layers:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>dikes</em>: ‘arrow black’</p></li>
<li><p><em>dike_influence_zones</em>: ‘fill red transparent’</p></li>
</ul>
</div></blockquote>
<p>The arrow style is useful as we’ll need to know the directionality of the dike layer to tell the tool which side of the dike to sample. Now we’re ready to open the ‘Dike Fragility Mapper’ dialog:</p>
<img alt="../_images/tutorials_6_11_img_2.jpg" src="../_images/tutorials_6_11_img_2.jpg" />
<p>Configure your dialog similar to what is shown below but using your own directories (ensure ‘dikeID’ is set to ‘ID’):</p>
<img alt="../_images/tutorials_6_11_img_3.jpg" src="../_images/tutorials_6_11_img_3.jpg" />
<section id="calculate-dike-exposure">
<h3><a class="toc-backref" href="#id169">6.11.1. Calculate Dike Exposure</a><a class="headerlink" href="#calculate-dike-exposure" title="Lien permanent vers ce titre">¶</a></h3>
<p>This step will calculate the exposure, or freeboard, values of each dike segment. Navigate to the ‘Dike Exposure’ tab, click ‘Refresh’, then configure it as shown below, taking care to select the DTM layer in the drop-down, but not in the selection window:</p>
<img alt="../_images/tutorials_6_11_1_img_1.jpg" src="../_images/tutorials_6_11_1_img_1.jpg" />
<p>Click <strong>‘Get Exposure’</strong>. You should see 10 layers loaded under the ‘CanFlood.Dikes’ group:</p>
<blockquote>
<div><ul>
<li><p><em>tut6_dike_dikes</em>: processed dikes layer</p></li>
<li><p>breach points layers (for each event)</p>
<blockquote>
<div><p>o <em>0010_noFail_breach_1_pts</em></p>
<p>o <em>0050_noFail_breach_3_pts</em></p>
<p>o <em>0200_noFail_breach_16_pts (see below</em> <a class="reference internal" href="../_images/red_diamond_image.jpg"><img alt="diamondimage" class="align-middle" src="../_images/red_diamond_image.jpg" style="width: 22px;" /></a> <em>)</em></p>
<p>o <em>1000_noFail_breach_50_pts</em></p>
</div></blockquote>
</li>
<li><p><em>tut6_tut6_dike_dikes_transects</em>: transects layer (see below <a class="reference internal" href="../_images/horizontal_line_image.jpg"><img alt="lineimage" class="align-middle" src="../_images/horizontal_line_image.jpg" style="width: 22px;" /></a>)</p></li>
<li><p>transect exposure points layers</p>
<blockquote>
<div><p>o <em>tut6_dike_dikes_0010_noFail_expo</em></p>
<p>o <em>tut6_dike_dikes_0050_noFail_expo</em></p>
<p>o <em>tut6_dike_dikes_0200_noFail_expo (see below</em> <a class="reference internal" href="../_images/green_dot_image.jpg"><img alt="dotimage" class="align-middle" src="../_images/green_dot_image.jpg" style="width: 22px;" /></a> <em>)</em></p>
<p>o <em>tut6_dike_dikes_1000_noFail_expo</em></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>These layer types are explained in <a class="reference internal" href="#section6-11">Section6.11</a>, and those relevant to the 200-year series are displayed below. The 40 m dike sample length and 200 m transect length we specified in the dialog box can be seen in the spacing and length of the transects shown below:</p>
<img alt="../_images/tutorials_6_11_1_img_2.jpg" src="../_images/tutorials_6_11_1_img_2.jpg" />
<p>At its core, this tool samples the WSL raster at the tail of each transect and the DTM at the head, then compares these to calculate the freeboard. This suggests the user must specify an appropriate transect side, sample length, and transect length based on the configuration of diking and flooding to obtain an accurate freeboard calculation.</p>
<p>To visualize the calculated freeboard values, apply ‘Single Labels’ for the ‘sid’ values on the processed dikes layer, then navigate to your working directory and open the <em>‘tut6 dike 43-1 profiles.svg’</em> image file. It should look similar to the below:</p>
<img alt="../_images/tutorials_6_11_1_img_3.jpg" src="../_images/tutorials_6_11_1_img_3.jpg" />
<p>This is a profile plot of dike 43, segment 1 (sid=4301) showing the calculated crest elevation and WSL for the four event rasters (sampled with each transect). Note that, this plot suggests the freeboard of the 50-year to be around -0.2 m (see red circle above). Now open the ‘tut6_dExpo_7_3.csv’ file in the working directory, this is the dike segment exposure (‘dexpo’) dataset that we’ll use in the next step to calculate failure probabilities. Notice the freeboard value of the segment-event in question is -0.2m as expected:</p>
<img alt="../_images/tutorials_6_11_1_img_4.jpg" src="../_images/tutorials_6_11_1_img_4.jpg" />
</section>
<section id="calculate-dike-vulnerability">
<h3><a class="toc-backref" href="#id170">6.11.2. Calculate Dike Vulnerability</a><a class="headerlink" href="#calculate-dike-vulnerability" title="Lien permanent vers ce titre">¶</a></h3>
<p>This step will use the previously calculated freeboard values and the user supplied fragility curves to calculate the probability of failure of each segment. Switch to the ‘Dike Vulnerability’ tab, you should see the filepath to the above exposure results automatically populated in the ‘dexpo_fp’ field. Now select the fragility curves library ‘dike_fragility_20210201.xls’ file provided with the tutorial data. The tab-names in this workbook correspond to ‘f0_dtag’ field on the dikes layer, telling CanFlood which curve to apply to which segment. Choose ‘None’ for the length effect corrections. Your dialog should look similar to this:</p>
<img alt="../_images/tutorials_6_11_2_img_1.jpg" src="../_images/tutorials_6_11_2_img_1.jpg" />
<p>Now click ‘Calc Fragility’ to generate the tabular failure probability data (‘pfail’).</p>
</section>
<section id="join-to-areas">
<h3><a class="toc-backref" href="#id171">6.11.3. Join to Areas</a><a class="headerlink" href="#join-to-areas" title="Lien permanent vers ce titre">¶</a></h3>
<p>In this final step, we will join the previously calculated failure probabilities to the user supplied influence areas for each segment based on the links provided on the dikes layer. Navigate to the ‘Join Areas’ tab. You should see the ‘pfail’ data filepath in the corresponding field; if not, navigate to this file. If you successfully ran the ‘Dike Exposure’ tool this session, you should see the first column of raster layers selected; if not, select the four WSL rasters manually in the first column. For the second column, select the ‘dike_influence_zone’ polygon layer in the first drop-down, then click ‘Fill Down’ to populate the remaining drop-downs. Once finished, your dialog should look like the below:</p>
<img alt="../_images/tutorials_6_11_3_img_1.jpg" src="../_images/tutorials_6_11_3_img_1.jpg" />
<p>Click <strong>‘Map pFail’</strong>. You should see four polygon layers loaded to your canvas, one for each event. Move these layers up on the layers list so they display on top of the rasters. The 200-year is shown below:</p>
<img alt="../_images/tutorials_6_11_3_img_2.jpg" src="../_images/tutorials_6_11_3_img_2.jpg" />
<p>These results layers are automatically stylized as failure polygons, showing the event raster name, source dike segment (‘sid’), and failure probability of each feature. Notice the 200-year contains 3-overlapping polygon features corresponding to the three segments with failure here, despite the original ‘dike_influznce_zones’ layer having two features. This mapping of polygons to dike segments is set on the dikes layer in the ‘Influence Area ID Field’ specified on the ‘Setup’ tab (‘ifzID’ in this case). In this way, 1:1 or many:many segment-polygon links can be specified, allowing the user to map each breach probability, or group segments to apply the calculated probabilities to a larger dike ring. See <a class="reference internal" href="#section5-4-1">Section5.4.1</a> for more information on this tool.</p>
</section>
</section>
</section>
<section id="references">
<span id="id55"></span><h1><a class="toc-backref" href="#id172">References</a><a class="headerlink" href="#references" title="Lien permanent vers ce titre">¶</a></h1>
<p>Bedford, T., and Roger M. Cooke. 2001. Probabilistic Risk Analysis: Foundations and Methods. Cambridge, UK ; New York, NY, USA: Cambridge University Press.</p>
<p>Bryant, Seth. 2019. “Accumulating Flood Risk.” University of Alberta. <a class="reference external" href="https://era.library.ualberta.ca/items/1e033c0d-6c4c-4749-9195-e46ce9eb3e2b">https://era.library.ualberta.ca/items/1e033c0d-6c4c-4749-9195-e46ce9eb3e2b</a>.</p>
<p>Farber, Daniel A. 2016. “Discount Rates and Infrastructure Safety: Implications of the New Economic Learning.” In Risk Analysis of Natural Hazards, edited by Paolo Gardoni, Colleen Murphy, and Arden Rowell, 43–57. Cham: Springer International Publishing. <a class="reference external" href="https://doi.org/10.1007/978-3-319-22126-7_4">https://doi.org/10.1007/978-3-319-22126-7_4</a>.</p>
<p>FEMA. 2012. “Multi-Hazard Loss Estimation Methodology, Flood Model: Hazus-MH MR2 Technical Manual.” FEMA Washington, DC. <a class="reference external" href="https://www.fema.gov/media-library-data/20130726-1820-25045-8292/hzmh2_1_fl_tm.pdf">https://www.fema.gov/media-library-data/20130726-1820-25045-8292/hzmh2_1_fl_tm.pdf</a>.</p>
<p>Frechette, Jean-Denis. 2016. “Estimate of the Average Annual Cost for Disaster Financial Assistance Arrangements Due to Weather Events.”</p>
<p>Hosein, Adam. 2016. “Deontology and Natural Hazards.” In Risk Analysis of Natural Hazards, edited by Paolo Gardoni, Colleen Murphy, and Arden Rowell, 137–53. Cham: Springer International Publishing. <a class="reference external" href="https://doi.org/10.1007/978-3-319-22126-7_9">https://doi.org/10.1007/978-3-319-22126-7_9</a>.</p>
<p>IBI Group and Golder Associates. 2015. “Provincial Flood Damage Assessment Study.” Government of Alberta. <a class="reference external" href="https://open.alberta.ca/publications/7032365">https://open.alberta.ca/publications/7032365</a>.</p>
<p>IWR and USACE. 2017. “Principles of Risk Analysis for Water Resources.”</p>
<p>Merz, B., H. Kreibich, R. Schwarze, and A. Thieken. 2010. “Review Article ‘Assessment of Economic Flood Damage.’” Natural Hazards and Earth System Sciences 10 (8): 1697–1724. <a class="reference external" href="https://doi.org/10.5194/nhess-10-1697-2010">https://doi.org/10.5194/nhess-10-1697-2010</a>.</p>
<p>Messner, Frank. 2007. “FLOODSite: Evaluating Flood Damages: Guidance and Recommendations on Principles and Methods.” T09-06–01. Helmholz Unweltforschungszentrum (UFZ). <a class="reference external" href="http://repository.tudelft.nl/view/hydro/uuid:5602db10-274c-40da-953f-34475ded1755/">http://repository.tudelft.nl/view/hydro/uuid:5602db10-274c-40da-953f-34475ded1755/</a>.</p>
<p>National Research Council. 2015. Tying Flood Insurance to Flood Risk for Low-Lying Structures in the Floodplain. National Academies Press.</p>
<p>O’Connell, P. E., and G. O’Donnell. 2014. “Towards Modelling Flood Protection Investment as a Coupled Human and Natural System.” Hydrology and Earth System Sciences 18 (1): 155–71. <a class="reference external" href="https://doi.org/10.5194/hess-18-155-2014">https://doi.org/10.5194/hess-18-155-2014</a>.</p>
<p>Penning-Rowsell, Edmund, Sally Priest, Dennis Parker, Joe Morris, Sylvia Tunstall, Christophe Viavattene, John Chatterton, and Damon Owen. 2013. Flood and Coastal Erosion Risk Management - Manual. Routledge. <a class="reference external" href="https://www.mcm-online.co.uk/manual/">https://www.mcm-online.co.uk/manual/</a>.</p>
<p>Penning-Rowsell, Edmund, Sally Priest, Dennis Parker, and others. 2019. Flood and Coastal Erosion Risk Management - Handbook. 1st ed. Routledge. <a class="reference external" href="https://doi.org/10.4324/9780203066393">https://doi.org/10.4324/9780203066393</a>.</p>
<p>Public Safety Canada. 2018. “Federal Flood Mapping Guidelines Series.” December 21, 2018. <a class="reference external" href="https://www.publicsafety.gc.ca/cnt/mrgnc-mngmnt/dsstr-prvntn-mtgtn/ndmp/fldpln-mppng-en.aspx">https://www.publicsafety.gc.ca/cnt/mrgnc-mngmnt/dsstr-prvntn-mtgtn/ndmp/fldpln-mppng-en.aspx</a>.</p>
<p>Rudari, Roberto, and Francesco Silvestro. 2015. “IMPROVEMENT OF THE GLOBAL FLOOD MODEL FOR THE GAR 2015.” UNISDR.
<a class="reference external" href="https://www.preventionweb.net/english/hyogo/gar/2015/en/bgdocs/risk-section/CIMA%20Foundation,%20Improvement%20of%20the%20Global%20Flood%20Model%20for%20the%20GAR15.pdf">https://www.preventionweb.net/english/hyogo/gar/…</a>.</p>
<p>Sayers, Paul B., ed. 2012. Flood Risk: Planning, Design and Management of Flood Defence Infrastructure. London: ICE Publishing.</p>
<p>Smith, Nicky, Charlotte Brown, ., and Wendy Saunders. 2016. “Disaster Risk Management Decision-Making: Review.”</p>
<p>UNISDR, May. 2009. “UNISDR Terminology for Disaster Risk Reduction.”</p>
<p>URS. 2008. “Delta Risk Management Strategy (DRMS) Phase 1 - Levee Vulnerability - Final.” California Department of Water Resources.</p>
<p>USACE. 1996. “Risk-Based Analysis for Flood Damage Reduction Studies.” EM 1110-2-1619. <a class="reference external" href="https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-1619.pdf">https://www.publications.usace.army.mil/Portals/76/Publications/EngineerManuals/EM_1110-2-1619.pdf</a>.</p>
</section>
<section id="footnotes">
<h1><a class="toc-backref" href="#id173">Footnotes</a><a class="headerlink" href="#footnotes" title="Lien permanent vers ce titre">¶</a></h1>
<dl class="footnote brackets">
<dt class="label" id="id56"><span class="brackets"><a class="fn-backref" href="#id5">1</a></span></dt>
<dd><p>All SOFDA inputs must be built and configured manually.</p>
</dd>
<dt class="label" id="id57"><span class="brackets"><a class="fn-backref" href="#id9">2</a></span></dt>
<dd><p>The ‘capped’ values with null and rounding treatment.</p>
</dd>
<dt class="label" id="id58"><span class="brackets"><a class="fn-backref" href="#id10">3</a></span></dt>
<dd><p>Can be built from an .xls file by exporting to csv then creating a csv layer in QGIS from the lat/long values.</p>
</dd>
<dt class="label" id="id59"><span class="brackets"><a class="fn-backref" href="#id11">4</a></span></dt>
<dd><p>A corresponding simple $/m2 curve is created by the DamageCurves Converter.</p>
</dd>
<dt class="label" id="id60"><span class="brackets"><a class="fn-backref" href="#id12">5</a></span></dt>
<dd><p>Depending on your settings, this may have been set automatically when you loaded the datafiles.
All tutorials   use CRS ‘EPSG:3005’ unless stated otherwise. See the following link for an explanation of projections in QGIS.</p>
<p><a class="reference external" href="https://docs.qgis.org/3.10/en/docs/user_manual/working_with_projections/working_with_projections.html">https://docs.qgis.org/3.10/en/docs/user_manual/working_with_projections/working_with_projections.html</a></p>
</dd>
<dt class="label" id="id61"><span class="brackets"><a class="fn-backref" href="#id13">6</a></span></dt>
<dd><p>Depending on your QGIS settings, you may be requested to select a transformation if the CRS was not
set correctly beforehand.</p>
</dd>
<dt class="label" id="id62"><span class="brackets"><a class="fn-backref" href="#id14">7</a></span></dt>
<dd><p>Any field with unique integer values can be used as the FieldName Index (except built-in feature identifiers).</p>
</dd>
<dt class="label" id="id63"><span class="brackets"><a class="fn-backref" href="#id15">8</a></span></dt>
<dd><p>If the hazard layers are not shown in the dialog, hit ‘Refresh’.</p>
</dd>
<dt class="label" id="id64"><span class="brackets"><a class="fn-backref" href="#id16">9</a></span></dt>
<dd><p>does not have to match the directory from the previous step.</p>
</dd>
<dt class="label" id="id65"><span class="brackets"><a class="fn-backref" href="#id17">10</a></span></dt>
<dd><p>CanFlood will attempt to automatically identify the Inventory Vector Layer; however, this tutorial does
not make use of this layer so the selection here can be ignored.</p>
</dd>
<dt class="label" id="id66"><span class="brackets"><a class="fn-backref" href="#id18">11</a></span></dt>
<dd><p>If the filepath fails to populate automatically, try changing re-setting the ‘finv’ and ‘parameter’
drop-downs. Alternatively, enter the filepath manually.</p>
</dd>
<dt class="label" id="id67"><span class="brackets"><a class="fn-backref" href="#id21">12</a></span></dt>
<dd><p>Some ‘Results’ tools work better when the model output data files are in the same file tree as the
Control File.</p>
</dd>
<dt class="label" id="id68"><span class="brackets"><a class="fn-backref" href="#id24">13</a></span></dt>
<dd><p>Try running the tool again, but this time selecting ‘Max’. If you look closely at the boxplots, you should
see a slight difference in the resolved probabilities. This suggests this model is not very sensitive to the relational assumption of these overlapping failure polygons.</p>
</dd>
<dt class="label" id="id69"><span class="brackets"><a class="fn-backref" href="#id27">14</a></span></dt>
<dd><p>Alternatively, the ‘Compare’ tool can be used to generate a comparison plot between the two tutorials.</p>
</dd>
<dt class="label" id="id70"><span class="brackets"><a class="fn-backref" href="#id30">15</a></span></dt>
<dd><p>Advanced users could avoid re-running the ‘Impacts (L2)’ model by manipulating the Control File to point
to the ‘dmgs’ results from the previous run as these will not change between the two formulations.</p>
</dd>
<dt class="label" id="id71"><span class="brackets"><a class="fn-backref" href="#id32">16</a></span></dt>
<dd><p>The control file specified on the ‘Setup’ tab will be used for common plot styles (e.g.,</p>
</dd>
<dt class="label" id="id72"><span class="brackets"><a class="fn-backref" href="#id35">17</a></span></dt>
<dd><p>The influence of the mitigation functions on the depths are not reflected in this output.</p>
</dd>
<dt class="label" id="id73"><span class="brackets"><a class="fn-backref" href="#id36">18</a></span></dt>
<dd><p>Alternatively, the ‘tut2d_noMiti’ from Tutorial 2d can be used.</p>
</dd>
<dt class="label" id="id74"><span class="brackets"><a class="fn-backref" href="#id37">19</a></span></dt>
<dd><p>If you get a B/C ratio of 1.19, make sure the $1000 maintenance costs are entered for every year of the
life-cycle.</p>
</dd>
<dt class="label" id="id75"><span class="brackets"><a class="fn-backref" href="#id38">20</a></span></dt>
<dd><p>Available in the CanFlood styles package described in Section 5.4.4 (Plugins &gt; CanFlood &gt; Add Styles).</p>
</dd>
<dt class="label" id="id76"><span class="brackets"><a class="fn-backref" href="#id39">21</a></span></dt>
<dd><p>Be sure to load the stylized ‘.qlr’ layers in place of the raw layers.</p>
</dd>
<dt class="label" id="id77"><span class="brackets"><a class="fn-backref" href="#id41">22</a></span></dt>
<dd><p>This is important for inundation percent analysis which deals with small fractions.</p>
</dd>
<dt class="label" id="id78"><span class="brackets"><a class="fn-backref" href="#id42">23</a></span></dt>
<dd><p>Risk (L1) inundation percentage runs can not use asset elevations; therefore, this input variable is
redundant. When as_inun=True CanFlood model routines expect an ‘elv’ column with all zeros.</p>
</dd>
<dt class="label" id="id79"><span class="brackets"><a class="fn-backref" href="#id45">24</a></span></dt>
<dd><p>See Rudari and Silvestro (2015) for details on the GAR15 flood hazard model.</p>
</dd>
<dt class="label" id="id80"><span class="brackets"><a class="fn-backref" href="#id47">25</a></span></dt>
<dd><p>Depending on your profile settings, the project’s CRS may be automatically set by the first loaded layer.</p>
</dd>
<dt class="label" id="id81"><span class="brackets"><a class="fn-backref" href="#id48">26</a></span></dt>
<dd><p>New installations of Qgis should automatically path to the same profile directory (Settings &gt; User Profiles &gt;
Open Active Profile Folder), therefore carrying forward your previous connection info.</p>
</dd>
<dt class="label" id="id82"><span class="brackets"><a class="fn-backref" href="#id49">27</a></span></dt>
<dd><p>Ctrl+Shift+F will zoom to the project extents.</p>
</dd>
<dt class="label" id="id83"><span class="brackets"><a class="fn-backref" href="#id50">28</a></span></dt>
<dd><p>Depending on your internet connection, this process can be slow. It’s recommended to set ‘Cache’=’Prefer
cache’ to limit additional data transfers, and to turn the layers off or disable rendering once loaded into the project.</p>
</dd>
<dt class="label" id="id84"><span class="brackets"><a class="fn-backref" href="#id51">29</a></span></dt>
<dd><p>You can safely select any transformation or close the dialog. These transformations are only for display,
we’ll deal with transforming the data onto our CRS below.</p>
</dd>
<dt class="label" id="id85"><span class="brackets"><a class="fn-backref" href="#id53">30</a></span></dt>
<dd><p>In some cases, QGIS may fail to recognize the CRS assigned to these new rasters, indicated by a “?” shown to
the right of the layer in the layers panel. In these cases, you will need to define the projection by going to the layer’s ‘Properties’ and under ‘Source’ set the coordinate system to match that of the project (EPSG: 3978).</p>
</dd>
<dt class="label" id="id86"><span class="brackets"><a class="fn-backref" href="#id54">31</a></span></dt>
<dd><p>Load these styles onto your profile using the Plugins&gt;CanFlood&gt;Add Styles tool described in Section 5.4.4.</p>
</dd>
</dl>
</section>
<section id="appendix-a-web-connections">
<span id="appendix-a"></span><h1><a class="toc-backref" href="#id174">Appendix A: Web Connections</a><a class="headerlink" href="#appendix-a-web-connections" title="Lien permanent vers ce titre">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 50%" />
<col style="width: 20%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Acronym</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Service</p></th>
<th class="head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="4"><p>UNISDR_GAR15_GlobalRiskAssessment</p></td>
</tr>
<tr class="row-odd"><td><p>GAR15</p></td>
<td><p>UNISDR’s data layers from the global risk assessment
conducted for the Global Assessment Report on
Disaster Risk Reduction 2015 (GAR15) by the CIMA
Research Foundation. This data is hosted by the
Global Risk Data Platform and contains six global
flood depth rasters (in cm; return periods = 25, 50,
100, 200, 500, 1000 years) having 1km resolution.</p></td>
<td><p>WCS</p></td>
<td><p>see below</p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>ECCC_NationalPollutantReleaseInventory_NPRI</p></td>
</tr>
<tr class="row-odd"><td><p>NPRI</p></td>
<td><p>Government of Canada’s service to collect information
on the release, disposal and transfer of more than 320
substances. The web-service provides release reports
from the most recent year. The layer ‘NPRI-Reporting
Facilities’ shows the location of facilitates
reporting any type of release.</p></td>
<td><p>ArcGisFeatureServer</p></td>
<td><p><a class="reference external" href="https://www.canada.ca/en/services/environment/pollution-waste-management/national-pollutant-release-inventory.html">homepage</a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>NRCan_NationalHumanSettlementLayer_NHSL</p></td>
</tr>
<tr class="row-odd"><td><p>NHSL</p></td>
<td><p>Collection of thematic datasets that describe the
physical, social and economic characteristics of
urban centres and rural/remote communities across
Canada, and their vulnerability to natural hazards
of concern</p></td>
<td><p>ArcGisFeatureServer</p></td>
<td><p><a class="reference external" href="https://maps-cartes.services.geo.ca/server_serveur/rest/services/NRCan/nhsl_en/MapServer">MapServer</a></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>NRCan_AutomaticallyExtractedBuildings</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Topographical feature class that delineates
polygonal building footprints automatically
extracted from airborne Lidar data, high-resolution
optical imagery or other sources.</p></td>
<td><p>WMS</p></td>
<td><p><a class="reference external" href="https://open.canada.ca/data/en/dataset/7a5cda52-c7df-427f-9ced-26f19a8a64d6">Open Canada</a></p></td>
</tr>
</tbody>
</table>
<p><strong>Server</strong></p>
<p>Global Risk Data Platform</p>
<p>(<a class="reference external" href="https://preview.grid.unep.ch/index.php?preview=home&amp;lang=eng">https://preview.grid.unep.ch/index.php?preview=home&amp;lang=eng</a>)</p>
<p>Data and Model</p>
<p>From preventionweb (<a class="reference external" href="https://risk.preventionweb.net/capraviewer/">https://risk.preventionweb.net/capraviewer/</a>):</p>
<blockquote>
<div><p><em>The GAR Atlas global flood hazard assessment uses a probabilistic approach for modelling riverine flood major river basins around the globe. This has been possible after compiling a global database of stream-flow data, merging different sources and gathering more than 8000 stations over the globe in order to calculate the range of possible discharges from very low to the maximum possible scales at different locations along the rivers. The calculated discharges were introduced in the river sections to model water levels downstream. This procedure allowed for the determination of stochastic event-sets of riverine floods from which hazard maps for several return periods (25, 50, 100, 200, 500, 1000 years) were obtained. The hazard maps are developed at 1kmx1km resolution and have been validated against satellite flood footprints from different sources (DFO archive, UNOSAT flood portal) performing well especially for big events For smaller events (lower return periods), the GAR Atlas flood hazard maps tend to overestimate with respect to similar maps produced locally (hazard maps where available for some countries and were used as benchmark). The main issue being that, due to the resolution, the GAR Atlas flood hazard maps do not take into account flood defenses that are normally present to preserve the value exposed to floods.</em></p>
</div></blockquote>
<p>Additional summary is provided in:</p>
<blockquote>
<div><p>UNISDR. 2015. “Global Assessment Report on Disaster Risk Reduction 2015 - Annex</p>
<blockquote>
<div><p>1 - Global Risk Assessment.” Geneva: United Nations. <a class="reference external" href="https://www.preventionweb.net/english/hyogo/gar/2015/en/gar-pdf/Annex1-GAR_Global_Risk_Assessment_Data_methodology_and_usage.pdf">https://www.preventionweb.net/english/hyogo/gar/2015/en/gar-pdf/Annex1-GAR_Global_Risk_Assessment_Data_methodology_and_usage.pdf</a>.</p>
</div></blockquote>
</div></blockquote>
<p>Additional detail is provided in:</p>
<blockquote>
<div><p>Rudari, Roberto, and Francesco Silvestro. 2015. “IMPROVEMENT OF THE GLOBAL FLOOD MODEL FOR THE GAR 2015.” UNISDR.</p>
<blockquote>
<div><p><a class="reference external" href="https://www.preventionweb.net/english/hyogo/gar/2015/en/bgdocs/risk-section/CIMA%20Foundation,%20Improvement%20of%20the%20Global%20Flood%20Model%20for%20the%20GAR15.pdf">https://www.preventionweb.net/english/hyogo/gar/2015/..</a>.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="appendix-b-sofda-user-manual">
<span id="appendix-b"></span><h1><a class="toc-backref" href="#id175">Appendix B: SOFDA User Manual</a><a class="headerlink" href="#appendix-b-sofda-user-manual" title="Lien permanent vers ce titre">¶</a></h1>
<p><a class="reference external" href="https://github.com/IBIGroupCanWest/CanFlood/tree/master/manual/sofda/">https://github.com/IBIGroupCanWest/CanFlood/tree/master/manual/sofda/</a></p>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../index.html" class="btn btn-neutral float-left" title="Documentation for CanFlood" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Seth Bryant.

    </p>
  </div>
    
    
    
    Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    
    fourni par <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>